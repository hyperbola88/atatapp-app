{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./thagame/systems/physics-system.ts","webpack:///./index.ts","webpack:///./thagame/components/view-component.ts","webpack:///./thagame/components/static-platform-component.ts","webpack:///./entity.ts","webpack:///./thagame/components/physics-component.ts","webpack:///./thagame/utils/delay.ts","webpack:///./thagame/components/controlled-component.ts","webpack:///./thagame/application.ts","webpack:///./thagame/components/hosted-component.ts","webpack:///./thagame/component.ts","webpack:///./thagame/systems/game-system.ts","webpack:///./thagame/components/damage-component.ts","webpack:///./thagame/components/weapon-component.ts","webpack:///./thagame/components/coin-component.ts","webpack:///./thagame/components/character-component.ts","webpack:///./thagame/components/sensor-component.ts","webpack:///./thagame/components/level1/enemy.ts","webpack:///./thagame/components/tip-component.ts","webpack:///./thagame/components/respawn-component.ts","webpack:///./thagame/views/character-leg-view.ts","webpack:///./thagame/utils/contol-event.ts","webpack:///./thagame/components/finish-level-component.ts","webpack:///./thagame/components/ninja-component.ts","webpack:///./thagame/levels/base-level.ts","webpack:///./thagame/views/additional-ground-view.ts","webpack:///./thagame/components/npc-component.ts","webpack:///./thagame/views/ui/texted-button.ts","webpack:///./thagame/views/character-arm-view.ts","webpack:///./thagame/components/witcher-component.ts","webpack:///./thagame/views/platform-view.ts","webpack:///./thagame/views/ui/button.ts","webpack:///./thagame/components/level1/water-part.ts","webpack:///./thagame/views/ui/control-button.ts","webpack:///./thagame/systems/sound-system.ts","webpack:///./thagame/views/enemy-view.ts","webpack:///./thagame/components/level1/gas.ts","webpack:///./thagame/components/ghost-component.ts","webpack:///./thagame/views/ghost-view.ts","webpack:///./thagame/components/level1/balcony.ts","webpack:///./thagame/views/ninja-view.ts","webpack:///./thagame/views/witcher-view.ts","webpack:///./thagame/components/level1/WoodenBox.ts","webpack:///./thagame/systems/assets-loader-system.ts","webpack:///./thagame/systems/characters-system.ts","webpack:///./thagame/systems/coins-system.ts","webpack:///./thagame/systems/controlled-system.ts","webpack:///./thagame/systems/enemies-system.ts","webpack:///./thagame/utils/deferred.ts","webpack:///./thagame/levels/level4.ts","webpack:///./thagame/views/weapon-view.ts","webpack:///./thagame/components/level1/ashtray.ts","webpack:///./thagame/views/balcony-view.ts","webpack:///./thagame/views/guy-view.ts","webpack:///./thagame/components/level1/cigarette.ts","webpack:///./thagame/components/level1/TNT.ts","webpack:///./thagame/components/level1/tube-component.ts","webpack:///./thagame/components/level1/tube-trigger.ts","webpack:///./thagame/components/level1/wall.ts","webpack:///./thagame/views/blocker-view.ts","webpack:///./thagame/components/level1/water.ts","webpack:///./thagame/components/level1/water-trigger.ts","webpack:///./thagame/views/ninja-arm-view.ts","webpack:///./thagame/views/coin-view.ts","webpack:///./thagame/views/ground-water-view.ts","webpack:///./thagame/views/water-view.ts","webpack:///./thagame/components/level1/fire.ts","webpack:///./thagame/components/explosion-component.ts","webpack:///./thagame/components/magic-component.ts","webpack:///./thagame/views/tube-platform-view.ts","webpack:///./thagame/views/small-platform1-view.ts","webpack:///./thagame/views/small-platform2-view.ts","webpack:///./thagame/components/level1/respawn-enemy.ts","webpack:///./thagame/levels/level1.ts","webpack:///./thagame/levels/level2.ts","webpack:///./thagame/levels/level3.ts","webpack:///./thagame/systems/gui-system.ts","webpack:///./thagame/views/ui/character-button.ts","webpack:///./thagame/views/ui/coins-gui-view.ts","webpack:///./thagame/views/ui/finish-level-view.ts","webpack:///./thagame/views/ui/gameover-view.ts","webpack:///./thagame/systems/hosts-system.ts","webpack:///./thagame/systems/splash-system.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","PhysicsGroup","meter2Pixels","v","pixels2Meter","allCollideExcept","groups","indexOf","PhysicsSystem","this","paused","world","World","gravity","Vec2","allowSleep","on","evt","app","runners","beginContact","emit","endContact","force","blastPosition","blastRadius","angle","Math","PI","rayEnd","x","sin","y","cos","RayCastAny","reset","rayCast","callback","hit","bodies","forEach","body","index","applyBlastImpulse","points","createBody","removeBodies","position","movingSleepBodies","movingBodies","delta","min","mb","setTransform","setLinearVelocity","zero","setAwake","setGravityScale","comp","getUserData","isGhost","destroyBody","step","fixedTimeStep","clearForces","point","power","blastDir","sub","distance","normalize","invDistance","impulseMag","imp","mul","applyLinearImpulse","normals","fixture","normal","fraction","getBody","m_filterCategoryBits","GHOST","DEFAULT","GAS","MAGIC","Application","init","run","resize","e","document","getElementById","appendChild","view","ViewComponent","_entity","Container","StaticPlatformComponent","group","width","height","filterMaskBits","physicsGroup","createShape","createView","a","PIXI","Graphics","beginFill","drawRect","endFill","addChild","createFixture","Polygon","density","friction","restitution","filterCategoryBits","PhysicsComponent","Entity","components","component","isView","gameLayer","isPhysics","setEntity","physics","removeBody","removeChild","destroy","constr","ret","removeComponent","undefined","children","createEntity","options","addBody","setUserData","loop","add","contact","body1","body2","getFixtureA","getFixtureB","bodyPos","getPosition","set","rotation","getAngle","console","log","anotherBody","getAnotherBody","onBeginContacted","onEndContacted","visible","setActive","remove","addComponent","BaseComponent","delay","duration","Deferred","progress","Ticker","shared","ticker","speed","resolve","Action","ControlledComponent","id","character","enabled","movement","right","left","up","move","action","tween","seek","RIGHT","LEFT","ACTION","SUPERACTION","superAction","gsap","to","ease","stopAction","_enabled","_id","WIDTH","HEIGHT","backgroundColor","autoDensity","resolution","devicePixelRatio","renderer","stage","guiLayer","Runner","load","start","entityAdded","entityRemoved","postStep","gameStarted","characterSwitched","render","UPDATE_PRIORITY","LOW","loader","Loader","addSystem","assets","AssetsLoaderSystem","splash","SplashSystem","game","GameSystem","characters","CharactersSystem","controls","ControlledSystem","enemies","EnemiesSystem","hosts","HostsSystem","gui","GUISystem","coins","CoinsSystem","sounds","SoundSystem","addEventListener","innerWidth","innerHeight","system","screen","HostedComponent","controlled","getEntity","getComponent","hostButton","putHost","unhostButton","releaseHost","hosted","LevelsExecuter","entities","levels","Level1","Level2","Level3","Level4","currentLevelId","screenfull","utils","isMobile","any","play","style","display","level","prevLevel","removeAll","restart","gameOver","finishLevel","levelsCoins","newWidth","newHeight","scale","LEVEL_FINISHED","disableCharacters","disableAll","execute","entity","ignoreRespawn","hasHost","host","respawn","RespawnComponent","moveBodyAndSleep","getAllComponents","disable","then","pos","createExplosion","moveBody","enable","ind","clear","DamageComponent","damageGroups","physicsComponent","Array","isArray","some","getFixtureList","CharacterComponent","thisEnemy","Enemy","anotherComponent","anotherIsEnemy","gas","Gas","weapon","WeaponComponent","isEnemyKill","active","kill","ninja","WeaponView","DANGER","type","Body","KINEMATIC","DEG_TO_RAD","setPosition","inAction","onUpdate","setAngle","onComplete","Box","HEROES","CoinComponent","CoinView","STAR","Circle","isSensor","getCoin","characterView","setSleepingAllowed","canAction","doAction","canSuperAction","doSuperAction","canMove","doMove","velX","getLinearVelocity","fx","floor","abs","idle","filters","GlowFilter","walk","m_linearVelocity","characterSettings","jumpForce","controlledComponent","SensorComponent","triggered","isBeginContact","EnemyView","ENEMIES","DYNAMIC","setMassData","mass","center","I","setFixedRotation","enemyView","thinkAndGo","delayPromise","reject","bits","BOMB","canJump","jump","direction","applyForceToCenter","random","TipComponent","deltaX","deltaY","text","arrowAngle","copyFrom","parentView","arrow","Sprite","from","TextureCache","anchor","txt","Text","fontFamily","fill","align","fontSize","CharacterLeg","textureName","hasDelay","gfx","killTweens","walking","actioning","startWalk","isActive","ControlEvent","code","Event","FinishLevelComponent","showGfx","END","triggerAmount","size","executor","setOnExit","NinjaComponent","NinjaView","WATER","BaseLevel","createBackground","createAll","npc","NPC","pause","radius","explosion","ExplosionComponent","vector","magic","vx","clone","MagicComponent","AdditionalGroundView","texture","gfx1","gfx2","gfx3","filter","isPausable","TextedButton","TextStyle","fontWeight","wordWrap","wordWrapWidth","back","Button","CharacterArm","sprite","angles","superActioning","WitcherComponent","WitcherView","magicVec","createMagic","PlatformView","createBack","interactive","tint","setEnable","WaterPart","startDelay","endDelay","heroes","Set","moveForce","intId","ce","getContactList","next","isTouching","found","doEnable","ControlButton","assetsPath","settings","Error","src","map","Howl","autoplay","volume","textures","arm","hand","leg1","leg2","intervalId","setInterval","clearInterval","fireComponent","stop","alpha","GhostComponent","GhostView","doingAction","endY","hostComponent","obj","getHostedByOverlap","becomeImplanted","eye1","eye2","repeat","yoyo","yoyoEase","Balcony","ash","cigarette","tnt","wall","BalconyView","shouldPlaceAsh","onSmokeDone","onSmokeCheckAsh","onGas","isContacted","goAway","startFire","explode","startSmoker","drop","putBack","blinkTexture","normalTexture","arm2","arm0","stick","armPos","Point","armContainer","NinjaArmView","hat","WoodenBox","loadOptions","crossOrigin","baseUrl","path","WebFont","custom","families","urls","error","_levelsCoins","_totalCoins","updateCoins","onKeyDown","onKeyPressed","onKeyUp","onKeyReleased","superActionStarted","startAction","promise","Promise","_reject","_resolve","onfulfilled","onrejected","LEVEL1_SHOW_TUBE","tube","show","LEVEL1_HIDE_TUBE","hide","LEVEL1_REMOVE_WATER","removeWater","cave","createTube","ent","Wall","ninComponent","witcher","witcherComponent","ghost","ghostComponent","bounds","platform","ground","TubePlatformView","trigger","TubeTrigger","Ashtray","TNT","Cigerette","fire","Fire","balcony","finish","enemy","RespawnEnemy","additionalGround","platforms","SmallPlatform1View","SmallPlatform2View","bigWater","GroundWaterView","star","showCharactersButtons","WaterTrigger","waterView","WaterView","water","Water","TubeComponent","STAFF","posY","guy","GuyView","smokeAndWait","LIGHT","idlePosition","startPosition","explosionForce","executor2","vertices","drawView","verties","moveTo","lineTo","BlockerView","b","createWaterPart","idlePos","killThisTween","tween0","maska","maskPart1","maskPart2","maskPart3","mask","stopDelay","drawCircle","timeline","gravityScale","linearDamping","bullet","linearVelocity","angularVelocity","viewMask","box","charButtonsLayer","controlsLayer","CoinsGUIView","createCharactersButtons","createControlsButtons","ids","buttons","button","includes","gameOverView","GameOverView","positionGameOver","scaleProps","FinishLevelView","enableAll","unhostAll","notOnExitAll","finalScale","leftButton","rightButton","actionButton","superActionButton","yPos","py","updateCoinsText","onExit","onCharacterButtonClicked","icon","dispatchEvent","CharacterButton","done","_icon","_hosted","title","txtTitle","okBtn","off","h","_host","Texture","WHITE","startButton","tutButton","removeChildren"],"mappings":"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","file":"bundle.1504929fc1d1818d7684.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([258,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import planck, { Body, BodyDef, Fixture, Vec2, World } from \"planck-js/lib/\";\r\nimport { app } from \"../..\";\r\nimport { BaseComponent } from \"../component\";\r\nimport { GhostComponent } from \"../components/ghost-component\";\r\n\r\ntype MovingBody = {\r\n    body: Body;\r\n    position: Vec2;\r\n};\r\nexport enum PhysicsGroup {\r\n    DEFAULT = 1,\r\n    HEROES = 2,\r\n    GHOST = 4,\r\n    ENEMIES = 8,\r\n    STAFF = 16,\r\n    LIGHT = 32,\r\n    GAS = 64,\r\n    BOMB = 128,\r\n    END = 256,\r\n    DANGER = 512,\r\n    MAGIC = 1024,\r\n    WATER = 2048,\r\n    STAR = 4096,\r\n}\r\nconst METER_TO_PIXEL = 30;\r\nexport const meter2Pixels = (v: number) => {\r\n    return v * METER_TO_PIXEL;\r\n};\r\nexport const pixels2Meter = (v: number) => {\r\n    return v / METER_TO_PIXEL;\r\n};\r\nexport const allCollideExcept = (...groups: PhysicsGroup[]) => {\r\n    let result = 0;\r\n    for (var n in PhysicsGroup) {\r\n        if (typeof PhysicsGroup[n] === \"number\") {\r\n            const i = (<any>PhysicsGroup[n]) as number;\r\n            if (groups.indexOf(i) === -1) {\r\n                result |= i;\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n};\r\nexport class PhysicsSystem {\r\n    public world: planck.World;\r\n    private fixedTimeStep = 1 / 60;\r\n    private maxSubSteps = 10;\r\n    private movingSleepBodies: MovingBody[] = [];\r\n    private movingBodies: MovingBody[] = [];\r\n    private removeBodies: Body[] = [];\r\n    private paused: boolean;\r\n    public init() {\r\n        this.paused = false;\r\n        this.world = new World({\r\n            gravity: new Vec2(0, 20),\r\n            allowSleep: true,\r\n        });\r\n        this.world.on(\"begin-contact\", (evt) => {\r\n            app.runners.beginContact.emit(evt);\r\n        });\r\n        this.world.on(\"end-contact\", (evt) => {\r\n            app.runners.endContact.emit(evt);\r\n        });\r\n        this.world.on(\"pre-solve\", (evt) => {});\r\n    }\r\n    public explode(force: number, blastPosition: Vec2, blastRadius: number) {\r\n        const rays = 36;\r\n        for (let i = 0; i < rays; i++) {\r\n            const angle = (i / rays) * 360 * (Math.PI / 180);\r\n            const rayEnd = new Vec2(\r\n                blastPosition.x + Math.sin(angle) * blastRadius,\r\n                blastPosition.y + Math.cos(angle) * blastRadius,\r\n            );\r\n            RayCastAny.reset();\r\n            this.world.rayCast(blastPosition, rayEnd, RayCastAny.callback);\r\n            if (RayCastAny.hit) {\r\n                RayCastAny.bodies.forEach((body, index) => {\r\n                    this.applyBlastImpulse(body, blastPosition, RayCastAny.points[index], force / rays);\r\n                });\r\n            }\r\n        }\r\n    }\r\n    public pause() {\r\n        this.paused = true;\r\n    }\r\n    public unpause() {\r\n        this.paused = false;\r\n    }\r\n    public addBody(body: BodyDef) {\r\n        return this.world.createBody(body);\r\n    }\r\n    public removeBody(body: Body) {\r\n        this.removeBodies.push(body);\r\n    }\r\n    public moveBodyAndSleep(body: Body, position: Vec2) {\r\n        this.movingSleepBodies.push({ body, position });\r\n    }\r\n    public moveBody(body: Body, position: Vec2) {\r\n        this.movingBodies.push({ body, position });\r\n    }\r\n    public loop(delta: number) {\r\n        if (this.paused) return;\r\n        delta = Math.min(delta, 2);\r\n        if (this.movingSleepBodies.length > 0) {\r\n            this.movingSleepBodies.forEach((mb) => {\r\n                mb.body.setTransform(mb.position, 0);\r\n                mb.body.setLinearVelocity(Vec2.zero());\r\n                mb.body.setAwake(false);\r\n                mb.body.setGravityScale(0);\r\n            });\r\n            this.movingSleepBodies = [];\r\n        }\r\n        if (this.movingBodies.length > 0) {\r\n            this.movingBodies.forEach((mb) => {\r\n                mb.body.setTransform(mb.position, 0);\r\n\r\n                mb.body.setLinearVelocity(Vec2.zero());\r\n                const comp = mb.body.getUserData() as any;\r\n                if (!(comp && comp.isGhost)) {\r\n                    mb.body.setGravityScale(1);\r\n                }\r\n\r\n                mb.body.setAwake(true);\r\n            });\r\n            this.movingBodies = [];\r\n        }\r\n        if (this.removeBodies.length > 0) {\r\n            for (let i = this.removeBodies.length - 1; i >= 0; i--) {\r\n                if (this.removeBodies[i]) {\r\n                    this.world.destroyBody(this.removeBodies[i]);\r\n                }\r\n                this.removeBodies.splice(i, 1);\r\n            }\r\n        }\r\n        this.world.step(delta * this.fixedTimeStep);\r\n        this.world.clearForces();\r\n    }\r\n    private applyBlastImpulse(body: Body, blastPosition: Vec2, point: Vec2, power: number) {\r\n        const blastDir = Vec2.sub(point, blastPosition);\r\n        const distance = blastDir.normalize();\r\n        //ignore bodies exactly at the blast point - blast direction is undefined\r\n        if (distance === 0) return;\r\n        const invDistance = 1 / distance;\r\n        const impulseMag = power * invDistance * invDistance;\r\n        const imp = Vec2.mul(blastDir, impulseMag);\r\n        body.applyLinearImpulse(imp, point);\r\n    }\r\n}\r\nclass RayCastAny {\r\n    public static hit: boolean;\r\n    public static points: Vec2[];\r\n    public static normals: Vec2[];\r\n    public static bodies: Body[];\r\n    public static reset() {\r\n        RayCastAny.hit = false;\r\n        RayCastAny.points = [];\r\n        RayCastAny.normals = [];\r\n        RayCastAny.bodies = [];\r\n    }\r\n\r\n    public static callback = function (fixture: Fixture, point: Vec2, normal: Vec2, fraction: number) {\r\n        var body = fixture.getBody();\r\n        if (\r\n            fixture.m_filterCategoryBits === PhysicsGroup.GHOST ||\r\n            fixture.m_filterCategoryBits === PhysicsGroup.DEFAULT ||\r\n            fixture.m_filterCategoryBits === PhysicsGroup.GAS ||\r\n            fixture.m_filterCategoryBits === PhysicsGroup.MAGIC\r\n        ) {\r\n            return -1;\r\n        }\r\n        RayCastAny.hit = true;\r\n        RayCastAny.points.push(point);\r\n        RayCastAny.bodies.push(body);\r\n        RayCastAny.normals.push(normal);\r\n        return 1;\r\n    };\r\n}\r\n","import { Application } from \"./thagame/application\";\r\nexport const app = new Application();\r\napp.runners.init.run();\r\napp.resize();\r\ntry {\r\n    if ((module as any).hot) {\r\n        (module as any).hot.dispose(function () {\r\n            console.log(\"destroyed\");\r\n            app.destroy();\r\n        });\r\n    }\r\n} catch (e) {}\r\ndocument.getElementById(\"app\").appendChild(app.view);\r\n","import { Container } from \"pixi.js\";\r\nimport { Entity } from \"../../entity\";\r\nimport { IComponent } from \"../component\";\r\n\r\nexport class ViewComponent extends Container implements IComponent {\r\n    private _entity: Entity;\r\n    constructor() {\r\n        super();\r\n    }\r\n    public setEntity(e: Entity) {\r\n        this._entity = e;\r\n    }\r\n    public getEntity(): Entity {\r\n        return this._entity;\r\n    }\r\n    public destroy() {\r\n        this._entity = null;\r\n        super.destroy();\r\n    }\r\n}\r\n","import { Polygon, Vec2 } from \"planck-js\";\r\nimport { allCollideExcept, PhysicsGroup, pixels2Meter } from \"../systems/physics-system\";\r\nimport { PhysicsComponent } from \"./physics-component\";\r\nimport { ViewComponent } from \"./view-component\";\r\n\r\nexport class StaticPlatformComponent extends PhysicsComponent {\r\n    private filterMaskBits: number;\r\n    constructor(\r\n        x: number,\r\n        y: number,\r\n        group: PhysicsGroup,\r\n        width?: number,\r\n        height?: number,\r\n        filterMaskBits?: number,\r\n        view?: ViewComponent,\r\n    ) {\r\n        super(view || new ViewComponent(), group, {\r\n            position: new Vec2(pixels2Meter(x), pixels2Meter(y)),\r\n        });\r\n        if (!filterMaskBits) {\r\n            this.filterMaskBits = allCollideExcept(this.physicsGroup, PhysicsGroup.GAS);\r\n        } else {\r\n            this.filterMaskBits = filterMaskBits;\r\n        }\r\n        this.createShape(width, height);\r\n        if (!view) {\r\n            this.createView(width, height);\r\n        }\r\n    }\r\n    protected createView(width: number, height: number) {\r\n        const a = new PIXI.Graphics();\r\n        a.beginFill(0, 0.5);\r\n        a.drawRect(-width / 2, -height / 2, width, height);\r\n        a.endFill();\r\n        this.view.addChild(a);\r\n    }\r\n    protected createShape(width: number, height: number) {\r\n        let v = [\r\n            new Vec2(pixels2Meter(-(width - 0.5) / 2), pixels2Meter(-height / 2)),\r\n            new Vec2(pixels2Meter((width - 0.5) / 2), pixels2Meter(-height / 2)),\r\n            new Vec2(pixels2Meter(0), pixels2Meter(height / 2)),\r\n        ];\r\n        this.body.createFixture(new Polygon(v), {\r\n            density: 1,\r\n            friction: 1,\r\n            restitution: 0,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: this.filterMaskBits,\r\n        });\r\n        v = [\r\n            new Vec2(pixels2Meter(-width / 2), pixels2Meter(height / 2)),\r\n            new Vec2(pixels2Meter(-width / 2), pixels2Meter(-height / 2)),\r\n            new Vec2(pixels2Meter(0), pixels2Meter(height / 2)),\r\n        ];\r\n        this.body.createFixture(new Polygon(v), {\r\n            density: 1,\r\n            friction: 0,\r\n            restitution: 0,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: this.filterMaskBits,\r\n        });\r\n        v = [\r\n            new Vec2(pixels2Meter(width / 2), pixels2Meter(height / 2)),\r\n            new Vec2(pixels2Meter(width / 2), pixels2Meter(-height / 2)),\r\n            new Vec2(pixels2Meter(0), pixels2Meter(height / 2)),\r\n        ];\r\n        this.body.createFixture(new Polygon(v), {\r\n            density: 1,\r\n            friction: 0,\r\n            restitution: 0,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: this.filterMaskBits,\r\n        });\r\n    }\r\n}\r\n","import { app } from \".\";\r\nimport { IComponent } from \"./thagame/component\";\r\nimport { PhysicsComponent } from \"./thagame/components/physics-component\";\r\nimport { ViewComponent } from \"./thagame/components/view-component\";\r\n\r\nexport class Entity {\r\n    private components: IComponent[];\r\n    constructor() {\r\n        this.components = [];\r\n    }\r\n    public addComponent(component: IComponent) {\r\n        if (this.isView(component)) {\r\n            app.gameLayer.addChild(component);\r\n        } else if (this.isPhysics(component)) {\r\n            //app.physics.addBody(component.body);\r\n        }\r\n        component.setEntity(this);\r\n        this.components.push(component);\r\n    }\r\n    public removeComponent(comp: IComponent) {\r\n        if (this.isPhysics(comp)) {\r\n            app.physics.removeBody(comp.body);\r\n        } else if (this.isView(comp)) {\r\n            app.gameLayer.removeChild(comp);\r\n        }\r\n        comp.destroy();\r\n        const i = this.components.indexOf(comp);\r\n        if (i >= 0) {\r\n            this.components.splice(i, 1);\r\n        }\r\n    }\r\n    public getComponent<C extends IComponent>(constr: { new (...args: any[]): C }): C {\r\n        for (const component of this.components) {\r\n            if (component instanceof constr) {\r\n                return component as C;\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    public getAllComponents<C extends IComponent>(constr: { new (...args: any[]): C }): C[] {\r\n        const ret = [];\r\n        for (const component of this.components) {\r\n            if (component instanceof constr) {\r\n                ret.push(component as C);\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n    public clear() {\r\n        for (let i = this.components.length - 1; i >= 0; i--) {\r\n            this.removeComponent(this.components[i]);\r\n        }\r\n        this.components = [];\r\n    }\r\n\r\n    private isView(component: IComponent): component is ViewComponent {\r\n        return (\r\n            (component as ViewComponent).children !== undefined && (component as PhysicsComponent).view === undefined\r\n        );\r\n    }\r\n    private isPhysics(component: IComponent): component is PhysicsComponent {\r\n        return (component as PhysicsComponent).view !== undefined;\r\n    }\r\n}\r\n\r\nexport const createEntity = () => {\r\n    return new Entity();\r\n};\r\n","import { Contact, Body, BodyDef } from \"planck-js\";\r\nimport { app } from \"../..\";\r\nimport { Entity } from \"../../entity\";\r\nimport { BaseComponent } from \"../component\";\r\nimport { meter2Pixels, PhysicsGroup } from \"../systems/physics-system\";\r\nimport { ViewComponent } from \"./view-component\";\r\n\r\nexport class PhysicsComponent extends BaseComponent {\r\n    public view: ViewComponent;\r\n    public body: Body;\r\n    public physicsGroup: PhysicsGroup;\r\n    constructor(view: ViewComponent, group: PhysicsGroup, options: BodyDef) {\r\n        super();\r\n        this.body = app.physics.addBody(options);\r\n        this.body.setUserData(this);\r\n        this.physicsGroup = group;\r\n        this.view = view;\r\n        app.runners.loop.add(this);\r\n        app.runners.beginContact.add(this);\r\n        app.runners.endContact.add(this);\r\n    }\r\n    public loop() {\r\n        if (this.view) {\r\n            const bodyPos = this.body.getPosition();\r\n            this.view.position.set(meter2Pixels(bodyPos.x), meter2Pixels(bodyPos.y));\r\n            this.view.rotation = this.body.getAngle();\r\n        } else {\r\n            console.log(\"no view\");\r\n        }\r\n    }\r\n    public beginContact(evt: Contact) {\r\n        const anotherBody = PhysicsComponent.getAnotherBody(evt, this.body);\r\n        if (anotherBody) {\r\n            this.onBeginContacted(anotherBody);\r\n        }\r\n    }\r\n    public endContact(evt: Contact) {\r\n        const anotherBody = PhysicsComponent.getAnotherBody(evt, this.body);\r\n        if (anotherBody) {\r\n            this.onEndContacted(anotherBody);\r\n        }\r\n    }\r\n    public hide() {\r\n        this.view.visible = false;\r\n        this.body.setActive(false);\r\n    }\r\n    public show() {\r\n        this.view.visible = true;\r\n        this.body.setActive(true);\r\n    }\r\n    public destroy() {\r\n        super.destroy();\r\n        app.runners.loop.remove(this);\r\n        app.runners.beginContact.remove(this);\r\n        app.runners.endContact.remove(this);\r\n        this.view = null;\r\n    }\r\n    public setEntity(e: Entity) {\r\n        super.setEntity(e);\r\n        this._entity && this._entity.addComponent(this.view);\r\n    }\r\n    protected onBeginContacted(body: Body) {\r\n        //begin contact with body\r\n    }\r\n    protected onEndContacted(body: Body) {\r\n        //end contact with body\r\n    }\r\n    public static isContacted(contact: Contact, body1: Body, body2: Body): boolean {\r\n        return (\r\n            (contact.getFixtureA().getBody() === body1 && contact.getFixtureB().getBody() === body2) ||\r\n            (contact.getFixtureB().getBody() === body1 && contact.getFixtureA().getBody() === body2)\r\n        );\r\n    }\r\n    public static getAnotherBody(contact: Contact, body: Body): Body {\r\n        if (contact.getFixtureA().getBody() === body) {\r\n            return contact.getFixtureB().getBody();\r\n        } else if (contact.getFixtureB().getBody() === body) {\r\n            return contact.getFixtureA().getBody();\r\n        }\r\n        return null;\r\n    }\r\n}\r\n","import { Deferred } from \"./deferred\";\r\n\r\nexport const delay = (duration: number) => {\r\n    const d = new Deferred();\r\n    let progress = 0;\r\n\r\n    const ticker = (delta: number) => {\r\n        progress += delta;\r\n\r\n        const elapsed = progress / (60 * PIXI.Ticker.shared.speed);\r\n\r\n        if (elapsed >= duration / 1000) {\r\n            PIXI.Ticker.shared.remove(ticker);\r\n            d.resolve();\r\n        }\r\n    };\r\n\r\n    PIXI.Ticker.shared.add(ticker);\r\n    return d;\r\n};\r\n","import { app } from \"../..\";\r\nimport { gsap } from \"gsap\";\r\nimport { BaseComponent } from \"../component\";\r\nimport { CharacterComponent } from \"./character-component\";\r\n\r\nexport enum Action {\r\n    LEFT,\r\n    RIGHT,\r\n    ACTION,\r\n    SUPERACTION,\r\n}\r\nexport class ControlledComponent extends BaseComponent {\r\n    public character: CharacterComponent;\r\n    private movement: { right: 0 | 1; left: 0 | 1; up: 0 | 1 };\r\n    private _enabled: boolean;\r\n    private _id: number;\r\n    private tween: gsap.core.Tween;\r\n    constructor(id: number, character: CharacterComponent) {\r\n        super();\r\n        this.id = id;\r\n        this.character = character;\r\n        this.enabled = false;\r\n        this.movement = {\r\n            right: 0,\r\n            left: 0,\r\n            up: 0,\r\n        };\r\n        app.runners.loop.add(this);\r\n    }\r\n    public loop() {\r\n        if (this.enabled) {\r\n            const delta = this.movement.right - this.movement.left;\r\n            this.character.move(delta);\r\n        }\r\n    }\r\n    public startAction(action: Action) {\r\n        if (!this.enabled) return;\r\n        if (this.tween) this.tween.seek(this.tween.duration());\r\n        switch (action) {\r\n            case Action.RIGHT:\r\n                this.movement.right = 1;\r\n                break;\r\n            case Action.LEFT:\r\n                this.movement.left = 1;\r\n                break;\r\n            case Action.ACTION:\r\n                this.movement.up = 1;\r\n                this.character.action();\r\n                break;\r\n            case Action.SUPERACTION:\r\n                this.character.superAction();\r\n                break;\r\n        }\r\n    }\r\n    public stopAction(action: Action) {\r\n        switch (action) {\r\n            case Action.RIGHT:\r\n                this.tween = gsap.to(this.movement, {\r\n                    duration: 0.2,\r\n                    right: 0,\r\n                    ease: \"linear\",\r\n                });\r\n                break;\r\n            case Action.LEFT:\r\n                this.tween = gsap.to(this.movement, {\r\n                    duration: 0.2,\r\n                    left: 0,\r\n                    ease: \"linear\",\r\n                });\r\n                break;\r\n            case Action.ACTION:\r\n                this.movement.up = 0;\r\n                this.character.stopAction();\r\n                break;\r\n        }\r\n    }\r\n    public set id(i: number) {\r\n        this._id = i;\r\n    }\r\n    public get id(): number {\r\n        return this._id;\r\n    }\r\n    public set enabled(e: boolean) {\r\n        this._enabled = e;\r\n    }\r\n    public get enabled(): boolean {\r\n        return this._enabled;\r\n    }\r\n    public destroy() {\r\n        app.runners.loop.remove(this);\r\n        super.destroy();\r\n        this._enabled = false;\r\n    }\r\n}\r\n","import { AssetsLoaderSystem } from \"./systems/assets-loader-system\";\r\nimport { CharactersSystem } from \"./systems/characters-system\";\r\nimport { CoinsSystem } from \"./systems/coins-system\";\r\nimport { ControlledSystem } from \"./systems/controlled-system\";\r\nimport { EnemiesSystem } from \"./systems/enemies-system\";\r\nimport { GameSystem } from \"./systems/game-system\";\r\nimport { GUISystem } from \"./systems/gui-system\";\r\nimport { HostsSystem } from \"./systems/hosts-system\";\r\nimport { PhysicsSystem } from \"./systems/physics-system\";\r\nimport { SoundSystem } from \"./systems/sound-system\";\r\nimport { SplashSystem } from \"./systems/splash-system\";\r\n\r\nexport const WIDTH = 1280;\r\nexport const HEIGHT = 720;\r\nexport class Application {\r\n    public runners: { [key: string]: PIXI.Runner };\r\n    public renderer: PIXI.Renderer;\r\n    public gameLayer: PIXI.Container;\r\n    public guiLayer: PIXI.Container;\r\n    public ticker: PIXI.Ticker;\r\n    public loader: PIXI.Loader;\r\n    public assets: AssetsLoaderSystem;\r\n    public physics: PhysicsSystem;\r\n    public game: GameSystem;\r\n    public characters: CharactersSystem;\r\n    public enemies: EnemiesSystem;\r\n    public hosts: HostsSystem;\r\n    public gui: GUISystem;\r\n    public coins: CoinsSystem;\r\n    public sounds: SoundSystem;\r\n    private stage: PIXI.Container;\r\n    private controls: ControlledSystem;\r\n    private splash: SplashSystem;\r\n\r\n    constructor() {\r\n        const options = {\r\n            width: WIDTH,\r\n            height: HEIGHT,\r\n            backgroundColor: 0x1099bb,\r\n            autoDensity: true,\r\n            resolution: window.devicePixelRatio,\r\n        };\r\n\r\n        const app = new PIXI.Application(options);\r\n        this.renderer = app.renderer;\r\n        this.stage = new PIXI.Container();\r\n        this.gameLayer = new PIXI.Container();\r\n        this.guiLayer = new PIXI.Container();\r\n        this.stage.addChild(this.gameLayer);\r\n        this.stage.addChild(this.guiLayer);\r\n        this.ticker = new PIXI.Ticker();\r\n\r\n        // Application components\r\n        this.runners = {\r\n            init: new PIXI.Runner(\"init\"),\r\n            load: new PIXI.Runner(\"load\"),\r\n            loop: new PIXI.Runner(\"loop\"),\r\n            start: new PIXI.Runner(\"start\"),\r\n            resize: new PIXI.Runner(\"resize\"),\r\n            entityAdded: new PIXI.Runner(\"entityAdded\"),\r\n            entityRemoved: new PIXI.Runner(\"entityRemoved\"),\r\n            beginContact: new PIXI.Runner(\"beginContact\"),\r\n            endContact: new PIXI.Runner(\"endContact\"),\r\n            postStep: new PIXI.Runner(\"postStep\"),\r\n            gameStarted: new PIXI.Runner(\"gameStarted\"),\r\n            characterSwitched: new PIXI.Runner(\"characterSwitched\"),\r\n        };\r\n        this.ticker.add((delta) => {\r\n            this.render();\r\n            this.runners.loop.emit(delta);\r\n        }, PIXI.UPDATE_PRIORITY.LOW);\r\n\r\n        this.ticker.start();\r\n\r\n        this.loader = new PIXI.Loader();\r\n\r\n        this.addSystem((this.assets = new AssetsLoaderSystem()));\r\n        this.addSystem((this.splash = new SplashSystem()));\r\n        this.addSystem((this.physics = new PhysicsSystem()));\r\n        this.addSystem((this.game = new GameSystem()));\r\n        this.addSystem((this.characters = new CharactersSystem()));\r\n        this.addSystem((this.controls = new ControlledSystem()));\r\n        this.addSystem((this.enemies = new EnemiesSystem()));\r\n        this.addSystem((this.hosts = new HostsSystem()));\r\n        this.addSystem((this.gui = new GUISystem()));\r\n        this.addSystem((this.coins = new CoinsSystem()));\r\n        this.addSystem((this.sounds = new SoundSystem()));\r\n\r\n        window.addEventListener(\r\n            \"resize\",\r\n            () => {\r\n                this.resize();\r\n            },\r\n            false,\r\n        );\r\n    }\r\n\r\n    public get view() {\r\n        return this.renderer.view;\r\n    }\r\n\r\n    public get screen() {\r\n        return this.renderer.screen;\r\n    }\r\n\r\n    public render() {\r\n        this.renderer.render(this.stage);\r\n    }\r\n\r\n    public destroy() {\r\n        this.renderer.destroy();\r\n        this.ticker.destroy();\r\n    }\r\n\r\n    public resize() {\r\n        this.renderer.resize(window.innerWidth, window.innerHeight);\r\n        this.render();\r\n        this.runners.resize.emit(window.innerWidth, window.innerHeight);\r\n    }\r\n\r\n    private addSystem(system: any) {\r\n        for (const key in this.runners) {\r\n            const runner: PIXI.Runner = this.runners[key];\r\n            runner.add(system);\r\n        }\r\n    }\r\n}\r\n","import { app } from \"../..\";\r\nimport { BaseComponent } from \"../component\";\r\nimport { ControlledComponent } from \"./controlled-component\";\r\nimport { IHostedMovable } from \"./imovable\";\r\n\r\nexport class HostedComponent extends BaseComponent {\r\n    public character: IHostedMovable;\r\n    private controlled: ControlledComponent;\r\n    constructor(character: IHostedMovable) {\r\n        super();\r\n        this.character = character;\r\n        const comp = (this.character as unknown) as BaseComponent;\r\n        this.controlled = comp && comp.getEntity().getComponent(ControlledComponent);\r\n    }\r\n    public putHost() {\r\n        if (this.controlled) {\r\n            app.gui.hostButton(this.controlled.id);\r\n        }\r\n        this.character.putHost();\r\n    }\r\n    public releaseHost() {\r\n        if (this.controlled) {\r\n            app.gui.unhostButton(this.controlled.id);\r\n        }\r\n        this.character.releaseHost();\r\n    }\r\n    public hasHost(): boolean {\r\n        return this.character.hosted;\r\n    }\r\n}\r\n","import { Entity } from \"../entity\";\r\n\r\nexport interface IComponent {\r\n    getEntity(): Entity;\r\n    setEntity(e: Entity): void;\r\n    destroy();\r\n}\r\nexport class BaseComponent implements IComponent {\r\n    protected _entity: Entity;\r\n    public setEntity(e: Entity) {\r\n        this._entity = e;\r\n    }\r\n    public getEntity(): Entity {\r\n        return this._entity;\r\n    }\r\n    public disable() {}\r\n    public enable() {}\r\n    public destroy() {\r\n        this._entity = null;\r\n    }\r\n}\r\n","import { app } from \"../..\";\r\nimport { Entity } from \"../../entity\";\r\nimport { HEIGHT, WIDTH } from \"../application\";\r\nimport { Level4 } from \"../levels/level4\";\r\nimport * as screenfull from \"screenfull\";\r\nimport gsap from \"gsap\";\r\nimport { ILevel } from \"../levels/ilevel\";\r\nimport { Level1 } from \"../levels/level1\";\r\nimport { Level2 } from \"../levels/level2\";\r\nimport { Level3 } from \"../levels/level3\";\r\nimport { RespawnComponent } from \"../components/respawn-component\";\r\nimport { BaseComponent } from \"../component\";\r\nimport { PhysicsComponent } from \"../components/physics-component\";\r\nimport { Vec2 } from \"planck-js\";\r\nimport { delay } from \"../utils/delay\";\r\nimport { pixels2Meter } from \"./physics-system\";\r\nimport { HostedComponent } from \"../components/hosted-component\";\r\n\r\nexport enum LevelsExecuter {\r\n    LEVEL1_SHOW_TUBE,\r\n    LEVEL1_HIDE_TUBE,\r\n    LEVEL1_REMOVE_WATER,\r\n    LEVEL_FINISHED,\r\n}\r\n\r\nexport class GameSystem {\r\n    public entities: Entity[];\r\n    private levels: ILevel[];\r\n    private currentLevelId: number;\r\n    private prevLevel: ILevel;\r\n    public init() {\r\n        this.entities = [];\r\n        this.levels = [new Level1(), new Level2(), new Level3(), new Level4()];\r\n        this.currentLevelId = 0;\r\n\r\n        if (screenfull.isEnabled && PIXI.utils.isMobile.any) {\r\n            const play = document.getElementById(\"splash\")!;\r\n            play.style.display = \"block\";\r\n            play.addEventListener(\"touchend\", () => {\r\n                play.style.display = \"none\";\r\n                screenfull.request();\r\n            });\r\n        }\r\n    }\r\n    public start(level: number) {\r\n        if (level === 1) {\r\n            this.currentLevelId = 3;\r\n        } else {\r\n            this.currentLevelId = 0;\r\n        }\r\n        this.level.init();\r\n    }\r\n    public restart() {\r\n        if (this.prevLevel) {\r\n            this.prevLevel.destroy();\r\n            this.prevLevel = undefined;\r\n        }\r\n\r\n        this.removeAll();\r\n        this.level.restart();\r\n        app.gui.restart();\r\n        //app.physics.unpause();\r\n    }\r\n    public gameOver() {\r\n        //gsap.ticker.sleep();\r\n        //app.physics.pause();\r\n        app.gui.gameOver();\r\n    }\r\n    public finishLevel() {\r\n        app.gui.finishLevel(app.coins.levelsCoins);\r\n        this.level.finishLevel();\r\n        this.prevLevel = this.level;\r\n        if (this.currentLevelId + 1 < this.levels.length) {\r\n            this.currentLevelId++;\r\n        } else {\r\n            this.currentLevelId = 0;\r\n        }\r\n    }\r\n    public resize(width: number, height: number) {\r\n        let newWidth = 0;\r\n        let newHeight = 0;\r\n        let scale = 1;\r\n        if (height / width < HEIGHT / WIDTH) {\r\n            newHeight = height;\r\n            newWidth = (newHeight * WIDTH) / HEIGHT;\r\n            scale = newHeight / HEIGHT;\r\n        } else {\r\n            newWidth = width;\r\n            newHeight = (newWidth * HEIGHT) / WIDTH;\r\n            scale = newWidth / WIDTH;\r\n        }\r\n\r\n        app.gameLayer.scale.set(scale, scale);\r\n        app.gameLayer.position.set(width / 2 - newWidth / 2, height / 2 - newHeight / 2);\r\n    }\r\n    public get level(): ILevel {\r\n        return this.levels[this.currentLevelId];\r\n    }\r\n    public execute(action: LevelsExecuter) {\r\n        if (action === LevelsExecuter.LEVEL_FINISHED) {\r\n            this.finishLevel();\r\n            app.characters.disableCharacters();\r\n            app.gui.disableAll();\r\n        } else {\r\n            this.level.execute(action);\r\n        }\r\n    }\r\n    public add(entity: Entity) {\r\n        this.entities.push(entity);\r\n        app.runners.entityAdded.emit(entity);\r\n    }\r\n    public remove(entity: Entity, ignoreRespawn?: boolean) {\r\n        const hosted = entity.getComponent(HostedComponent);\r\n        if (hosted && hosted.hasHost()) {\r\n            hosted.releaseHost();\r\n            app.hosts.host && app.hosts.host.releaseHost();\r\n        }\r\n        const respawn = entity.getComponent(RespawnComponent);\r\n        if (respawn && !ignoreRespawn) {\r\n            const physics = entity.getComponent(PhysicsComponent);\r\n            if (physics) {\r\n                app.physics.moveBodyAndSleep(physics.body, new Vec2(-100, -100));\r\n            }\r\n            const components = entity.getAllComponents(BaseComponent);\r\n            components.forEach((c) => {\r\n                c.disable();\r\n            });\r\n            delay(respawn.delay).then(() => {\r\n                if (physics) {\r\n                    const pos = new Vec2(pixels2Meter(respawn.x), pixels2Meter(respawn.y));\r\n                    this.level.createExplosion(pos, 200, 0);\r\n                    app.physics.moveBody(physics.body, pos);\r\n                }\r\n                components.forEach((c) => {\r\n                    c.enable();\r\n                });\r\n            });\r\n        } else {\r\n            app.runners.entityRemoved.emit(entity);\r\n            const ind = this.entities.indexOf(entity);\r\n            if (ind >= 0) {\r\n                this.entities.splice(ind, 1);\r\n            }\r\n            entity.clear();\r\n        }\r\n    }\r\n    private removeAll() {\r\n        for (let i = this.entities.length - 1; i >= 0; i--) {\r\n            if (this.entities[i]) {\r\n                this.remove(this.entities[i], true);\r\n            }\r\n            this.entities.splice(i, 1);\r\n        }\r\n    }\r\n}\r\n","import { Contact, Vec2, Body } from \"planck-js\";\r\nimport { app } from \"../..\";\r\nimport { BaseComponent } from \"../component\";\r\nimport { PhysicsGroup, pixels2Meter } from \"../systems/physics-system\";\r\nimport { delay } from \"../utils/delay\";\r\nimport { CharacterComponent } from \"./character-component\";\r\nimport { Enemy } from \"./level1/enemy\";\r\nimport { Gas } from \"./level1/gas\";\r\nimport { PhysicsComponent } from \"./physics-component\";\r\nimport { WeaponComponent } from \"./weapon-component\";\r\n\r\nexport class DamageComponent extends BaseComponent {\r\n    public physicsComponent: PhysicsComponent;\r\n    private damageGroups: PhysicsGroup[];\r\n    constructor(body: PhysicsComponent, damageGroups: PhysicsGroup | PhysicsGroup[]) {\r\n        super();\r\n        this.physicsComponent = body as PhysicsComponent;\r\n        this.damageGroups = Array.isArray(damageGroups) ? damageGroups : [damageGroups];\r\n        app.runners.beginContact.add(this);\r\n    }\r\n    public beginContact(evt: Contact) {\r\n        if (!this.physicsComponent) return;\r\n        const anotherBody = PhysicsComponent.getAnotherBody(evt, this.physicsComponent.body);\r\n        if (anotherBody && this.damageGroups.some((d) => anotherBody.getFixtureList().m_filterCategoryBits === d)) {\r\n            const character = this.getEntity().getComponent(CharacterComponent);\r\n            const thisEnemy = this.getEntity().getComponent(Enemy);\r\n            const anotherComponent = anotherBody.getUserData() as BaseComponent;\r\n            const anotherIsEnemy = anotherComponent.getEntity().getComponent(Enemy);\r\n            const gas = anotherComponent.getEntity().getComponent(Gas);\r\n            const weapon = anotherComponent.getEntity().getComponent(WeaponComponent);\r\n            const isEnemyKill = thisEnemy && (gas || (weapon && weapon.active && !thisEnemy.hosted));\r\n            if ((character && ((anotherIsEnemy && !anotherIsEnemy.hosted) || gas)) || isEnemyKill) {\r\n                /*if (respawn) {\r\n                    const body = isEnemyKill ? thisEnemy.body : character.body;\r\n                    delay(respawn.delay).then(() => {\r\n                        app.physics.moveBody(body, new Vec2(pixels2Meter(respawn.x), pixels2Meter(respawn.y)));\r\n                    });\r\n                } else {\r\n                    this.kill();\r\n                }*/\r\n                this.kill();\r\n                //app.characters.disableCharacters();\r\n                //app.gui.disableAll();\r\n            }\r\n        }\r\n    }\r\n    public kill() {\r\n        app.game.remove(this._entity);\r\n    }\r\n    public destroy() {\r\n        super.destroy();\r\n        this.physicsComponent = null;\r\n        app.runners.beginContact.remove(this);\r\n    }\r\n}\r\n","import { gsap } from \"gsap\";\r\nimport { Body, Box, Vec2 } from \"planck-js\";\r\nimport { allCollideExcept, PhysicsGroup, pixels2Meter } from \"../systems/physics-system\";\r\nimport { WeaponView } from \"../views/weapon-view\";\r\nimport { NinjaComponent } from \"./ninja-component\";\r\nimport { PhysicsComponent } from \"./physics-component\";\r\n\r\nexport class WeaponComponent extends PhysicsComponent {\r\n    private inAction: boolean;\r\n    private ninja: NinjaComponent;\r\n    constructor(ninja: NinjaComponent) {\r\n        super(new WeaponView(), PhysicsGroup.DANGER, {\r\n            type: Body.KINEMATIC,\r\n            position: ninja.body.getPosition(),\r\n            angle: 0 * PIXI.DEG_TO_RAD,\r\n        });\r\n        this.ninja = ninja;\r\n        this.createShape();\r\n    }\r\n    public get active() {\r\n        return this.inAction;\r\n    }\r\n    public loop() {\r\n        super.loop();\r\n        if (this.body && this.ninja && this.ninja.view) {\r\n            const s = this.ninja.view.scale.x;\r\n            this.body.setPosition(this.ninja.body.getPosition());\r\n            this.body.getPosition().x -= pixels2Meter(5 * s);\r\n        }\r\n    }\r\n    public action() {\r\n        if (!this.inAction) {\r\n            const s = this.ninja.view.scale.x;\r\n            this.inAction = true;\r\n            const r = { angle: this.body.getAngle() };\r\n            gsap.to(r, {\r\n                duration: 0.1,\r\n                angle: s * 90 * PIXI.DEG_TO_RAD,\r\n                ease: \"linear\",\r\n                onUpdate: () => {\r\n                    this.body.setAngle(r.angle);\r\n                },\r\n            });\r\n            gsap.to(r, {\r\n                duration: 0.1,\r\n                delay: 0.1,\r\n                angle: 0 * PIXI.DEG_TO_RAD,\r\n                ease: \"linear\",\r\n                onUpdate: () => {\r\n                    this.body.setAngle(r.angle);\r\n                },\r\n                onComplete: () => {\r\n                    this.inAction = false;\r\n                },\r\n            });\r\n        }\r\n    }\r\n    protected createShape() {\r\n        this.body.createFixture(new Box(pixels2Meter(6), pixels2Meter(60), new Vec2(0, pixels2Meter(-30))), {\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: allCollideExcept(this.physicsGroup, PhysicsGroup.HEROES, PhysicsGroup.GHOST),\r\n        });\r\n\r\n        /*const gfx = new PIXI.Graphics();\r\n        gfx.beginFill(0xffff00, 1);\r\n        gfx.drawRect(-3, -50, 6, 60);\r\n        gfx.endFill();\r\n        this.view.addChild(gfx);*/\r\n    }\r\n}\r\n","import { Body, Circle, Vec2 } from \"planck-js\";\r\nimport { app } from \"../..\";\r\nimport { PhysicsGroup, pixels2Meter } from \"../systems/physics-system\";\r\nimport { CoinView } from \"../views/coin-view\";\r\nimport { PhysicsComponent } from \"./physics-component\";\r\n\r\nexport class CoinComponent extends PhysicsComponent {\r\n    constructor(pos: Vec2) {\r\n        super(new CoinView(), PhysicsGroup.STAR, {\r\n            type: Body.KINEMATIC,\r\n            position: new Vec2(pixels2Meter(pos.x), pixels2Meter(pos.y)),\r\n        });\r\n        this.createShape();\r\n    }\r\n    protected createShape() {\r\n        this.body.createFixture(new Circle(Vec2.zero(), pixels2Meter(13)), {\r\n            isSensor: true,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: PhysicsGroup.HEROES | PhysicsGroup.GHOST,\r\n        });\r\n    }\r\n    protected onBeginContacted(body: Body) {\r\n        app.coins.getCoin();\r\n        app.game.remove(this.getEntity());\r\n    }\r\n}\r\n","import { BodyDef, Vec2 } from \"planck-js\";\r\nimport { PhysicsGroup } from \"../systems/physics-system\";\r\nimport { ICharacterView } from \"../views/icharacter-view\";\r\nimport { ControlledComponent } from \"./controlled-component\";\r\nimport { IHostedMovable } from \"./imovable\";\r\nimport { PhysicsComponent } from \"./physics-component\";\r\nimport { ViewComponent } from \"./view-component\";\r\nimport { GlowFilter } from \"@pixi/filter-glow\";\r\n\r\nexport class CharacterComponent extends PhysicsComponent implements IHostedMovable {\r\n    public characterSettings: { speed: number; jumpForce: number };\r\n    public hosted: boolean;\r\n    protected characterView: ICharacterView;\r\n    constructor(view: ViewComponent, group: PhysicsGroup, options?: BodyDef) {\r\n        super(view, group, options);\r\n        this.hosted = false;\r\n        this.characterView = (this.view as unknown) as ICharacterView;\r\n        this.body.setSleepingAllowed(false);\r\n    }\r\n    public action() {\r\n        if (this.canAction()) {\r\n            this.doAction();\r\n        }\r\n    }\r\n    public stopAction() {\r\n        //nothing\r\n    }\r\n    public superAction() {\r\n        if (this.canSuperAction()) {\r\n            this.doSuperAction();\r\n        }\r\n    }\r\n    public move(delta: number) {\r\n        if (this.canMove()) {\r\n            this.doMove(delta);\r\n        }\r\n    }\r\n    public loop() {\r\n        super.loop();\r\n        const velX = this.body.getLinearVelocity().x;\r\n        const fx = Math.floor(Math.abs(velX) * 10) / 10;\r\n        if (this.view && fx !== 0) {\r\n            this.view.scale.x = Math.abs(velX) / velX;\r\n        }\r\n    }\r\n    public putHost() {\r\n        this.hosted = true;\r\n        this.characterView.idle();\r\n        this.view.filters = [new GlowFilter()];\r\n    }\r\n    public releaseHost(): void {\r\n        this.hosted = false;\r\n        this.characterView.idle();\r\n        this.view && (this.view.filters = []);\r\n    }\r\n    public get controlledComponent(): ControlledComponent {\r\n        return this._entity && this._entity.getComponent(ControlledComponent);\r\n    }\r\n    public set enabled(e: boolean) {\r\n        if (this.controlledComponent) {\r\n            this.controlledComponent.enabled = e;\r\n            if (!e && this.characterView) {\r\n                this.characterView.idle();\r\n            }\r\n        }\r\n    }\r\n    public get enabled(): boolean {\r\n        return this.controlledComponent && this.controlledComponent.enabled;\r\n    }\r\n    protected doMove(delta: number) {\r\n        if (this.canAction()) {\r\n            if (delta !== 0) {\r\n                this.characterView.walk();\r\n            } else {\r\n                this.characterView.idle();\r\n            }\r\n        }\r\n        if (delta !== 0) {\r\n            this.body.m_linearVelocity.x = this.characterSettings.speed * delta;\r\n        }\r\n    }\r\n    protected doAction() {\r\n        this.characterView.action();\r\n        this.body.applyLinearImpulse(new Vec2(0, -this.characterSettings.jumpForce), Vec2.zero(), true);\r\n    }\r\n    protected canAction() {\r\n        return Math.floor(Math.abs(this.body.getLinearVelocity().y) * 100) / 100 === 0;\r\n    }\r\n    protected doSuperAction() {\r\n        this.characterView.superAction();\r\n    }\r\n    protected canSuperAction() {\r\n        return true;\r\n    }\r\n    protected canMove() {\r\n        return true;\r\n    }\r\n}\r\n","import { BodyDef, Body } from \"planck-js\";\r\nimport { LevelsExecuter } from \"../systems/game-system\";\r\nimport { PhysicsGroup } from \"../systems/physics-system\";\r\nimport { PhysicsComponent } from \"./physics-component\";\r\nimport { ViewComponent } from \"./view-component\";\r\n\r\nexport class SensorComponent extends PhysicsComponent {\r\n    public triggered: boolean;\r\n    protected executor: LevelsExecuter;\r\n    constructor(view: ViewComponent, group: PhysicsGroup, options?: BodyDef) {\r\n        super(view, group, options);\r\n        this.triggered = false;\r\n    }\r\n    public execute(isBeginContact: boolean, body: Body) {}\r\n    protected onBeginContacted(body: Body) {\r\n        this.execute(true, body);\r\n    }\r\n    protected onEndContacted(body: Body) {\r\n        this.execute(false, body);\r\n    }\r\n    protected createShape() {}\r\n    protected createView() {}\r\n}\r\n","import { Body, Circle, Vec2 } from \"planck-js\";\r\nimport { allCollideExcept, PhysicsGroup, pixels2Meter } from \"../../systems/physics-system\";\r\nimport { Deferred } from \"../../utils/deferred\";\r\nimport { delay } from \"../../utils/delay\";\r\nimport { EnemyView } from \"../../views/enemy-view\";\r\nimport { IHostedMovable } from \"../imovable\";\r\nimport { PhysicsComponent } from \"../physics-component\";\r\nimport { GlowFilter } from \"@pixi/filter-glow\";\r\n\r\nexport class Enemy extends PhysicsComponent implements IHostedMovable {\r\n    public hosted: boolean;\r\n    private delayPromise: Deferred;\r\n    private direction: number;\r\n    private jumping: boolean;\r\n    private enemyView: EnemyView;\r\n    constructor(x: number, y: number) {\r\n        super(new EnemyView(), PhysicsGroup.ENEMIES, {\r\n            type: Body.DYNAMIC,\r\n            position: new Vec2(pixels2Meter(x), pixels2Meter(y)),\r\n        });\r\n        this.hosted = false;\r\n        this.body.setMassData({ mass: 0.1, center: Vec2.zero(), I: 1 });\r\n        this.body.setFixedRotation(true);\r\n        this.body.setSleepingAllowed(false);\r\n        this.createShape();\r\n        this.enemyView = this.view as EnemyView;\r\n        this.thinkAndGo();\r\n    }\r\n    public pause() {\r\n        this.disable();\r\n    }\r\n    public action(): void {\r\n        //nothing\r\n    }\r\n    public releaseHost(): void {\r\n        this.hosted = false;\r\n        this.view.filters = [];\r\n        this.thinkAndGo();\r\n    }\r\n    public putHost(): void {\r\n        this.hosted = true;\r\n        this.view.filters = [new GlowFilter()];\r\n        if (this.delayPromise) {\r\n            this.delayPromise.reject();\r\n        }\r\n    }\r\n    public disable() {\r\n        if (this.delayPromise) {\r\n            this.delayPromise.reject();\r\n        }\r\n        this.enemyView.idle();\r\n        this.body.setLinearVelocity(Vec2.zero());\r\n        this.hosted = true;\r\n    }\r\n    public enable() {\r\n        this.hosted = false;\r\n    }\r\n    protected onBeginContacted(body: Body) {\r\n        if (this.hosted) return;\r\n        const bits = body.getFixtureList().m_filterCategoryBits;\r\n        if (bits === PhysicsGroup.BOMB && this.canJump()) {\r\n            this.jump();\r\n        } else if (bits !== PhysicsGroup.GAS && bits !== PhysicsGroup.DEFAULT && bits !== PhysicsGroup.GHOST) {\r\n            this.direction *= -1;\r\n        }\r\n    }\r\n    protected jump() {\r\n        this.enemyView.action();\r\n        this.body.applyLinearImpulse(new Vec2(0, -15), Vec2.zero(), true);\r\n    }\r\n    protected canJump() {\r\n        return Math.floor(Math.abs(this.body.getLinearVelocity().y) * 100) / 100 === 0;\r\n    }\r\n    public move(delta: number) {\r\n        if (delta !== 0 && Math.abs(this.body.m_linearVelocity.x) < 5) {\r\n            this.enemyView.walk();\r\n            if (!this.hosted) {\r\n                this.body.applyForceToCenter(new Vec2(15 * delta, 0));\r\n            } else {\r\n                this.body.m_linearVelocity.x = 3 * delta;\r\n            }\r\n        } else if (delta === 0) {\r\n            this.enemyView.idle();\r\n        }\r\n    }\r\n    public loop() {\r\n        if (!this.hosted) {\r\n            this.move(this.direction);\r\n        }\r\n        const velX = this.body.getLinearVelocity().x;\r\n        const fx = Math.floor(Math.abs(velX) * 10) / 10;\r\n        if (this.view && fx !== 0) {\r\n            this.view.scale.x = Math.abs(velX) / velX;\r\n        }\r\n        super.loop();\r\n        if (!this.hosted && this.body.getPosition().x <= 17) {\r\n            this.direction *= -1;\r\n            this.body.applyLinearImpulse(new Vec2(3, 0), Vec2.zero());\r\n        }\r\n    }\r\n    private thinkAndGo() {\r\n        this.enemyView.idle();\r\n        this.direction = 0;\r\n        this.delayPromise = delay(3000);\r\n        this.delayPromise.then(() => {\r\n            this.direction = Math.random() < 0.5 ? 1 : -1;\r\n        });\r\n    }\r\n\r\n    protected createShape() {\r\n        this.body.createFixture(new Circle(pixels2Meter(20)), {\r\n            density: 1,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: allCollideExcept(this.physicsGroup),\r\n        });\r\n    }\r\n    public destroy() {\r\n        if (this.delayPromise) {\r\n            this.delayPromise.reject();\r\n        }\r\n        super.destroy();\r\n    }\r\n}\r\n","import { app } from \"../..\";\r\nimport { Entity } from \"../../entity\";\r\nimport { ViewComponent } from \"./view-component\";\r\n\r\nexport class TipComponent extends ViewComponent {\r\n    private deltaX: number;\r\n    private deltaY: number;\r\n    private arrowAngle: number;\r\n    private text: string;\r\n    private parentView: ViewComponent;\r\n    constructor(deltaX: number, deltaY: number, angle: number, text: string) {\r\n        super();\r\n        this.deltaX = deltaX;\r\n        this.deltaY = deltaY;\r\n        this.arrowAngle = angle;\r\n        this.text = text;\r\n        app.runners.loop.add(this);\r\n    }\r\n    public loop() {\r\n        try {\r\n            this.position.copyFrom(this.parentView);\r\n            this.visible = this.parentView.visible;\r\n        } catch (e) {\r\n            console.log(\"tip: no parent\");\r\n        }\r\n    }\r\n    public setEntity(e: Entity) {\r\n        super.setEntity(e);\r\n        this.parentView = e.getComponent(ViewComponent);\r\n        const arrow = PIXI.Sprite.from(PIXI.utils.TextureCache[\"arrow\"]);\r\n        arrow.anchor.set(0.5);\r\n        arrow.scale.set(0.7);\r\n        arrow.angle = this.arrowAngle;\r\n        arrow.position.set(this.deltaX, this.deltaY);\r\n        this.addChild(arrow);\r\n\r\n        const x = arrow.x - (arrow.width / 1.3) * Math.cos(arrow.rotation);\r\n        const y = arrow.y - (arrow.width / 1.3) * Math.sin(arrow.rotation);\r\n\r\n        const txt = new PIXI.Text(this.text, {\r\n            fontFamily: \"Geometria\",\r\n            fill: \"#ffff00\",\r\n            align: \"center\",\r\n            fontSize: 16,\r\n        });\r\n        txt.anchor.set(0, 0.5);\r\n        txt.position.set(x, y);\r\n        this.addChild(txt);\r\n    }\r\n    public destroy() {\r\n        app.runners.loop.remove(this);\r\n        super.destroy();\r\n    }\r\n}\r\n","import { BaseComponent } from \"../component\";\r\n\r\nexport class RespawnComponent extends BaseComponent {\r\n    public x: number;\r\n    public y: number;\r\n    public delay: number;\r\n    constructor(x: number, y: number, delay: number) {\r\n        super();\r\n        this.x = x;\r\n        this.y = y;\r\n        this.delay = delay;\r\n    }\r\n}\r\n","import { gsap } from \"gsap\";\r\nexport class CharacterLeg extends PIXI.Container {\r\n    private gfx: PIXI.Sprite;\r\n    private tween: gsap.core.Tween;\r\n    private walking: boolean;\r\n    private hasDelay: boolean;\r\n    private speed: number;\r\n    private actioning: boolean;\r\n    constructor(textureName: string, speed: number, hasDelay = false) {\r\n        super();\r\n        this.speed = speed;\r\n        this.hasDelay = hasDelay;\r\n        this.gfx = PIXI.Sprite.from(PIXI.utils.TextureCache[textureName]);\r\n        this.gfx.anchor.set(0.5);\r\n        this.addChild(this.gfx);\r\n        this.idle();\r\n    }\r\n    public idle() {\r\n        this.killTweens();\r\n        this.walking = false;\r\n        this.actioning = false;\r\n        this.gfx.angle = 0;\r\n        this.tween = gsap.to(this.gfx.position, {\r\n            duration: this.speed / 3,\r\n            x: 0,\r\n            y: 0,\r\n            ease: \"linear\",\r\n        });\r\n    }\r\n    public walk() {\r\n        this.actioning = false;\r\n        if (!this.walking) {\r\n            this.killTweens();\r\n            this.walking = true;\r\n            if (this.hasDelay) {\r\n                this.tween = gsap.to(this.gfx.position, {\r\n                    y: 0,\r\n                    x: -10,\r\n                    duration: this.speed / 3,\r\n                    onComplete: () => {\r\n                        this.startWalk();\r\n                    },\r\n                });\r\n            } else {\r\n                this.startWalk();\r\n            }\r\n        }\r\n    }\r\n    public action() {\r\n        this.walking = false;\r\n        if (!this.actioning) {\r\n            this.actioning = true;\r\n            this.killTweens();\r\n            this.tween = gsap.to(this.gfx.position, {\r\n                duration: this.speed / 3,\r\n                x: this.hasDelay ? -6 : 0,\r\n                y: 4,\r\n                ease: \"linear\",\r\n            });\r\n            gsap.to(this.gfx, {\r\n                duration: this.speed / 3,\r\n                angle: -30,\r\n                ease: \"linear\",\r\n            });\r\n        }\r\n    }\r\n    private startWalk() {\r\n        this.gfx.angle = 0;\r\n        const duration = this.speed / 3;\r\n        this.tween = gsap.to(this.gfx.position, {\r\n            duration,\r\n            x: 0,\r\n            y: -10,\r\n            ease: \"linear\",\r\n            onComplete: () => {\r\n                this.tween = gsap.to(this.gfx.position, {\r\n                    duration,\r\n                    x: 10,\r\n                    y: 0,\r\n                    ease: \"linear\",\r\n                    onComplete: () => {\r\n                        this.tween = gsap.to(this.gfx.position, {\r\n                            duration,\r\n                            x: 0,\r\n                            y: 0,\r\n                            ease: \"linear\",\r\n                            onComplete: () => {\r\n                                this.startWalk();\r\n                            },\r\n                        });\r\n                    },\r\n                });\r\n            },\r\n        });\r\n    }\r\n    private killTweens() {\r\n        if (this.tween && this.tween.isActive()) {\r\n            this.tween.kill();\r\n        }\r\n    }\r\n}\r\n","export class ControlEvent extends Event {\r\n    public code: string;\r\n    constructor(type: string, code: string) {\r\n        super(type);\r\n        this.code = code;\r\n    }\r\n}\r\n","import { Box, Vec2, Body } from \"planck-js\";\r\nimport { app } from \"../..\";\r\nimport { LevelsExecuter } from \"../systems/game-system\";\r\nimport { PhysicsGroup, pixels2Meter } from \"../systems/physics-system\";\r\nimport { CharacterComponent } from \"./character-component\";\r\nimport { ControlledComponent } from \"./controlled-component\";\r\nimport { HostedComponent } from \"./hosted-component\";\r\nimport { PhysicsComponent } from \"./physics-component\";\r\nimport { SensorComponent } from \"./sensor-component\";\r\nimport { ViewComponent } from \"./view-component\";\r\n\r\nexport class FinishLevelComponent extends SensorComponent {\r\n    private static triggerAmount: number;\r\n    private size: { width: number; height: number };\r\n    constructor(x: number, y: number, width: number, height: number, showGfx = true) {\r\n        super(new ViewComponent(), PhysicsGroup.END, {\r\n            position: new Vec2(pixels2Meter(x), pixels2Meter(y)),\r\n        });\r\n        FinishLevelComponent.triggerAmount = 0;\r\n        this.size = { width, height };\r\n        this.createShape();\r\n        if (showGfx) {\r\n            let a = new PIXI.Graphics();\r\n            a.beginFill(0xffff00, 0.5);\r\n            a.drawRect(-width / 2, -height / 2, width, height);\r\n            a.endFill();\r\n            this.view.addChild(a);\r\n        }\r\n\r\n        this.executor = LevelsExecuter.LEVEL_FINISHED;\r\n    }\r\n    public execute(isBeginContact: boolean, body: Body) {\r\n        let n = 0;\r\n        const comp = body.getUserData() as PhysicsComponent;\r\n        if (comp) {\r\n            const controlled = comp.getEntity().getComponent(ControlledComponent);\r\n            if (controlled) {\r\n                n += 1;\r\n            }\r\n        }\r\n        const hosted = (body.getUserData() as PhysicsComponent).getEntity().getComponent(HostedComponent);\r\n        if (hosted && hosted.hasHost()) {\r\n            n += 1;\r\n        }\r\n        if (isBeginContact) {\r\n            FinishLevelComponent.triggerAmount += n;\r\n        } else {\r\n            FinishLevelComponent.triggerAmount -= n;\r\n        }\r\n        if (!this.triggered && FinishLevelComponent.triggerAmount === app.characters.characters.length) {\r\n            this.triggered = true;\r\n            app.game.execute(this.executor);\r\n        }\r\n    }\r\n    protected onBeginContacted(body: Body) {\r\n        const comp = body.getUserData() as PhysicsComponent;\r\n        if (comp) {\r\n            const controlled = comp.getEntity().getComponent(ControlledComponent);\r\n            if (controlled) {\r\n                app.gui.setOnExit(controlled.id, true);\r\n            }\r\n            const hosted = comp.getEntity().getComponent(HostedComponent);\r\n            if (hosted && hosted.hasHost()) {\r\n                app.gui.setOnExit(2, true);\r\n            }\r\n        }\r\n        super.onBeginContacted(body);\r\n    }\r\n    protected onEndContacted(body: Body) {\r\n        const comp = body.getUserData() as PhysicsComponent;\r\n        if (comp && comp.getEntity()) {\r\n            const controlled = comp.getEntity().getComponent(ControlledComponent);\r\n            if (controlled) {\r\n                app.gui.setOnExit(controlled.id, false);\r\n            }\r\n            const hosted = comp.getEntity().getComponent(HostedComponent);\r\n            if (hosted && hosted.hasHost()) {\r\n                app.gui.setOnExit(2, false);\r\n            }\r\n        }\r\n        super.onEndContacted(body);\r\n    }\r\n    protected createShape() {\r\n        this.body.createFixture(new Box(pixels2Meter(this.size.width / 2), pixels2Meter(this.size.height / 2)), {\r\n            isSensor: true,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: PhysicsGroup.HEROES | PhysicsGroup.GHOST | PhysicsGroup.ENEMIES,\r\n        });\r\n    }\r\n}\r\n","import { Body, Box, Circle, Vec2 } from \"planck-js\";\r\nimport { allCollideExcept, PhysicsGroup, pixels2Meter } from \"../systems/physics-system\";\r\nimport { NinjaView } from \"../views/ninja-view\";\r\nimport { CharacterComponent } from \"./character-component\";\r\nimport { WeaponComponent } from \"./weapon-component\";\r\n\r\nexport class NinjaComponent extends CharacterComponent {\r\n    constructor(x: number, y: number) {\r\n        super(new NinjaView(), PhysicsGroup.HEROES, {\r\n            type: Body.DYNAMIC,\r\n            position: new Vec2(pixels2Meter(x), pixels2Meter(y)),\r\n        });\r\n        this.body.setMassData({ mass: 1, center: Vec2.zero(), I: 1 });\r\n        this.characterSettings = {\r\n            jumpForce: 15,\r\n            speed: 5,\r\n        };\r\n        this.body.setFixedRotation(true);\r\n        this.createShape();\r\n    }\r\n    protected createShape() {\r\n        this.body.createFixture(new Box(pixels2Meter(20 / 2), pixels2Meter(50 / 2)), {\r\n            density: 0.5,\r\n            friction: 1,\r\n            restitution: 0,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: allCollideExcept(this.physicsGroup, PhysicsGroup.END, PhysicsGroup.WATER),\r\n        });\r\n        this.body.createFixture(new Circle(new Vec2(0, pixels2Meter(25)), pixels2Meter(10)), {\r\n            density: 0.35,\r\n            friction: 1,\r\n            restitution: 0,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: allCollideExcept(this.physicsGroup),\r\n        });\r\n        this.body.createFixture(new Circle(new Vec2(0, pixels2Meter(-25)), pixels2Meter(10)), {\r\n            density: 0.25,\r\n            friction: 1,\r\n            restitution: 0,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: allCollideExcept(this.physicsGroup, PhysicsGroup.END, PhysicsGroup.WATER),\r\n        });\r\n    }\r\n    protected doSuperAction() {\r\n        super.doSuperAction();\r\n        const weapon = this.getEntity().getComponent(WeaponComponent);\r\n        if (weapon) {\r\n            weapon.action();\r\n        }\r\n    }\r\n}\r\n","import { Vec2 } from \"planck-js\";\r\nimport { app } from \"../..\";\r\nimport { createEntity } from \"../../entity\";\r\nimport { ExplosionComponent } from \"../components/explosion-component\";\r\nimport { MagicComponent } from \"../components/magic-component\";\r\nimport { NPC } from \"../components/npc-component\";\r\nimport { LevelsExecuter } from \"../systems/game-system\";\r\nimport { delay } from \"../utils/delay\";\r\nimport { ILevel } from \"./ilevel\";\r\n\r\nexport abstract class BaseLevel implements ILevel {\r\n    public init() {\r\n        this.restart();\r\n        delay(1).then(() => {\r\n            app.runners.gameStarted.run();\r\n        });\r\n    }\r\n    public restart() {\r\n        this.createBackground();\r\n        this.createAll();\r\n    }\r\n    public finishLevel() {\r\n        app.game.entities.forEach((entity) => {\r\n            const npc = entity.getComponent(NPC);\r\n            if (npc) {\r\n                npc.pause();\r\n            }\r\n        });\r\n    }\r\n    public createExplosion(pos: Vec2, radius: number, force: number) {\r\n        const explosion = createEntity();\r\n        explosion.addComponent(new ExplosionComponent(pos, radius, force));\r\n        app.game.add(explosion);\r\n    }\r\n    public createMagic(pos: Vec2, vector: Vec2) {\r\n        const magic = createEntity();\r\n        const amount = 10;\r\n        const vx = vector.x;\r\n        const aDelta = 60 / amount;\r\n        let angle = -20 - (aDelta * amount) / 2;\r\n        for (let i = 0; i < amount; i++) {\r\n            const v = vector.clone();\r\n            const r = Math.random() * 0.2 + 0.8;\r\n            v.x = Math.cos(PIXI.DEG_TO_RAD * angle) * vx * r;\r\n            v.y = Math.sin(PIXI.DEG_TO_RAD * angle) * Math.abs(vx) * r;\r\n            magic.addComponent(new MagicComponent(pos, v));\r\n            angle += aDelta;\r\n        }\r\n        app.game.add(magic);\r\n    }\r\n    public abstract destroy();\r\n    public abstract execute(action: LevelsExecuter);\r\n    protected abstract createAll();\r\n    protected abstract createBackground();\r\n}\r\n","import { ViewComponent } from \"../components/view-component\";\r\n\r\nexport class AdditionalGroundView extends ViewComponent {\r\n    constructor() {\r\n        super();\r\n        const texture = PIXI.utils.TextureCache[\"small_platform\"];\r\n        const gfx = PIXI.Sprite.from(texture);\r\n        gfx.anchor.set(1, 0);\r\n        this.addChild(gfx);\r\n        gfx.position.x = -gfx.width;\r\n        const gfx1 = PIXI.Sprite.from(texture);\r\n        gfx1.position.x = gfx.position.x;\r\n        this.addChild(gfx1);\r\n        const gfx2 = PIXI.Sprite.from(texture);\r\n        gfx2.position.x = gfx1.position.x + gfx1.width;\r\n        this.addChild(gfx2);\r\n        const gfx3 = PIXI.Sprite.from(texture);\r\n        gfx3.position.x = gfx2.position.x + gfx2.width;\r\n        this.addChild(gfx3);\r\n\r\n        gfx.position.y = gfx1.position.y = gfx2.position.y = gfx3.position.y = -35;\r\n    }\r\n}\r\n","import { BaseComponent, IComponent } from \"../component\";\r\n\r\nexport class NPC extends BaseComponent {\r\n    constructor() {\r\n        super();\r\n    }\r\n    public pause() {\r\n        const comps = this.getEntity()\r\n            .getAllComponents(BaseComponent)\r\n            .filter((comp) => comp !== this && this.isPausable(comp));\r\n        comps.forEach((c) => {\r\n            (c as NPC).pause();\r\n        });\r\n    }\r\n    private isPausable(comp: IComponent): comp is NPC {\r\n        return (comp as NPC).pause !== undefined;\r\n    }\r\n}\r\n","import { Button } from \"./button\";\r\n\r\nexport class TextedButton extends Button {\r\n    constructor(txt: string) {\r\n        super();\r\n        const text = new PIXI.Text(\r\n            txt,\r\n            new PIXI.TextStyle({\r\n                fontFamily: \"Geometria-Bold\",\r\n                align: \"center\",\r\n                fontSize: 30,\r\n                fontWeight: \"bold\",\r\n                wordWrap: true,\r\n                wordWrapWidth: 100,\r\n            }),\r\n        );\r\n        text.anchor.set(0.5);\r\n        this.addChild(text);\r\n\r\n        this.back.anchor.set(0.5);\r\n        this.back.width = text.width + 40;\r\n        this.back.height = text.height + 30;\r\n    }\r\n}\r\n","import { gsap } from \"gsap\";\r\nexport class CharacterArm {\r\n    protected gfx: PIXI.DisplayObject;\r\n    protected tween: gsap.core.Tween;\r\n    protected walking: boolean;\r\n    protected hasDelay: boolean;\r\n    protected speed: number;\r\n    protected actioning: boolean;\r\n    protected superActioning: boolean;\r\n    protected angles: number[];\r\n    constructor(sprite: PIXI.DisplayObject, speed: number, angles: number[], hasDelay = false) {\r\n        this.speed = speed;\r\n        this.hasDelay = hasDelay;\r\n        this.angles = angles;\r\n        this.gfx = sprite;\r\n        this.idle();\r\n    }\r\n    public idle() {\r\n        if (!this.superActioning) {\r\n            this.killTweens();\r\n            this.walking = false;\r\n            this.actioning = false;\r\n            this.tween = gsap.to(this.gfx, {\r\n                duration: this.speed / 3,\r\n                angle: this.angles[0],\r\n                ease: \"linear\",\r\n            });\r\n        }\r\n    }\r\n    public walk() {\r\n        if (!this.superActioning) {\r\n            this.actioning = false;\r\n            if (!this.walking) {\r\n                this.killTweens();\r\n                this.walking = true;\r\n                if (this.hasDelay) {\r\n                    this.tween = gsap.to(this.gfx, {\r\n                        angle: this.angles[1],\r\n                        duration: this.speed / 2,\r\n                        onComplete: () => {\r\n                            this.startWalk();\r\n                        },\r\n                    });\r\n                } else {\r\n                    this.startWalk();\r\n                }\r\n            }\r\n        }\r\n    }\r\n    public action() {\r\n        this.walking = false;\r\n        if (!this.actioning) {\r\n            this.actioning = true;\r\n            this.killTweens();\r\n            this.gfx.angle = this.angles[0];\r\n        }\r\n    }\r\n    protected killTweens() {\r\n        if (this.tween && this.tween.isActive()) {\r\n            this.tween.kill();\r\n        }\r\n    }\r\n    private startWalk() {\r\n        this.gfx.angle = this.angles[0];\r\n        const duration = this.speed / 2;\r\n        this.tween = gsap.to(this.gfx, {\r\n            duration,\r\n            angle: this.angles[1],\r\n            ease: \"linear\",\r\n            onComplete: () => {\r\n                this.tween = gsap.to(this.gfx, {\r\n                    duration,\r\n                    angle: this.angles[0],\r\n                    ease: \"linear\",\r\n                    onComplete: () => {\r\n                        this.startWalk();\r\n                    },\r\n                });\r\n            },\r\n        });\r\n    }\r\n}\r\n","import { Body, Circle, Vec2 } from \"planck-js\";\r\nimport { app } from \"../..\";\r\nimport { allCollideExcept, PhysicsGroup, pixels2Meter } from \"../systems/physics-system\";\r\nimport { WitcherView } from \"../views/witcher-view\";\r\nimport { CharacterComponent } from \"./character-component\";\r\n\r\nexport class WitcherComponent extends CharacterComponent {\r\n    private magicVec: Vec2 = Vec2.zero();\r\n    constructor(x: number, y: number) {\r\n        super(new WitcherView(), PhysicsGroup.HEROES, {\r\n            type: Body.DYNAMIC,\r\n            position: new Vec2(pixels2Meter(x), pixels2Meter(y)),\r\n        });\r\n        this.body.setMassData({ mass: 1, center: Vec2.zero(), I: 1 });\r\n        this.characterSettings = {\r\n            jumpForce: 15,\r\n            speed: 4,\r\n        };\r\n        this.body.setFixedRotation(true);\r\n        this.createShape();\r\n    }\r\n    protected createShape() {\r\n        this.body.createFixture(new Circle(Vec2.zero(), pixels2Meter(30)), {\r\n            density: 0.5,\r\n            friction: 1,\r\n            restitution: 0,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: allCollideExcept(this.physicsGroup),\r\n        });\r\n    }\r\n    protected doSuperAction() {\r\n        super.doSuperAction();\r\n        this.magicVec.set(20 * this.view.scale.x, 0);\r\n        app.game.level.createMagic(this.body.getPosition(), this.magicVec);\r\n    }\r\n}\r\n","import { ViewComponent } from \"../components/view-component\";\r\n\r\nexport class PlatformView extends ViewComponent {\r\n    constructor() {\r\n        super();\r\n        const gfx = PIXI.Sprite.from(PIXI.utils.TextureCache[\"platform\"]);\r\n        gfx.anchor.set(0.5);\r\n        this.addChild(gfx);\r\n    }\r\n}\r\n","export class Button extends PIXI.Container {\r\n    protected back: PIXI.Sprite;\r\n    protected _id: number;\r\n    constructor() {\r\n        super();\r\n        this.createBack();\r\n        this.interactive = true;\r\n        this.on(\"pointerdown\", () => {\r\n            this.emit(\"buttonPressed\", this._id);\r\n        });\r\n        this.on(\"pointerup\", () => {\r\n            this.emit(\"buttonReleased\", this._id);\r\n        });\r\n        this.on(\"pointerupoutside\", () => {\r\n            this.emit(\"buttonReleased\", this._id);\r\n        });\r\n    }\r\n    public set id(i: number) {\r\n        this._id = i;\r\n    }\r\n    public get id(): number {\r\n        return this._id;\r\n    }\r\n    public set enable(e: boolean) {\r\n        this.setEnable(e);\r\n    }\r\n    public get enable(): boolean {\r\n        return this.interactive;\r\n    }\r\n    protected createBack() {\r\n        this.back = PIXI.Sprite.from(PIXI.utils.TextureCache[\"button\"]);\r\n        this.addChild(this.back);\r\n    }\r\n    protected setEnable(e: boolean) {\r\n        this.back.tint = e ? 0xffffff : 0xff0000;\r\n        this.interactive = e;\r\n    }\r\n}\r\n","import { Body, Box, Vec2 } from \"planck-js\";\r\nimport { allCollideExcept, PhysicsGroup, pixels2Meter } from \"../../systems/physics-system\";\r\nimport { Deferred } from \"../../utils/deferred\";\r\nimport { delay } from \"../../utils/delay\";\r\nimport { GroundWaterView } from \"../../views/ground-water-view\";\r\nimport { PhysicsComponent } from \"../physics-component\";\r\nimport { ViewComponent } from \"../view-component\";\r\n\r\nexport class WaterPart extends PhysicsComponent {\r\n    public moveForce: Vec2;\r\n    private heroes: Set<Body>;\r\n    private _enabled: boolean;\r\n    private intId: Deferred;\r\n    private startDelay: number;\r\n    private endDelay: number;\r\n    constructor(\r\n        x: number,\r\n        y: number,\r\n        width: number,\r\n        height: number,\r\n        force: Vec2,\r\n        startDelay: number,\r\n        view?: ViewComponent,\r\n        endDelay: number = 2000,\r\n    ) {\r\n        super(view || new ViewComponent(), PhysicsGroup.WATER, {\r\n            position: new Vec2(pixels2Meter(x), pixels2Meter(y)),\r\n        });\r\n        this.heroes = new Set<Body>();\r\n        this.startDelay = startDelay;\r\n        this.endDelay = endDelay;\r\n        this.moveForce = force;\r\n        this.body.createFixture(new Box(pixels2Meter(width / 2), pixels2Meter(height / 2)), {\r\n            isSensor: true,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: allCollideExcept(this.physicsGroup),\r\n        });\r\n        if (!view) {\r\n            let a = new PIXI.Graphics();\r\n            a.beginFill(0xff00ff, 0.5);\r\n            a.drawRect(-width / 2, -height / 2, width, height);\r\n            a.endFill();\r\n            this.view.addChild(a);\r\n        }\r\n\r\n        this.enabled = false;\r\n    }\r\n    public stop() {\r\n        if (this.intId) {\r\n            this.intId.reject();\r\n        }\r\n        this.enabled = false;\r\n    }\r\n    public set enabled(e: boolean) {\r\n        if (e) {\r\n            delay(this.startDelay).then(() => {\r\n                this.doEnable(e);\r\n            });\r\n        } else {\r\n            this.doEnable(e);\r\n        }\r\n    }\r\n    private doEnable(e: boolean) {\r\n        this._enabled = e;\r\n        //this.view.alpha = e ? 1 : 0;\r\n\r\n        if (e) {\r\n            if (this.endDelay > -1) {\r\n                this.intId = delay(this.endDelay);\r\n                this.intId.then(() => (this.enabled = false));\r\n            }\r\n\r\n            for (let ce = this.body.getContactList(); ce != null; ce = ce.next) {\r\n                if (ce.contact.isTouching()) {\r\n                    const found = PhysicsComponent.getAnotherBody(ce.contact, this.body);\r\n                    if (found) {\r\n                        this.heroes.add(found);\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        } else {\r\n            this.heroes.clear();\r\n        }\r\n    }\r\n    public loop() {\r\n        if (this.heroes) {\r\n            this.heroes.forEach((body) => {\r\n                body.m_linearVelocity.x += this.moveForce.x;\r\n                body.m_linearVelocity.y += this.moveForce.y;\r\n            });\r\n        }\r\n        super.loop();\r\n    }\r\n    protected onBeginContacted(body: Body) {\r\n        if (!this._enabled) return;\r\n        this.heroes.add(body);\r\n    }\r\n    protected onEndContacted(body: Body) {\r\n        if (!this._enabled) return;\r\n        this.heroes.delete(body);\r\n    }\r\n}\r\n","import { Button } from \"./button\";\r\n\r\nexport class ControlButton extends Button {\r\n    constructor() {\r\n        super();\r\n    }\r\n    public set icon(i: PIXI.DisplayObject) {\r\n        this.addChild(i);\r\n    }\r\n    protected setEnable(e: boolean) {\r\n        this.back.tint = e ? 0xffffff : 0xff0000;\r\n        this.interactive = e;\r\n    }\r\n}\r\n","import { Howl } from \"howler\";\r\nexport class SoundSystem {\r\n    private static assetsPath: string;\r\n    constructor() {}\r\n    public static set path(p: string) {\r\n        SoundSystem.assetsPath = p;\r\n    }\r\n    public add(name: string, settings?: { autoplay: boolean; loop: boolean; volume: number }) {\r\n        if (!SoundSystem.assetsPath) {\r\n            throw new Error(\"setup path for sounds\");\r\n        }\r\n        const src: string[] = [\"mp3\", \"ogg\"].map((value) => {\r\n            return `${SoundSystem.assetsPath}/${name}.${value}`;\r\n        });\r\n        new Howl({\r\n            src,\r\n            autoplay: settings?.autoplay,\r\n            loop: settings?.loop,\r\n            volume: settings?.volume || 1,\r\n        });\r\n    }\r\n}\r\n","import { app } from \"../..\";\r\nimport { ViewComponent } from \"../components/view-component\";\r\nimport { delay } from \"../utils/delay\";\r\nimport { CharacterArm } from \"./character-arm-view\";\r\nimport { CharacterLeg } from \"./character-leg-view\";\r\nimport { ICharacterView } from \"./icharacter-view\";\r\n\r\nexport class EnemyView extends ViewComponent implements ICharacterView {\r\n    private leg1: CharacterLeg;\r\n    private leg2: CharacterLeg;\r\n    private walking: boolean;\r\n    private actioning: boolean;\r\n    private intervalId: number;\r\n    private hand: CharacterArm;\r\n    constructor() {\r\n        super();\r\n        const textures = [\r\n            PIXI.utils.TextureCache[\"enemy_body0\"],\r\n            PIXI.utils.TextureCache[\"enemy_body1\"],\r\n            PIXI.utils.TextureCache[\"enemy_body2\"],\r\n            PIXI.utils.TextureCache[\"enemy_body1\"],\r\n            PIXI.utils.TextureCache[\"enemy_body0\"],\r\n        ];\r\n        const body = PIXI.Sprite.from(textures[0]);\r\n        body.scale.set(0.7);\r\n        body.anchor.set(0.4, 0.5);\r\n        body.position.set(0, -20);\r\n        this.addChild(body);\r\n\r\n        const arm = PIXI.Sprite.from(PIXI.utils.TextureCache[\"enemy_hand\"]);\r\n        this.hand = new CharacterArm(arm, 0.5, [-20, -50]);\r\n        arm.scale.x = -1;\r\n        arm.anchor.set(0, 0.1);\r\n        arm.angle = -20;\r\n        arm.position.set(-20, -15);\r\n        this.addChild(arm);\r\n\r\n        this.leg1 = new CharacterLeg(\"enemy_leg\", 0.5);\r\n        this.addChild(this.leg1);\r\n\r\n        this.leg2 = new CharacterLeg(\"enemy_leg\", 0.5, true);\r\n        this.addChild(this.leg2);\r\n\r\n        this.leg1.position.set(-10, 20);\r\n        this.leg1.scale.set(0.7);\r\n        this.leg2.scale.set(0.7);\r\n        this.leg2.position.set(10, 20);\r\n        this.idle();\r\n        this.intervalId = window.setInterval(async () => {\r\n            for (let i = 0; i < textures.length; i++) {\r\n                body.texture = textures[i];\r\n                await delay(50);\r\n            }\r\n        }, 4000);\r\n    }\r\n    public walk() {\r\n        if (!this.walking) {\r\n            this.walking = true;\r\n            this.leg1.walk();\r\n            this.leg2.walk();\r\n            this.hand.walk();\r\n        }\r\n    }\r\n    public idle() {\r\n        if (this.walking || this.actioning) {\r\n            this.walking = false;\r\n            this.actioning = false;\r\n            this.leg1.idle();\r\n            this.leg2.idle();\r\n            this.hand.idle();\r\n        }\r\n    }\r\n    public action() {\r\n        if (!this.actioning) {\r\n            this.walking = false;\r\n            this.actioning = true;\r\n            this.leg1.action();\r\n            this.leg2.action();\r\n            this.hand.action();\r\n        }\r\n    }\r\n    public superAction() {\r\n        //\r\n    }\r\n    public destroy() {\r\n        window.clearInterval(this.intervalId);\r\n        super.destroy();\r\n    }\r\n}\r\n","import { Box, Vec2 } from \"planck-js\";\r\nimport { allCollideExcept, PhysicsGroup, pixels2Meter } from \"../../systems/physics-system\";\r\nimport { delay } from \"../../utils/delay\";\r\nimport { DamageComponent } from \"../damage-component\";\r\nimport { PhysicsComponent } from \"../physics-component\";\r\nimport { SensorComponent } from \"../sensor-component\";\r\nimport { ViewComponent } from \"../view-component\";\r\nimport { Fire } from \"./fire\";\r\n\r\nexport class Gas extends SensorComponent {\r\n    private fireComponent: Fire;\r\n    constructor(fireComponent: Fire) {\r\n        super(new ViewComponent(), PhysicsGroup.GAS, {\r\n            position: new Vec2(pixels2Meter(1090), pixels2Meter(655)),\r\n        });\r\n        this.fireComponent = fireComponent;\r\n        this.createShape();\r\n        this.createView();\r\n    }\r\n    public async startFire() {\r\n        this.fireComponent.start();\r\n        await delay(1000);\r\n        this.fireComponent.stop();\r\n    }\r\n    protected createShape() {\r\n        this.body.createFixture(new Box(pixels2Meter(280 / 2), pixels2Meter(10 / 2)), {\r\n            friction: 0.05,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: allCollideExcept(this.physicsGroup),\r\n        });\r\n    }\r\n    protected createView() {\r\n        const gfx2 = PIXI.Sprite.from(PIXI.utils.TextureCache[\"kanistra\"]);\r\n        //gfx2.alpha = 0.5;\r\n        gfx2.anchor.set(0.5);\r\n        gfx2.position.set(80, -23);\r\n        this.view.addChild(gfx2);\r\n        const gfx = PIXI.Sprite.from(PIXI.utils.TextureCache[\"gas\"]);\r\n        gfx.alpha = 0.5;\r\n        gfx.anchor.set(0.5);\r\n        gfx.position.set(4, 0);\r\n        this.view.addChild(gfx);\r\n    }\r\n}\r\n","import { Body, Circle, Vec2 } from \"planck-js\";\r\nimport { app } from \"../..\";\r\nimport { PhysicsGroup, pixels2Meter } from \"../systems/physics-system\";\r\nimport { GhostView } from \"../views/ghost-view\";\r\nimport { CharacterComponent } from \"./character-component\";\r\nimport { HostedComponent } from \"./hosted-component\";\r\nimport { PhysicsComponent } from \"./physics-component\";\r\n\r\nexport class GhostComponent extends CharacterComponent {\r\n    public isGhost: boolean = true;\r\n    private hostComponent: HostedComponent;\r\n    private doingAction: boolean;\r\n    constructor(x: number, y: number) {\r\n        super(new GhostView(), PhysicsGroup.GHOST, {\r\n            type: Body.DYNAMIC,\r\n            position: new Vec2(pixels2Meter(x), pixels2Meter(y)),\r\n        });\r\n        this.doingAction = false;\r\n        this.body.setMassData({ mass: 0, center: Vec2.zero(), I: 1 });\r\n        this.characterSettings = {\r\n            jumpForce: 0,\r\n            speed: 5,\r\n        };\r\n        this.body.setFixedRotation(true);\r\n        this.createShape();\r\n        this.body.setGravityScale(0);\r\n        app.hosts.host = this;\r\n    }\r\n    public loop() {\r\n        super.loop();\r\n        const pos = this.body.getPosition();\r\n        if (!this.doingAction) {\r\n            const endY = pixels2Meter(620);\r\n            if (pos.y < endY) {\r\n                this.body.m_linearVelocity.y = 4;\r\n            } else if (pos.y > endY) {\r\n                this.body.setLinearVelocity(Vec2.zero());\r\n                app.physics.moveBody(this.body, new Vec2(pos.x, endY));\r\n            }\r\n        }\r\n    }\r\n    public stopAction() {\r\n        this.doingAction = false;\r\n        this.body.m_linearVelocity.y = 0;\r\n    }\r\n    public releaseHost() {\r\n        super.releaseHost();\r\n        if (this.hostComponent && this.view) {\r\n            const obj = this.hostComponent.getEntity().getComponent(PhysicsComponent);\r\n            this.body.setPosition(new Vec2(obj.body.getPosition().x, pixels2Meter(620)));\r\n            this.hostComponent.releaseHost();\r\n            this.hostComponent = undefined;\r\n            this.view.visible = true;\r\n            this.loop();\r\n        }\r\n    }\r\n    protected createShape() {\r\n        this.body.createFixture(new Circle(Vec2.zero(), pixels2Meter(25)), {\r\n            density: 0,\r\n            isSensor: true,\r\n            filterCategoryBits: PhysicsGroup.GHOST,\r\n            filterMaskBits: PhysicsGroup.END | PhysicsGroup.ENEMIES | PhysicsGroup.HEROES,\r\n        });\r\n    }\r\n    protected doAction() {\r\n        const pos = this.body.getPosition();\r\n        if (pos.y < 0) {\r\n            this.body.setLinearVelocity(Vec2.zero());\r\n            app.physics.moveBody(this.body, new Vec2(pos.x, 0));\r\n            return;\r\n        }\r\n        this.doingAction = true;\r\n        if (!this.hostComponent) {\r\n            this.body.m_linearVelocity.y = -this.characterSettings.speed;\r\n        } else {\r\n            this.hostComponent.character.action();\r\n        }\r\n    }\r\n    protected doMove(delta: number) {\r\n        const pos = this.body.getPosition();\r\n        if (pos.x < 0) {\r\n            this.body.setLinearVelocity(Vec2.zero());\r\n            app.physics.moveBody(this.body, new Vec2(0, pos.y));\r\n            return;\r\n        } else if (pos.x > pixels2Meter(1280)) {\r\n            this.body.setLinearVelocity(Vec2.zero());\r\n            app.physics.moveBody(this.body, new Vec2(pixels2Meter(1280), pos.y));\r\n            return;\r\n        }\r\n        if (!this.hostComponent) {\r\n            super.doMove(delta);\r\n            this.body.m_linearVelocity.x = this.characterSettings.speed * delta;\r\n        } else {\r\n            this.hostComponent.character.move(delta);\r\n        }\r\n    }\r\n    // for ghost it's checking inside doAction\r\n    protected canAction() {\r\n        return true;\r\n    }\r\n    protected doSuperAction() {\r\n        super.doSuperAction();\r\n        if (!this.hostComponent) {\r\n            //find a character to move into it\r\n            const host = app.hosts.getHostedByOverlap(this.body);\r\n            if (host) {\r\n                this.becomeImplanted(host);\r\n            }\r\n        } else {\r\n            this.releaseHost();\r\n        }\r\n    }\r\n    private becomeImplanted(host: HostedComponent) {\r\n        this.hostComponent = host;\r\n        host.putHost();\r\n        this.body.setLinearVelocity(Vec2.zero());\r\n        this.view.visible = false;\r\n    }\r\n}\r\n","import { gsap } from \"gsap\";\r\nimport { ViewComponent } from \"../components/view-component\";\r\nimport { ICharacterView } from \"./icharacter-view\";\r\n\r\nexport class GhostView extends ViewComponent implements ICharacterView {\r\n    private tween: gsap.core.Tween;\r\n    private intervalId: number;\r\n    constructor() {\r\n        super();\r\n        const body = PIXI.Sprite.from(PIXI.utils.TextureCache[\"ghost_base\"]);\r\n        body.alpha = 0.7;\r\n        body.anchor.set(0.4, 0.7);\r\n        this.addChild(body);\r\n\r\n        const eye1 = PIXI.Sprite.from(PIXI.utils.TextureCache[\"ghost_eye1\"]);\r\n        eye1.anchor.set(0.5, 0.5);\r\n        body.addChild(eye1);\r\n        const eye2 = PIXI.Sprite.from(PIXI.utils.TextureCache[\"ghost_eye2\"]);\r\n        eye2.anchor.set(0.5, 0.5);\r\n        body.addChild(eye2);\r\n\r\n        eye1.position.set(6, -23);\r\n        eye2.position.set(25, -25);\r\n\r\n        this.tween = gsap.to(body.position, {\r\n            duration: 3,\r\n            repeat: -1,\r\n            y: -10,\r\n            yoyo: true,\r\n            ease: \"linear\",\r\n            yoyoEase: \"linear\",\r\n        });\r\n\r\n        this.intervalId = window.setInterval(async () => {\r\n            eye1.scale.y = 1;\r\n            eye2.scale.y = 1;\r\n            gsap.to(eye1.scale, {\r\n                duration: 0.1,\r\n                y: 0,\r\n                repeat: 1,\r\n                yoyo: true,\r\n                ease: \"linear\",\r\n                yoyoEase: \"linear\",\r\n            });\r\n            gsap.to(eye2.scale, {\r\n                delay: 0.05,\r\n                duration: 0.1,\r\n                y: 0,\r\n                repeat: 1,\r\n                yoyo: true,\r\n                ease: \"linear\",\r\n                yoyoEase: \"linear\",\r\n            });\r\n        }, 6000);\r\n    }\r\n    public walk() {\r\n        //\r\n    }\r\n    public idle() {\r\n        //\r\n    }\r\n    public action() {\r\n        //\r\n    }\r\n    public superAction() {\r\n        //\r\n    }\r\n    public stop() {\r\n        window.clearInterval(this.intervalId);\r\n        this.tween.kill();\r\n        this.tween = undefined;\r\n    }\r\n    public destroy() {\r\n        this.stop();\r\n        super.destroy();\r\n    }\r\n}\r\n","import { Contact, Vec2 } from \"planck-js\";\r\nimport { app } from \"../../..\";\r\nimport { PhysicsGroup, pixels2Meter } from \"../../systems/physics-system\";\r\nimport { BalconyView } from \"../../views/balcony-view\";\r\nimport { PhysicsComponent } from \"../physics-component\";\r\nimport { Ashtray } from \"./ashtray\";\r\nimport { Gas } from \"./gas\";\r\nimport { Cigerette } from \"./cigarette\";\r\nimport { TNT } from \"./TNT\";\r\nimport { Wall } from \"./wall\";\r\n\r\nexport class Balcony extends PhysicsComponent {\r\n    private ash: Ashtray;\r\n    private cigarette: Cigerette;\r\n    private gas: Gas;\r\n    private tnt: TNT;\r\n    private wall: Wall;\r\n    private shouldPlaceAsh: boolean;\r\n    constructor(ash: Ashtray, cigarette: Cigerette, gas: Gas, tnt: TNT, wall: Wall) {\r\n        super(new BalconyView(), PhysicsGroup.DEFAULT, {\r\n            position: new Vec2(pixels2Meter(800), pixels2Meter(380)),\r\n        });\r\n        this.shouldPlaceAsh = false;\r\n        this.ash = ash;\r\n        this.cigarette = cigarette;\r\n        this.gas = gas;\r\n        this.tnt = tnt;\r\n        this.wall = wall;\r\n        this.view.on(\"smokeFinished\", () => {\r\n            this.onSmokeDone();\r\n        });\r\n        this.view.on(\"smokeCheckAsh\", () => {\r\n            this.onSmokeCheckAsh();\r\n        });\r\n    }\r\n    public pause() {\r\n        (this.view as BalconyView).pause();\r\n    }\r\n    public endContact(evt: Contact) {\r\n        if (this.tnt.onGas && PhysicsComponent.isContacted(evt, this.tnt.body, this.gas.body)) {\r\n            this.tnt.onGas = false;\r\n        }\r\n    }\r\n    public beginContact(evt: Contact) {\r\n        if (!this.tnt.onGas && PhysicsComponent.isContacted(evt, this.tnt.body, this.gas.body)) {\r\n            this.tnt.onGas = true;\r\n        }\r\n        if (PhysicsComponent.isContacted(evt, this.cigarette.body, this.gas.body)) {\r\n            this.cigarette.goAway();\r\n            this.gas.startFire();\r\n            if (this.tnt.onGas) {\r\n                this.tnt.explode();\r\n                this.shouldPlaceAsh = true;\r\n                const shouldWallExplode =\r\n                    this.wall && Math.abs(this.wall.body.getPosition().x - this.tnt.body.getPosition().x) <= 5.5;\r\n                if (shouldWallExplode) {\r\n                    this.wall.explode();\r\n                    this.wall = null;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    public goAway() {\r\n        (this.view as BalconyView).goAway();\r\n    }\r\n    public startSmoker() {\r\n        (this.view as BalconyView).startSmoker();\r\n    }\r\n    private onSmokeDone() {\r\n        this.cigarette.drop();\r\n    }\r\n    private onSmokeCheckAsh() {\r\n        if (this.shouldPlaceAsh) {\r\n            this.shouldPlaceAsh = false;\r\n            this.ash.putBack();\r\n        }\r\n    }\r\n}\r\n","import { app } from \"../..\";\r\nimport { ViewComponent } from \"../components/view-component\";\r\nimport { delay } from \"../utils/delay\";\r\nimport { CharacterLeg } from \"./character-leg-view\";\r\nimport { ICharacterView } from \"./icharacter-view\";\r\nimport { NinjaArmView } from \"./ninja-arm-view\";\r\nimport { gsap } from \"gsap\";\r\nimport { CharacterArm } from \"./character-arm-view\";\r\n\r\nexport class NinjaView extends ViewComponent implements ICharacterView {\r\n    private leg1: CharacterLeg;\r\n    private leg2: CharacterLeg;\r\n    private walking: boolean;\r\n    private actioning: boolean;\r\n    private intervalId: number;\r\n    private arm: NinjaArmView;\r\n    private arm0: CharacterArm;\r\n    tween: gsap.core.Tween;\r\n    constructor() {\r\n        super();\r\n        const blinkTexture = PIXI.utils.TextureCache[\"ninja_blink\"];\r\n        const normalTexture = PIXI.utils.TextureCache[\"ninja_body\"];\r\n        const body = PIXI.Sprite.from(normalTexture);\r\n        body.scale.set(0.8);\r\n        body.anchor.set(0.5);\r\n        body.position.set(-2, -7);\r\n\r\n        const arm2 = PIXI.Sprite.from(PIXI.utils.TextureCache[\"ninja_hand2\"]);\r\n        arm2.position.set(3, -7);\r\n        this.addChild(arm2);\r\n        this.addChild(body);\r\n\r\n        this.arm0 = new CharacterArm(arm2, 0.3, [0, -10]);\r\n\r\n        const stick = PIXI.Sprite.from(PIXI.utils.TextureCache[\"stick\"]);\r\n        stick.scale.set(0.8);\r\n        stick.angle = -10;\r\n        stick.position.set(0, -48);\r\n\r\n        const gfx = PIXI.Sprite.from(PIXI.utils.TextureCache[\"ninja_hand1\"]);\r\n        gfx.position.set(-3, 0);\r\n        gfx.angle = 10;\r\n\r\n        const armPos = new PIXI.Point(-17, -5);\r\n        const armContainer = new PIXI.Container();\r\n        armContainer.position = armPos;\r\n        armContainer.addChild(stick);\r\n        armContainer.addChild(gfx);\r\n        this.addChild(armContainer);\r\n\r\n        this.arm = new NinjaArmView(armContainer, 0.3, [10, 20], armPos);\r\n\r\n        this.leg1 = new CharacterLeg(\"ninja_leg\", 0.3);\r\n        this.addChild(this.leg1);\r\n\r\n        this.leg2 = new CharacterLeg(\"ninja_leg\", 0.3, true);\r\n        this.addChild(this.leg2);\r\n\r\n        this.leg1.position.set(-8, 33);\r\n        this.leg2.position.set(8, 33);\r\n        this.idle();\r\n\r\n        this.intervalId = window.setInterval(async () => {\r\n            body.texture = blinkTexture;\r\n            await delay(100);\r\n            body.texture = normalTexture;\r\n        }, 3000);\r\n    }\r\n    public walk() {\r\n        if (!this.walking) {\r\n            this.walking = true;\r\n            this.leg1.walk();\r\n            this.leg2.walk();\r\n            this.arm.walk();\r\n            this.arm0.walk();\r\n        }\r\n    }\r\n    public idle() {\r\n        if (this.walking || this.actioning) {\r\n            this.walking = false;\r\n            this.actioning = false;\r\n            this.leg1.idle();\r\n            this.leg2.idle();\r\n            this.arm.idle();\r\n            this.arm0.idle();\r\n        }\r\n    }\r\n    public action() {\r\n        if (!this.actioning) {\r\n            this.walking = false;\r\n            this.actioning = true;\r\n            this.leg1.action();\r\n            this.leg2.action();\r\n            this.arm0.action();\r\n            this.arm.action();\r\n        }\r\n    }\r\n    public superAction() {\r\n        this.arm.superAction();\r\n    }\r\n    public stop() {\r\n        window.clearInterval(this.intervalId);\r\n    }\r\n    public destroy() {\r\n        this.stop();\r\n        super.destroy();\r\n    }\r\n}\r\n","import { ViewComponent } from \"../components/view-component\";\r\nimport { delay } from \"../utils/delay\";\r\nimport { CharacterLeg } from \"./character-leg-view\";\r\nimport { ICharacterView } from \"./icharacter-view\";\r\n\r\nexport class WitcherView extends ViewComponent implements ICharacterView {\r\n    private leg1: CharacterLeg;\r\n    private leg2: CharacterLeg;\r\n    private walking: boolean;\r\n    private intervalId: number;\r\n    constructor() {\r\n        super();\r\n        const blinkTexture = PIXI.utils.TextureCache[\"witcher_blink\"];\r\n        const normalTexture = PIXI.utils.TextureCache[\"witcher\"];\r\n        const body = PIXI.Sprite.from(normalTexture);\r\n        body.scale.set(1);\r\n        body.anchor.set(0.5);\r\n        body.position.set(0, -7);\r\n\r\n        const hat = PIXI.Sprite.from(PIXI.utils.TextureCache[\"witcher_hat\"]);\r\n        hat.anchor.set(0.5);\r\n        hat.position.set(-12, -41);\r\n        this.addChild(hat);\r\n        this.addChild(body);\r\n\r\n        this.leg1 = new CharacterLeg(\"witcher_leg\", 0.5);\r\n        this.addChild(this.leg1);\r\n\r\n        this.leg2 = new CharacterLeg(\"witcher_leg\", 0.5, true);\r\n        this.addChild(this.leg2);\r\n\r\n        this.leg1.position.set(-10, 28);\r\n        this.leg2.position.set(10, 28);\r\n        this.idle();\r\n\r\n        this.intervalId = window.setInterval(async () => {\r\n            body.texture = blinkTexture;\r\n            await delay(100);\r\n            body.texture = normalTexture;\r\n        }, 5000);\r\n    }\r\n    public walk() {\r\n        if (!this.walking) {\r\n            this.walking = true;\r\n            this.leg1.walk();\r\n            this.leg2.walk();\r\n        }\r\n    }\r\n    public idle() {\r\n        this.walking = false;\r\n        this.leg1.idle();\r\n        this.leg2.idle();\r\n    }\r\n    public action() {\r\n        this.walking = false;\r\n        this.leg1.action();\r\n        this.leg2.action();\r\n    }\r\n    public superAction() {\r\n        //\r\n    }\r\n    public stop() {\r\n        window.clearInterval(this.intervalId);\r\n    }\r\n    public destroy() {\r\n        this.stop();\r\n        super.destroy();\r\n    }\r\n}\r\n","import { Body, Box, Vec2 } from \"planck-js\";\r\nimport { allCollideExcept, PhysicsGroup, pixels2Meter } from \"../../systems/physics-system\";\r\nimport { PhysicsComponent } from \"../physics-component\";\r\nimport { ViewComponent } from \"../view-component\";\r\n\r\nexport class WoodenBox extends PhysicsComponent {\r\n    constructor() {\r\n        super(new ViewComponent(), PhysicsGroup.BOMB, {\r\n            type: Body.DYNAMIC,\r\n            position: new Vec2(pixels2Meter(600), pixels2Meter(480)),\r\n        });\r\n        this.body.setMassData({ mass: 1, center: Vec2.zero(), I: 1 });\r\n        this.body.createFixture(new Box(pixels2Meter(40 / 2), pixels2Meter(40 / 2)), {\r\n            density: 20,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: allCollideExcept(this.physicsGroup),\r\n        });\r\n\r\n        const gfx = PIXI.Sprite.from(PIXI.utils.TextureCache[\"box\"]);\r\n        gfx.scale.set(0.8);\r\n        gfx.anchor.set(0.5);\r\n        this.view.addChild(gfx);\r\n    }\r\n}\r\n","import { Loader } from \"pixi.js\";\r\nimport { app } from \"../..\";\r\nimport * as WebFont from \"webfontloader\";\r\nimport { SoundSystem } from \"./sound-system\";\r\n\r\nexport class AssetsLoaderSystem {\r\n    public init() {\r\n        const loadOptions = { crossOrigin: true };\r\n        const loader = app.loader;\r\n        loader.baseUrl = \"assets/\";\r\n        SoundSystem.path = \"assets/sounds\";\r\n        loader.add(\"atlas\", \"atlas.json\", loadOptions);\r\n        loader.add(\"background\", \"background.png\", loadOptions);\r\n\r\n        loader.load(() => {\r\n            WebFont.load({\r\n                custom: {\r\n                    families: [\"Geometria\", \"Geometria-Bold\"],\r\n                    urls: [\"assets/fonts/font.css\", \"assets/fonts/font.css\"],\r\n                },\r\n                active: () => {\r\n                    app.runners.load.run();\r\n                },\r\n            });\r\n        });\r\n        app.sounds.add(\"music\", { autoplay: true, loop: true, volume: 1 });\r\n    }\r\n}\r\n","import { Vec2 } from \"planck-js\";\r\nimport { Entity } from \"../../entity\";\r\nimport { CharacterComponent } from \"../components/character-component\";\r\n\r\nexport class CharactersSystem {\r\n    public characters: CharacterComponent[];\r\n    constructor() {\r\n        this.characters = [];\r\n    }\r\n    public gameStarted() {\r\n        if (this.characters.length > 0) {\r\n            this.characters[0].enabled = true;\r\n        }\r\n    }\r\n    public characterSwitched(id: number) {\r\n        this.characters.forEach((c) => {\r\n            c.enabled = false;\r\n        });\r\n        try {\r\n            this.characters[id].enabled = true;\r\n        } catch (e) {\r\n            console.error(`no character ${id}`);\r\n        }\r\n    }\r\n    public disableCharacters() {\r\n        this.characters.forEach((c) => {\r\n            c.enabled = false;\r\n            c.body.setLinearVelocity(Vec2.zero());\r\n        });\r\n    }\r\n    public entityAdded(entity: Entity) {\r\n        const comp = entity.getComponent(CharacterComponent);\r\n        if (comp) {\r\n            this.characters.push(comp);\r\n        }\r\n    }\r\n    public entityRemoved(entity: Entity) {\r\n        const comp = entity.getComponent(CharacterComponent);\r\n        if (comp) {\r\n            const ind = this.characters.indexOf(comp);\r\n            if (ind >= 0) {\r\n                this.characters.splice(ind, 1);\r\n            }\r\n        }\r\n    }\r\n}\r\n","import { app } from \"../..\";\r\n\r\nexport class CoinsSystem {\r\n    private _levelsCoins: number;\r\n    private _totalCoins: number;\r\n\r\n    public gameStarted() {\r\n        this._levelsCoins = 0;\r\n        this._totalCoins = 0;\r\n        app.gui.updateCoins(this._levelsCoins);\r\n    }\r\n    public newLevel() {\r\n        this._levelsCoins = 0;\r\n    }\r\n    public get levelsCoins(): number {\r\n        return this._levelsCoins;\r\n    }\r\n    public getCoin() {\r\n        this._levelsCoins++;\r\n        this._totalCoins++;\r\n        app.gui.updateCoins(this._levelsCoins);\r\n    }\r\n}\r\n","import { Entity } from \"../../entity\";\r\nimport { Action, ControlledComponent } from \"../components/controlled-component\";\r\n\r\nexport class ControlledSystem {\r\n    private components: ControlledComponent[];\r\n    private onKeyDown: (e: any) => void;\r\n    private onKeyUp: (e: any) => void;\r\n    private superActionStarted: boolean;\r\n    constructor() {\r\n        this.components = [];\r\n    }\r\n    public init() {\r\n        this.onKeyDown = (e) => {\r\n            this.onKeyPressed(e.code);\r\n        };\r\n        this.onKeyUp = (e) => {\r\n            this.onKeyReleased(e.code);\r\n        };\r\n        if (!PIXI.utils.isMobile.any) {\r\n            document.addEventListener(\"keydown\", this.onKeyDown);\r\n            document.addEventListener(\"keyup\", this.onKeyUp);\r\n        } else {\r\n            window.addEventListener(\"mobilekeydown\", this.onKeyDown);\r\n            window.addEventListener(\"mobilekeyup\", this.onKeyUp);\r\n        }\r\n    }\r\n    public entityAdded(entity: Entity) {\r\n        const comp = entity.getComponent(ControlledComponent);\r\n        if (comp) {\r\n            this.components.push(comp);\r\n        }\r\n    }\r\n    public entityRemoved(entity: Entity) {\r\n        const comp = entity.getComponent(ControlledComponent);\r\n        if (comp) {\r\n            const ind = this.components.indexOf(comp);\r\n            if (ind >= 0) {\r\n                this.components.splice(ind, 1);\r\n            }\r\n        }\r\n    }\r\n    private onKeyReleased(code: string) {\r\n        if (code === \"ArrowRight\" || code === \"KeyD\") {\r\n            this.stopAction(Action.RIGHT);\r\n        } else if (code === \"ArrowLeft\" || code === \"KeyA\") {\r\n            this.stopAction(Action.LEFT);\r\n        } else if (code === \"ArrowUp\" || code === \"KeyW\") {\r\n            this.stopAction(Action.ACTION);\r\n        } else if (code === \"Space\") {\r\n            this.superActionStarted = false;\r\n            this.stopAction(Action.SUPERACTION);\r\n        }\r\n    }\r\n    private onKeyPressed(code: string) {\r\n        if (code === \"ArrowRight\" || code === \"KeyD\") {\r\n            this.startAction(Action.RIGHT);\r\n        } else if (code === \"ArrowLeft\" || code === \"KeyA\") {\r\n            this.startAction(Action.LEFT);\r\n        } else if (code === \"ArrowUp\" || code === \"KeyW\") {\r\n            this.startAction(Action.ACTION);\r\n        } else if (!this.superActionStarted && code === \"Space\") {\r\n            this.superActionStarted = true;\r\n            this.startAction(Action.SUPERACTION);\r\n        }\r\n    }\r\n    private startAction(action: Action) {\r\n        this.components.forEach((component) => {\r\n            component.startAction(action);\r\n        });\r\n    }\r\n    private stopAction(action: Action) {\r\n        this.components.forEach((component) => {\r\n            component.stopAction(action);\r\n        });\r\n    }\r\n}\r\n","import { Entity } from \"../../entity\";\r\nimport { Enemy } from \"../components/level1/enemy\";\r\n\r\nexport class EnemiesSystem {\r\n    public enemies: Enemy[];\r\n    constructor() {\r\n        this.enemies = [];\r\n    }\r\n    /*public gameStarted() {\r\n    if (this.enemies.length > 0) {\r\n      this.enemies[0].enabled = true;\r\n    }\r\n  }*/\r\n    public entityAdded(entity: Entity) {\r\n        const comp = entity.getComponent(Enemy);\r\n        if (comp) {\r\n            this.enemies.push(comp);\r\n        }\r\n    }\r\n    public entityRemoved(entity: Entity) {\r\n        const comp = entity.getComponent(Enemy);\r\n        if (comp) {\r\n            const ind = this.enemies.indexOf(comp);\r\n            if (ind >= 0) {\r\n                this.enemies.splice(ind, 1);\r\n            }\r\n        }\r\n    }\r\n}\r\n","export class Deferred<T = void> implements PromiseLike<T> {\r\n    public readonly promise: Promise<T>;\r\n\r\n    constructor() {\r\n        // Initializing promise in the constructor to make sure private fields are getting correct references\r\n        // to the promise's resolve and reject\r\n        this.promise = new Promise<T>((resolve, reject) => {\r\n            this._reject = reject;\r\n            this._resolve = resolve;\r\n        });\r\n    }\r\n\r\n    public static resolve<T = void>(value?: T) {\r\n        const d = new Deferred<T>();\r\n        d.resolve(value);\r\n        return d;\r\n    }\r\n\r\n    public static reject<T = void>(value?: T) {\r\n        const d = new Deferred<T>();\r\n        d.reject(value);\r\n        return d;\r\n    }\r\n\r\n    then<TResult1 = T, TResult2 = never>(\r\n        onfulfilled?: ((value: T) => TResult1 | PromiseLike<TResult1>) | null,\r\n        onrejected?: ((reason: any) => TResult2 | PromiseLike<TResult2>) | null,\r\n    ): PromiseLike<TResult1 | TResult2> {\r\n        return this.promise.then(onfulfilled, onrejected);\r\n    }\r\n\r\n    public resolve(value?: T) {\r\n        this._resolve(value);\r\n    }\r\n\r\n    public reject(value?: T) {\r\n        this._reject(value);\r\n    }\r\n    private _resolve: (value?: T) => void = () => {};\r\n\r\n    private _reject: (value?: T) => void = () => {};\r\n}\r\n","import { app } from \"../..\";\r\nimport { createEntity, Entity } from \"../../entity\";\r\nimport { ControlledComponent } from \"../components/controlled-component\";\r\nimport { DamageComponent } from \"../components/damage-component\";\r\nimport { FinishLevelComponent } from \"../components/finish-level-component\";\r\nimport { GhostComponent } from \"../components/ghost-component\";\r\nimport { HostedComponent } from \"../components/hosted-component\";\r\nimport { Ashtray } from \"../components/level1/ashtray\";\r\nimport { Balcony } from \"../components/level1/balcony\";\r\nimport { Enemy } from \"../components/level1/enemy\";\r\nimport { Gas } from \"../components/level1/gas\";\r\nimport { Cigerette } from \"../components/level1/cigarette\";\r\nimport { TNT } from \"../components/level1/TNT\";\r\nimport { TubeComponent } from \"../components/level1/tube-component\";\r\nimport { TubeTrigger } from \"../components/level1/tube-trigger\";\r\nimport { Wall } from \"../components/level1/wall\";\r\nimport { Water } from \"../components/level1/water\";\r\nimport { WaterTrigger } from \"../components/level1/water-trigger\";\r\nimport { NinjaComponent } from \"../components/ninja-component\";\r\nimport { StaticPlatformComponent } from \"../components/static-platform-component\";\r\nimport { WitcherComponent } from \"../components/witcher-component\";\r\nimport { LevelsExecuter } from \"../systems/game-system\";\r\nimport { PhysicsGroup } from \"../systems/physics-system\";\r\nimport { delay } from \"../utils/delay\";\r\nimport { WaterPart } from \"../components/level1/water-part\";\r\nimport { Vec2 } from \"planck-js\";\r\nimport { CoinComponent } from \"../components/coin-component\";\r\nimport { WeaponComponent } from \"../components/weapon-component\";\r\nimport { ViewComponent } from \"../components/view-component\";\r\nimport { PlatformView } from \"../views/platform-view\";\r\nimport { GroundWaterView } from \"../views/ground-water-view\";\r\nimport { WaterView } from \"../views/water-view\";\r\nimport { Fire } from \"../components/level1/fire\";\r\nimport { BaseLevel } from \"./base-level\";\r\nimport { TubePlatformView } from \"../views/tube-platform-view\";\r\nimport { SmallPlatform1View } from \"../views/small-platform1-view\";\r\nimport { SmallPlatform2View } from \"../views/small-platform2-view\";\r\nimport { AdditionalGroundView } from \"../views/additional-ground-view\";\r\nimport { RespawnComponent } from \"../components/respawn-component\";\r\nimport { NPC } from \"../components/npc-component\";\r\nimport { RespawnEnemy } from \"../components/level1/respawn-enemy\";\r\n\r\nexport class Level4 extends BaseLevel {\r\n    private tube: TubeComponent;\r\n    private water: Water;\r\n    private additionalGround: StaticPlatformComponent;\r\n    private bigWater: WaterPart;\r\n    private back: PIXI.Container;\r\n    private platforms: Entity;\r\n    public execute(action: LevelsExecuter) {\r\n        switch (action) {\r\n            case LevelsExecuter.LEVEL1_SHOW_TUBE:\r\n                this.tube.show();\r\n                break;\r\n            case LevelsExecuter.LEVEL1_HIDE_TUBE:\r\n                this.tube.hide();\r\n                break;\r\n            case LevelsExecuter.LEVEL1_REMOVE_WATER:\r\n                this.removeWater();\r\n                break;\r\n        }\r\n    }\r\n    public destroy() {\r\n        app.gameLayer.removeChild(this.back);\r\n        this.back = undefined;\r\n    }\r\n    protected createBackground() {\r\n        this.back = new PIXI.Container();\r\n        app.gameLayer.addChild(this.back);\r\n        this.back.addChild(PIXI.Sprite.from(PIXI.utils.TextureCache[\"background\"]));\r\n\r\n        const controls = PIXI.Sprite.from(PIXI.utils.TextureCache[\"controls\"]);\r\n        controls.alpha = 0.5;\r\n        controls.position.set(1000, 100);\r\n        this.back.addChild(controls);\r\n\r\n        const cave = PIXI.Sprite.from(PIXI.utils.TextureCache[\"cave\"]);\r\n        cave.position.set(1150, 315);\r\n        this.back.addChild(cave);\r\n    }\r\n    protected createAll() {\r\n        this.createTube();\r\n\r\n        let ent = createEntity();\r\n        const wall = new Wall();\r\n        ent.addComponent(wall);\r\n        app.game.add(ent);\r\n\r\n        const ninja = createEntity();\r\n        const ninComponent = new NinjaComponent(30, 610);\r\n        ninja.addComponent(ninComponent);\r\n        ninja.addComponent(new DamageComponent(ninComponent, [PhysicsGroup.ENEMIES, PhysicsGroup.DANGER]));\r\n        ninja.addComponent(new ControlledComponent(0, ninComponent));\r\n        ninja.addComponent(new WeaponComponent(ninComponent));\r\n        ninja.addComponent(new HostedComponent(ninComponent));\r\n        ninja.addComponent(new RespawnComponent(30, 100, 0));\r\n        app.game.add(ninja);\r\n\r\n        const witcher = createEntity();\r\n        const witcherComponent = new WitcherComponent(80, 610);\r\n        witcher.addComponent(witcherComponent);\r\n        witcher.addComponent(new DamageComponent(witcherComponent, [PhysicsGroup.ENEMIES, PhysicsGroup.DANGER]));\r\n        witcher.addComponent(new ControlledComponent(1, witcherComponent));\r\n        witcher.addComponent(new HostedComponent(witcherComponent));\r\n        witcher.addComponent(new RespawnComponent(30, 100, 0));\r\n        app.game.add(witcher);\r\n\r\n        const ghost = createEntity();\r\n        const ghostComponent = new GhostComponent(140, 620);\r\n        ghost.addComponent(ghostComponent);\r\n        ghost.addComponent(new ControlledComponent(2, ghostComponent));\r\n        app.game.add(ghost);\r\n\r\n        let bounds = createEntity();\r\n        let platform = new StaticPlatformComponent(\r\n            -10,\r\n            720 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            20,\r\n            720,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        bounds.addComponent(platform);\r\n        app.game.add(bounds);\r\n        platform = new StaticPlatformComponent(\r\n            1280 / 2,\r\n            -10,\r\n            PhysicsGroup.DEFAULT,\r\n            1280,\r\n            20,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        bounds.addComponent(platform);\r\n        platform = new StaticPlatformComponent(\r\n            1330,\r\n            605,\r\n            PhysicsGroup.DEFAULT,\r\n            20,\r\n            130,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        bounds.addComponent(platform);\r\n        platform = new StaticPlatformComponent(1300, 550, PhysicsGroup.DEFAULT, 40, 20, undefined, new ViewComponent());\r\n        bounds.addComponent(platform);\r\n\r\n        let ground = createEntity();\r\n        platform = new StaticPlatformComponent(\r\n            240 / 2,\r\n            720 - 70 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            240,\r\n            70,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        ground.addComponent(platform);\r\n        app.game.add(ground);\r\n\r\n        platform = new StaticPlatformComponent(\r\n            710,\r\n            720 - 70 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            480,\r\n            70,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        ground.addComponent(platform);\r\n\r\n        platform = new StaticPlatformComponent(\r\n            1090,\r\n            720 - 68 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            280,\r\n            68,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        ground.addComponent(platform);\r\n\r\n        platform = new StaticPlatformComponent(\r\n            1275,\r\n            720 - 70 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            130,\r\n            70,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        ground.addComponent(platform);\r\n\r\n        ent = createEntity();\r\n        platform = new StaticPlatformComponent(200, 420, PhysicsGroup.DEFAULT, 70, 34, undefined, new PlatformView());\r\n        ent.addComponent(platform);\r\n        app.game.add(ent);\r\n\r\n        ent = createEntity();\r\n        platform = new StaticPlatformComponent(\r\n            460,\r\n            250,\r\n            PhysicsGroup.DEFAULT,\r\n            50,\r\n            20,\r\n            undefined,\r\n            new TubePlatformView(),\r\n        );\r\n        ent.addComponent(platform);\r\n        app.game.add(ent);\r\n\r\n        ent = createEntity();\r\n        platform = new StaticPlatformComponent(\r\n            1290,\r\n            720 / 2 - 80,\r\n            PhysicsGroup.DEFAULT,\r\n            20,\r\n            560,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        ent.addComponent(platform);\r\n        app.game.add(ent);\r\n\r\n        ent = createEntity();\r\n        const trigger = new TubeTrigger();\r\n        ent.addComponent(trigger);\r\n        app.game.add(ent);\r\n\r\n        ent = createEntity();\r\n        const ash = new Ashtray();\r\n        ent.addComponent(ash);\r\n        const tnt = new TNT();\r\n        ent.addComponent(tnt);\r\n        const cigarette = new Cigerette();\r\n        ent.addComponent(cigarette);\r\n        const fire = new Fire();\r\n        ent.addComponent(fire);\r\n        const gas = new Gas(fire);\r\n        ent.addComponent(gas);\r\n        const balcony = new Balcony(ash, cigarette, gas, tnt, wall);\r\n        ent.addComponent(balcony);\r\n        platform = new StaticPlatformComponent(800, 417 - 40, PhysicsGroup.DEFAULT, 130, 20, -1, new ViewComponent());\r\n        ent.addComponent(platform);\r\n        platform = new StaticPlatformComponent(855.5, 340, PhysicsGroup.DEFAULT, 20, 60, -1, new ViewComponent());\r\n        ent.addComponent(platform);\r\n        platform = new StaticPlatformComponent(745, 340, PhysicsGroup.DEFAULT, 20, 60, -1, new ViewComponent());\r\n        ent.addComponent(new NPC());\r\n        ent.addComponent(platform);\r\n\r\n        platform = new StaticPlatformComponent(600, 375, PhysicsGroup.DEFAULT, 230, 10, -1);\r\n        ent.addComponent(platform);\r\n        platform = new StaticPlatformComponent(490, 305, PhysicsGroup.DEFAULT, 10, 130, -1);\r\n        ent.addComponent(platform);\r\n        app.game.add(ent);\r\n\r\n        ent = createEntity();\r\n        const finish = new FinishLevelComponent(1295, 600, 50, 110, false);\r\n        ent.addComponent(finish);\r\n        app.game.add(ent);\r\n\r\n        ent = createEntity();\r\n        const enemy = new Enemy(760, 500);\r\n        ent.addComponent(enemy);\r\n        ent.addComponent(new DamageComponent(enemy, [PhysicsGroup.HEROES, PhysicsGroup.DANGER]));\r\n        ent.addComponent(new HostedComponent(enemy));\r\n        ent.addComponent(new RespawnEnemy(760, 500, 5000));\r\n        ent.addComponent(new NPC());\r\n        app.game.add(ent);\r\n\r\n        ground = createEntity();\r\n        this.additionalGround = new StaticPlatformComponent(\r\n            360,\r\n            720 - 70 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            240,\r\n            70,\r\n            undefined,\r\n            new AdditionalGroundView(),\r\n        );\r\n        ground.addComponent(this.additionalGround);\r\n        this.additionalGround.hide();\r\n        app.game.add(ground);\r\n\r\n        this.platforms = createEntity();\r\n        platform = new StaticPlatformComponent(\r\n            285,\r\n            720 - 60 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            115,\r\n            10,\r\n            -1,\r\n            new SmallPlatform1View(),\r\n        );\r\n        platform.body.setAngle(PIXI.DEG_TO_RAD * 35);\r\n        this.platforms.addComponent(platform);\r\n        platform = new StaticPlatformComponent(\r\n            435,\r\n            720 - 125 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            85,\r\n            10,\r\n            -1,\r\n            new SmallPlatform2View(),\r\n        );\r\n        this.platforms.addComponent(platform);\r\n        app.game.add(this.platforms);\r\n\r\n        ground = createEntity();\r\n        this.bigWater = new WaterPart(355, 720 - 50 / 2, 230, 50, new Vec2(0, 0.1), 0, new GroundWaterView(), -1);\r\n        this.bigWater.enabled = true;\r\n        ground.addComponent(this.bigWater);\r\n        app.game.add(ground);\r\n\r\n        ent = createEntity();\r\n        platform = new StaticPlatformComponent(355, 720 + 50 / 2, PhysicsGroup.DEFAULT, 230, 50, -1);\r\n        ent.addComponent(platform);\r\n        app.game.add(ent);\r\n\r\n        ent = createEntity();\r\n        let star = new CoinComponent(new Vec2(450, 60));\r\n        ent.addComponent(star);\r\n        app.game.add(ent);\r\n\r\n        ent = createEntity();\r\n        star = new CoinComponent(new Vec2(860, 200));\r\n        ent.addComponent(star);\r\n        app.game.add(ent);\r\n\r\n        ent = createEntity();\r\n        star = new CoinComponent(new Vec2(1000, 130));\r\n        ent.addComponent(star);\r\n        app.game.add(ent);\r\n\r\n        delay(1).then(() => {\r\n            app.runners.gameStarted.run();\r\n            app.gui.showCharactersButtons([0, 1, 2]);\r\n        });\r\n    }\r\n\r\n    private createTube() {\r\n        let ent = createEntity();\r\n        let platform = new StaticPlatformComponent(515, 250, PhysicsGroup.DEFAULT, 60, 20);\r\n        ent.addComponent(platform);\r\n\r\n        platform = new StaticPlatformComponent(557, 150, PhysicsGroup.DEFAULT, 144, 20);\r\n        ent.addComponent(platform);\r\n\r\n        platform = new StaticPlatformComponent(535, 310, PhysicsGroup.DEFAULT, 20, 100);\r\n        ent.addComponent(platform);\r\n\r\n        platform = new StaticPlatformComponent(620, 350, PhysicsGroup.DEFAULT, 150, 20);\r\n        ent.addComponent(platform);\r\n\r\n        platform = new StaticPlatformComponent(698, 195, PhysicsGroup.DEFAULT, 10, 330);\r\n        ent.addComponent(platform);\r\n\r\n        platform = new StaticPlatformComponent(495, 65, PhysicsGroup.DEFAULT, 20, 150);\r\n        ent.addComponent(platform);\r\n\r\n        platform = new StaticPlatformComponent(619, 204, PhysicsGroup.DEFAULT, 20, 90);\r\n        ent.addComponent(platform);\r\n\r\n        platform = new StaticPlatformComponent(630, 40, PhysicsGroup.DEFAULT, 130, 20);\r\n        ent.addComponent(platform);\r\n\r\n        platform = new StaticPlatformComponent(575, 10, PhysicsGroup.DEFAULT, 20, 50);\r\n        ent.addComponent(platform);\r\n        app.game.add(ent);\r\n\r\n        ent = createEntity();\r\n        const trigger = new WaterTrigger();\r\n        ent.addComponent(trigger);\r\n        const waterView = new WaterView();\r\n        ent.addComponent(waterView);\r\n        this.water = new Water(waterView);\r\n        ent.addComponent(this.water);\r\n        app.game.add(ent);\r\n\r\n        this.tube = new TubeComponent();\r\n        ent.addComponent(this.tube);\r\n        this.tube.init();\r\n        app.game.add(ent);\r\n    }\r\n    private removeWater() {\r\n        app.game.remove(this.platforms);\r\n        this.bigWater.enabled = false;\r\n        this.water.stop();\r\n        this.additionalGround.show();\r\n    }\r\n}\r\n","import { ViewComponent } from \"../components/view-component\";\r\nexport class WeaponView extends ViewComponent {\r\n    private gfx: PIXI.Sprite;\r\n    constructor() {\r\n        super();\r\n        /*this.gfx = PIXI.Sprite.from(PIXI.utils.TextureCache[\"stick\"]);\r\n        this.gfx.scale.set(0.8);\r\n        this.gfx.anchor.set(0.5, 0.5);\r\n        this.addChild(this.gfx);\r\n        this.gfx.position.y -= 10;*/\r\n\r\n        /*const a = new PIXI.Graphics();\r\n        a.beginFill(0xff0000, 0.7);\r\n        a.drawRect(-3, -50, 6, 60);\r\n        a.endFill();\r\n        this.addChild(a);*/\r\n    }\r\n}\r\n","import { Body, Box, Vec2 } from \"planck-js\";\r\nimport { app } from \"../../..\";\r\nimport { allCollideExcept, PhysicsGroup, pixels2Meter } from \"../../systems/physics-system\";\r\nimport { PhysicsComponent } from \"../physics-component\";\r\nimport { ViewComponent } from \"../view-component\";\r\n\r\nexport class Ashtray extends PhysicsComponent {\r\n    constructor() {\r\n        super(new ViewComponent(), PhysicsGroup.STAFF, {\r\n            type: Body.DYNAMIC,\r\n            position: new Vec2(pixels2Meter(855), pixels2Meter(305)),\r\n        });\r\n        this.body.setMassData({ mass: 1, center: Vec2.zero(), I: 1 });\r\n        this.body.createFixture(new Box(pixels2Meter(50 / 2), pixels2Meter(10 / 2)), {\r\n            density: 1,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: allCollideExcept(this.physicsGroup),\r\n        });\r\n\r\n        const gfx = PIXI.Sprite.from(PIXI.utils.TextureCache[\"ashtray\"]);\r\n        gfx.anchor.set(0.5);\r\n        this.view.addChild(gfx);\r\n\r\n        /*let a = new PIXI.Graphics();\r\n        a.beginFill(0, 0.5);\r\n        a.drawRect(-50 / 2, -10 / 2, 50, 10);\r\n        a.endFill();\r\n        this.view.addChild(a);*/\r\n    }\r\n    public putBack() {\r\n        app.physics.moveBody(this.body, new Vec2(pixels2Meter(855), pixels2Meter(305)));\r\n    }\r\n    public isOnPlace() {\r\n        const posY = this.body.getPosition().y;\r\n        return posY >= pixels2Meter(303) && posY <= pixels2Meter(307);\r\n    }\r\n}\r\n","import { ViewComponent } from \"../components/view-component\";\r\nimport { GuyView } from \"./guy-view\";\r\n\r\nexport class BalconyView extends ViewComponent {\r\n    private guy: GuyView;\r\n    constructor() {\r\n        super();\r\n        const gfx = PIXI.Sprite.from(PIXI.utils.TextureCache[\"balcony\"]);\r\n        gfx.scale.set(1, 0.9);\r\n        gfx.anchor.set(0.5);\r\n        gfx.position.y = -35;\r\n        this.guy = new GuyView();\r\n        this.guy.position.set(20, -30);\r\n        this.guy.on(\"smokeFinished\", (e) => {\r\n            this.emit(\"smokeFinished\");\r\n        });\r\n        this.guy.on(\"smokeCheckAsh\", (e) => {\r\n            this.emit(\"smokeCheckAsh\");\r\n        });\r\n        this.addChild(this.guy);\r\n        this.addChild(gfx);\r\n    }\r\n    public pause() {\r\n        this.guy.pause();\r\n    }\r\n    public startSmoker() {\r\n        this.guy.smokeAndWait();\r\n    }\r\n    public goAway() {\r\n        this.guy.goAway();\r\n    }\r\n    public stop() {\r\n        this.guy.stop();\r\n    }\r\n}\r\n","import { delay } from \"../utils/delay\";\r\nimport { gsap } from \"gsap\";\r\nimport { Deferred } from \"../utils/deferred\";\r\n\r\nexport class GuyView extends PIXI.Container {\r\n    private enabled: boolean;\r\n    private gfx: PIXI.Sprite;\r\n    private delayPromise: Deferred;\r\n    constructor() {\r\n        super();\r\n        this.enabled = true;\r\n        this.gfx = PIXI.Sprite.from(PIXI.utils.TextureCache[\"smoker\"]);\r\n        this.gfx.anchor.set(0.5);\r\n        this.gfx.position.set(-10, -55);\r\n        this.addChild(this.gfx);\r\n        this.visible = false;\r\n        this.smokeAndWait();\r\n    }\r\n    public goAway() {\r\n        this.gfx.scale.x = -1;\r\n        gsap.to(this.gfx.position, {\r\n            duration: 0.5,\r\n            x: -50,\r\n            ease: \"linear\",\r\n            onComplete: () => {\r\n                this.visible = false;\r\n            },\r\n        });\r\n    }\r\n    public pause() {\r\n        if (this.delayPromise) {\r\n            this.delayPromise.reject();\r\n        }\r\n    }\r\n    public stop() {\r\n        this.goAway();\r\n        this.enabled = false;\r\n    }\r\n    public smokeAndWait() {\r\n        this.delayPromise = delay(6000);\r\n        this.delayPromise.then(() => {\r\n            this.visible = true;\r\n            this.gfx.scale.x = 1;\r\n            gsap.to(this.gfx.position, {\r\n                duration: 0.5,\r\n                x: -10,\r\n                ease: \"linear\",\r\n            });\r\n            if (this.enabled) {\r\n                this.emit(\"smokeCheckAsh\");\r\n            }\r\n            this.delayPromise = delay(3000);\r\n            this.delayPromise.then(() => {\r\n                if (this.enabled) {\r\n                    this.emit(\"smokeFinished\");\r\n                }\r\n            });\r\n        });\r\n    }\r\n}\r\n","import { Body, Circle, Vec2 } from \"planck-js\";\r\nimport { app } from \"../../..\";\r\nimport { allCollideExcept, PhysicsGroup, pixels2Meter } from \"../../systems/physics-system\";\r\nimport { delay } from \"../../utils/delay\";\r\nimport { PhysicsComponent } from \"../physics-component\";\r\nimport { ViewComponent } from \"../view-component\";\r\nimport { Balcony } from \"./balcony\";\r\n\r\nexport class Cigerette extends PhysicsComponent {\r\n    private static idlePosition = new Vec2(pixels2Meter(815), pixels2Meter(40));\r\n    private static startPosition = new Vec2(pixels2Meter(840), pixels2Meter(280));\r\n    constructor() {\r\n        super(new ViewComponent(), PhysicsGroup.LIGHT, {\r\n            type: Body.DYNAMIC,\r\n            position: Cigerette.idlePosition.clone(),\r\n        });\r\n        this.body.setMassData({ mass: 1, center: Vec2.zero(), I: 1 });\r\n        this.createShape();\r\n        this.createView();\r\n        this.body.setAwake(false);\r\n    }\r\n    public async drop() {\r\n        app.physics.moveBodyAndSleep(this.body, Cigerette.startPosition.clone());\r\n        await delay(1);\r\n        this.view.alpha = 1;\r\n        this.body.setAwake(true);\r\n        this.body.setGravityScale(1);\r\n        this.body.applyLinearImpulse(new Vec2(0.1, -0.1), Vec2.zero());\r\n    }\r\n    public stop() {\r\n        app.physics.moveBodyAndSleep(this.body, Cigerette.idlePosition.clone());\r\n        this.view.alpha = 0;\r\n    }\r\n    public goAway() {\r\n        app.physics.moveBodyAndSleep(this.body, Cigerette.idlePosition.clone());\r\n        const balcony = this.getEntity().getComponent(Balcony);\r\n        balcony.goAway();\r\n        balcony.startSmoker();\r\n        this.view.alpha = 0;\r\n    }\r\n    protected onBeginContacted(body: Body) {\r\n        if (body && body.getFixtureList().m_filterCategoryBits === PhysicsGroup.STAFF) {\r\n            this.goAway();\r\n        }\r\n    }\r\n    protected createShape() {\r\n        this.body.createFixture(new Circle(Vec2.zero(), pixels2Meter(5)), {\r\n            density: 1,\r\n            restitution: 0.3,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: allCollideExcept(this.physicsGroup),\r\n        });\r\n    }\r\n    protected createView() {\r\n        const gfx = PIXI.Sprite.from(PIXI.utils.TextureCache[\"light\"]);\r\n        gfx.anchor.set(0.5);\r\n        this.view.alpha = 0;\r\n        this.view.addChild(gfx);\r\n    }\r\n}\r\n","import { Body, Box, Vec2 } from \"planck-js\";\r\nimport { app } from \"../../..\";\r\nimport { allCollideExcept, PhysicsGroup, pixels2Meter } from \"../../systems/physics-system\";\r\nimport { PhysicsComponent } from \"../physics-component\";\r\nimport { ViewComponent } from \"../view-component\";\r\n\r\nexport class TNT extends PhysicsComponent {\r\n    public onGas: boolean;\r\n    public explosionForce: number = 500;\r\n    constructor() {\r\n        super(new ViewComponent(), PhysicsGroup.BOMB, {\r\n            type: Body.DYNAMIC,\r\n            position: new Vec2(pixels2Meter(600), pixels2Meter(480)),\r\n        });\r\n        this.body.setMassData({ mass: 1, center: Vec2.zero(), I: 1 });\r\n        this.onGas = false;\r\n        this.body.createFixture(new Box(pixels2Meter(40 / 2), pixels2Meter(40 / 2)), {\r\n            density: 20,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: allCollideExcept(this.physicsGroup),\r\n        });\r\n\r\n        const gfx = PIXI.Sprite.from(PIXI.utils.TextureCache[\"tnt\"]);\r\n        gfx.scale.set(0.8);\r\n        gfx.anchor.set(0.5);\r\n        this.view.addChild(gfx);\r\n    }\r\n    public explode() {\r\n        app.game.level.createExplosion(this.body.getPosition(), 200, this.explosionForce);\r\n        app.physics.moveBody(this.body, new Vec2(pixels2Meter(600), pixels2Meter(480)));\r\n    }\r\n}\r\n","import { Graphics } from \"pixi.js\";\r\nimport { ViewComponent } from \"../view-component\";\r\n\r\nexport class TubeComponent extends ViewComponent {\r\n    constructor() {\r\n        super();\r\n        const gfx = PIXI.Sprite.from(PIXI.utils.TextureCache[\"tube_blocker\"]);\r\n        gfx.position.x = 487;\r\n        this.addChild(gfx);\r\n    }\r\n    public init() {\r\n        this.hide();\r\n    }\r\n    public hide() {\r\n        this.visible = true;\r\n    }\r\n    public show() {\r\n        this.visible = false;\r\n    }\r\n}\r\n","import { Polygon, Vec2 } from \"planck-js\";\r\nimport { app } from \"../../..\";\r\nimport { LevelsExecuter } from \"../../systems/game-system\";\r\nimport { meter2Pixels, PhysicsGroup, pixels2Meter } from \"../../systems/physics-system\";\r\nimport { SensorComponent } from \"../sensor-component\";\r\nimport { ViewComponent } from \"../view-component\";\r\n\r\nexport class TubeTrigger extends SensorComponent {\r\n    private executor2: LevelsExecuter;\r\n    constructor() {\r\n        super(new ViewComponent(), PhysicsGroup.DEFAULT, {\r\n            position: new Vec2(pixels2Meter(400), pixels2Meter(220)),\r\n        });\r\n        this.createShape();\r\n        this.executor = LevelsExecuter.LEVEL1_SHOW_TUBE;\r\n        this.executor2 = LevelsExecuter.LEVEL1_HIDE_TUBE;\r\n    }\r\n    public execute(isBeginContact: boolean) {\r\n        if (isBeginContact) {\r\n            this.triggered = true;\r\n            app.game.execute(this.executor);\r\n        } else if (!isBeginContact) {\r\n            this.triggered = false;\r\n            app.game.execute(this.executor2);\r\n        }\r\n    }\r\n    protected createShape() {\r\n        const vertices: Vec2[] = [\r\n            new Vec2(-0.8, 1),\r\n            new Vec2(4, 3),\r\n            new Vec2(4, 5),\r\n            new Vec2(9.6, 5),\r\n            new Vec2(9.6, -7),\r\n            new Vec2(-0.8, -7),\r\n        ];\r\n        this.body.createFixture(new Polygon(vertices), {\r\n            isSensor: true,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: PhysicsGroup.HEROES,\r\n        });\r\n        this.drawView(vertices);\r\n    }\r\n    private drawView(verties: Vec2[]) {\r\n        const a = new PIXI.Graphics();\r\n        a.beginFill(0, 1);\r\n        a.moveTo(meter2Pixels(verties[0].x), meter2Pixels(verties[0].y));\r\n        for (let i = 1; i < verties.length; i++) {\r\n            a.lineTo(meter2Pixels(verties[i].x), meter2Pixels(verties[i].y));\r\n        }\r\n        a.endFill();\r\n        this.view.alpha = 0;\r\n        this.view.addChild(a);\r\n    }\r\n}\r\n","import { allCollideExcept, PhysicsGroup } from \"../../systems/physics-system\";\r\nimport { BlockerView } from \"../../views/blocker-view\";\r\nimport { StaticPlatformComponent } from \"../static-platform-component\";\r\n\r\nexport class Wall extends StaticPlatformComponent {\r\n    constructor() {\r\n        super(1260, 700 - 105, PhysicsGroup.STAFF, 20, 110, allCollideExcept(PhysicsGroup.STAFF), new BlockerView());\r\n        /*let a = new PIXI.Graphics();\r\n        a.beginFill(0xffff00, 0.5);\r\n        a.drawRect(-20 / 2, -110 / 2, 20, 110);\r\n        a.endFill();\r\n        this.view.addChild(a);*/\r\n    }\r\n    public explode() {\r\n        this.getEntity().removeComponent(this.view);\r\n        this.getEntity().removeComponent(this);\r\n    }\r\n}\r\n","import { ViewComponent } from \"../components/view-component\";\r\n\r\nexport class BlockerView extends ViewComponent {\r\n    constructor() {\r\n        super();\r\n        const gfx = PIXI.Sprite.from(PIXI.utils.TextureCache[\"trash\"]);\r\n        gfx.scale.set(1);\r\n        gfx.anchor.set(0.5);\r\n        gfx.x = -30;\r\n        this.addChild(gfx);\r\n    }\r\n}\r\n","import { Vec2 } from \"planck-js\";\r\nimport { Entity } from \"../../../entity\";\r\nimport { BaseComponent } from \"../../component\";\r\nimport { Deferred } from \"../../utils/deferred\";\r\nimport { delay } from \"../../utils/delay\";\r\nimport { WaterView } from \"../../views/water-view\";\r\nimport { ViewComponent } from \"../view-component\";\r\nimport { WaterPart } from \"./water-part\";\r\n\r\nexport class Water extends BaseComponent {\r\n    private id: Deferred;\r\n    private view: WaterView;\r\n    constructor(view: WaterView) {\r\n        super();\r\n        this.view = view;\r\n    }\r\n    public stop() {\r\n        if (this.id) {\r\n            this.id.reject();\r\n        }\r\n        const bodies = this._entity.getAllComponents(WaterPart);\r\n        bodies.forEach((b) => {\r\n            b.stop();\r\n        });\r\n    }\r\n    public setEntity(e: Entity) {\r\n        super.setEntity(e);\r\n        const force = 3;\r\n        this.createWaterPart(540, 30, 50, 40, new Vec2(0, force), 0);\r\n        this.createWaterPart(570, 95, 110, 80, new Vec2(force, 0), 100);\r\n        this.createWaterPart(663, 155, 60, 200, new Vec2(0, force), 200);\r\n        this.createWaterPart(652, 305, 80, 60, new Vec2(-force, 0), 300);\r\n        this.createWaterPart(578, 290, 60, 100, new Vec2(0, -force), 400);\r\n        this.createWaterPart(510, 200, 190, 70, new Vec2(-force, 0), 500);\r\n        this.createWaterPart(360, 470, 120, 500, new Vec2(0, force), 600);\r\n\r\n        this.start();\r\n    }\r\n    public destroy() {\r\n        this.stop();\r\n        super.destroy();\r\n    }\r\n    private start() {\r\n        this.id = delay(6000);\r\n        this.id.then(() => {\r\n            this.view.start(2500);\r\n            const bodies = this._entity.getAllComponents(WaterPart);\r\n            bodies.forEach((b) => {\r\n                b.enabled = true;\r\n            });\r\n            this.start();\r\n        });\r\n    }\r\n\r\n    private createWaterPart(x: number, y: number, width: number, height: number, force: Vec2, delay: number) {\r\n        const comp = new WaterPart(x, y, width, height, force, delay, new ViewComponent());\r\n        this._entity.addComponent(comp);\r\n    }\r\n}\r\n","import { Box, Vec2 } from \"planck-js\";\r\nimport { app } from \"../../..\";\r\nimport { LevelsExecuter } from \"../../systems/game-system\";\r\nimport { PhysicsGroup, pixels2Meter } from \"../../systems/physics-system\";\r\nimport { SensorComponent } from \"../sensor-component\";\r\nimport { ViewComponent } from \"../view-component\";\r\n\r\nexport class WaterTrigger extends SensorComponent {\r\n    constructor() {\r\n        super(new ViewComponent(), PhysicsGroup.DEFAULT, {\r\n            position: new Vec2(pixels2Meter(525), pixels2Meter(30)),\r\n        });\r\n        this.createShape();\r\n        this.createView();\r\n        this.executor = LevelsExecuter.LEVEL1_REMOVE_WATER;\r\n    }\r\n    public execute() {\r\n        if (!this.triggered) {\r\n            this.triggered = true;\r\n            this.view.scale.y = -1;\r\n            app.game.execute(this.executor);\r\n        }\r\n    }\r\n    protected createShape() {\r\n        this.body.createFixture(new Box(pixels2Meter(40 / 2), pixels2Meter(40 / 2)), {\r\n            isSensor: true,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: PhysicsGroup.HEROES,\r\n        });\r\n    }\r\n    protected createView() {\r\n        const gfx = PIXI.Sprite.from(PIXI.utils.TextureCache[\"trigger1\"]);\r\n        gfx.anchor.set(0.5);\r\n        this.view.addChild(gfx);\r\n\r\n        /*const a = new PIXI.Graphics();\r\n        a.beginFill(0, 1);\r\n        a.lineStyle(1, 0);\r\n        a.moveTo(-20, -5);\r\n        a.lineTo(15, 15);\r\n        a.lineTo(15, 25);\r\n        a.lineTo(-20, 5);\r\n        a.endFill();\r\n        a.beginFill(0xff0000, 1);\r\n        a.drawRect(-20, -20, 10, 40);\r\n        a.endFill();\r\n        this.view.addChild(a);*/\r\n    }\r\n}\r\n","import { CharacterArm } from \"./character-arm-view\";\r\nimport { gsap } from \"gsap\";\r\n\r\nexport class NinjaArmView extends CharacterArm {\r\n    private idlePos: PIXI.Point;\r\n    protected tween0: gsap.core.Tween;\r\n    constructor(sprite: PIXI.DisplayObject, speed: number, angles: number[], idlePos: PIXI.Point) {\r\n        super(sprite, speed, angles, false);\r\n        this.idlePos = idlePos;\r\n    }\r\n    public superAction() {\r\n        if (!this.superActioning) {\r\n            this.superActioning = true;\r\n            this.walking = false;\r\n            this.actioning = false;\r\n            this.killTweens();\r\n            this.killThisTween();\r\n            this.gfx.position.copyFrom(this.idlePos);\r\n            this.gfx.angle = this.angles[0];\r\n            this.tween0 = gsap.to(this.gfx, {\r\n                duration: this.speed / 2,\r\n                angle: 100,\r\n                ease: \"linear\",\r\n                onUpdate: () => {\r\n                    this.gfx.position.x += 2;\r\n                },\r\n                onComplete: () => {\r\n                    this.tween0 = gsap.to(this.gfx, {\r\n                        duration: this.speed / 2,\r\n                        angle: this.angles[0],\r\n                        ease: \"linear\",\r\n                        onUpdate: () => {\r\n                            this.gfx.position.x -= 2;\r\n                        },\r\n                        onComplete: () => {\r\n                            this.gfx.position.copyFrom(this.idlePos);\r\n                            this.superActioning = false;\r\n                        },\r\n                    });\r\n                },\r\n            });\r\n        }\r\n    }\r\n    protected killThisTween() {\r\n        if (this.tween0 && this.tween0.isActive()) {\r\n            this.tween0.kill();\r\n        }\r\n    }\r\n}\r\n","import { ViewComponent } from \"../components/view-component\";\r\n\r\nexport class CoinView extends ViewComponent {\r\n    constructor() {\r\n        super();\r\n        const gfx = PIXI.Sprite.from(PIXI.utils.TextureCache[\"star\"]);\r\n        gfx.scale.set(0.8);\r\n        gfx.anchor.set(0.5);\r\n        this.addChild(gfx);\r\n    }\r\n}\r\n","import { ViewComponent } from \"../components/view-component\";\r\n\r\nexport class GroundWaterView extends ViewComponent {\r\n    constructor() {\r\n        super();\r\n        const gfx = PIXI.Sprite.from(PIXI.utils.TextureCache[\"water\"]);\r\n        gfx.alpha = 0.5;\r\n        gfx.anchor.set(0.5);\r\n        gfx.position.set(2, 0);\r\n        this.addChild(gfx);\r\n    }\r\n}\r\n","import { ViewComponent } from \"../components/view-component\";\r\nimport { gsap } from \"gsap\";\r\nimport { delay } from \"../utils/delay\";\r\n\r\nexport class WaterView extends ViewComponent {\r\n    private maskPart1: PIXI.Graphics;\r\n    private maskPart2: PIXI.Graphics;\r\n    private maskPart3: PIXI.Graphics;\r\n    constructor() {\r\n        super();\r\n        const view = new PIXI.Container();\r\n        this.addChild(view);\r\n        const gfx = new PIXI.Graphics();\r\n        gfx.beginFill(0x00ffff, 1);\r\n        gfx.drawRect(0, 0, 60, 140);\r\n        gfx.drawRect(60, 50, 130, 90);\r\n        gfx.drawRect(125, 140, 65, 200);\r\n        gfx.drawRect(40, 250, 85, 90);\r\n        gfx.drawRect(40, 160, 65, 90);\r\n        gfx.moveTo(40, 160);\r\n        gfx.lineTo(-5, 160);\r\n        gfx.lineTo(-5, 240);\r\n        gfx.lineTo(40, 240);\r\n        gfx.endFill();\r\n        gfx.position.set(505, 0);\r\n        view.addChild(gfx);\r\n        const splash = PIXI.Sprite.from(PIXI.utils.TextureCache[\"water-01\"]);\r\n        //splash.alpha = 0.5;\r\n        splash.scale.set(1, 1);\r\n        //splash.anchor.set(0.5);\r\n        splash.position.set(220, 159);\r\n        view.addChild(splash);\r\n\r\n        const maska = new PIXI.Container();\r\n        this.addChild(maska);\r\n\r\n        this.maskPart1 = new PIXI.Graphics();\r\n        this.maskPart1.beginFill(0, 1);\r\n        this.maskPart1.drawRect(0, 0, 200, 140); // 200, 140\r\n        maska.addChild(this.maskPart1);\r\n        this.maskPart1.position.set(505, 0);\r\n        this.maskPart1.scale.y = 0;\r\n\r\n        this.maskPart2 = new PIXI.Graphics();\r\n        this.maskPart2.beginFill(0, 1);\r\n        this.maskPart2.drawRect(0, 0, 65, 200); // 65, 200\r\n        maska.addChild(this.maskPart2);\r\n        this.maskPart2.position.set(630, 140);\r\n        this.maskPart2.scale.y = 0;\r\n\r\n        this.maskPart3 = new PIXI.Graphics();\r\n        this.maskPart3.beginFill(0, 1);\r\n        this.maskPart3.drawRect(-200, 0, 300, 500); // 40, 460\r\n        maska.addChild(this.maskPart3);\r\n        this.maskPart3.position.set(402, 220);\r\n        this.maskPart3.scale.y = 0;\r\n\r\n        view.mask = maska;\r\n    }\r\n    public async start(stopDelay: number) {\r\n        gsap.to(this.maskPart1.scale, {\r\n            duration: 0.2,\r\n            y: 1,\r\n            ease: \"linear\",\r\n            onComplete: () => {\r\n                gsap.to(this.maskPart2.scale, {\r\n                    duration: 0.2,\r\n                    y: 1,\r\n                    ease: \"linear\",\r\n                    onComplete: () => {\r\n                        gsap.to(this.maskPart2, {\r\n                            duration: 0.2,\r\n                            x: 350,\r\n                            ease: \"linear\",\r\n                            onUpdate: () => {\r\n                                this.maskPart2.scale.x += 0.4;\r\n                            },\r\n                            onComplete: () => {\r\n                                gsap.to(this.maskPart3.scale, {\r\n                                    duration: 0.2,\r\n                                    y: 1,\r\n                                    ease: \"linear\",\r\n                                });\r\n                            },\r\n                        });\r\n                    },\r\n                });\r\n            },\r\n        });\r\n        await delay(stopDelay);\r\n        this.maskPart3.position.set(402, 220);\r\n        this.maskPart3.scale.y = 0;\r\n        this.maskPart2.position.set(630, 140);\r\n        this.maskPart2.scale.y = 0;\r\n        this.maskPart2.scale.x = 1;\r\n        this.maskPart1.position.set(505, 0);\r\n        this.maskPart1.scale.y = 0;\r\n    }\r\n}\r\n","import { Box, Vec2 } from \"planck-js\";\r\nimport { allCollideExcept, PhysicsGroup, pixels2Meter } from \"../../systems/physics-system\";\r\nimport { SensorComponent } from \"../sensor-component\";\r\nimport { ViewComponent } from \"../view-component\";\r\nimport { gsap } from \"gsap\";\r\n\r\nexport class Fire extends SensorComponent {\r\n    private gfx: PIXI.Sprite;\r\n    private tween: gsap.core.Tween;\r\n    constructor() {\r\n        super(new ViewComponent(), PhysicsGroup.DANGER, {\r\n            position: new Vec2(pixels2Meter(1090), pixels2Meter(655)),\r\n        });\r\n        this.createShape();\r\n        this.createView();\r\n        this.stop();\r\n    }\r\n    public start() {\r\n        this.view.scale.y = 0;\r\n        this.view.visible = true;\r\n        gsap.to(this.view.scale, {\r\n            duration: 0.2,\r\n            y: 1,\r\n            ease: \"linear\",\r\n            onComplete: () => {\r\n                this.tween = gsap.to(this.view.scale, {\r\n                    duration: 0.1,\r\n                    y: 0.9,\r\n                    ease: \"linear\",\r\n                    yoyoEase: \"linear\",\r\n                    repeat: -1,\r\n                    yoyo: true,\r\n                });\r\n            },\r\n        });\r\n        this.body.setActive(true);\r\n    }\r\n    public stop() {\r\n        if (this.tween) {\r\n            this.tween.kill();\r\n            this.tween = undefined;\r\n            gsap.to(this.view.scale, {\r\n                duration: 0.3,\r\n                y: 0,\r\n                ease: \"linear\",\r\n                onComplete: () => {\r\n                    this.view.visible = false;\r\n                },\r\n            });\r\n        } else {\r\n            this.view.visible = false;\r\n        }\r\n        this.body.setActive(false);\r\n    }\r\n    protected createShape() {\r\n        this.body.createFixture(new Box(pixels2Meter(280 / 2), pixels2Meter(60 / 2)), {\r\n            isSensor: true,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: allCollideExcept(this.physicsGroup),\r\n        });\r\n    }\r\n    protected createView() {\r\n        this.gfx = PIXI.Sprite.from(PIXI.utils.TextureCache[\"fire\"]);\r\n        this.gfx.anchor.set(0.5, 1);\r\n        this.gfx.alpha = 0.7;\r\n        this.view.addChild(this.gfx);\r\n    }\r\n}\r\n","import { Vec2 } from \"planck-js\";\r\nimport { app } from \"../..\";\r\nimport { meter2Pixels, pixels2Meter } from \"../systems/physics-system\";\r\nimport { delay } from \"../utils/delay\";\r\nimport { ViewComponent } from \"./view-component\";\r\nimport { gsap } from \"gsap\";\r\n\r\nexport class ExplosionComponent extends ViewComponent {\r\n    constructor(pos: Vec2, radius: number, force: number) {\r\n        super();\r\n        this.position.set(meter2Pixels(pos.x), meter2Pixels(pos.y));\r\n        const gfx = new PIXI.Graphics();\r\n        gfx.beginFill(0xff0000, 0.5);\r\n        gfx.drawCircle(0, 0, radius);\r\n        gfx.endFill();\r\n        this.addChild(gfx);\r\n        this.explode(pos, radius, force);\r\n    }\r\n    private explode(pos: Vec2, radius: number, force: number) {\r\n        this.scale.set(0.1, 0.1);\r\n        app.physics.explode(force, pos, pixels2Meter(radius));\r\n        const timeline = gsap.timeline();\r\n        timeline.to(this.scale, {\r\n            duration: 0.2,\r\n            x: 1,\r\n            y: 1,\r\n            ease: \"linear\",\r\n        });\r\n        timeline.to(this, {\r\n            duration: 0.2,\r\n            alpha: 0,\r\n            ease: \"linear\",\r\n            onComplete: () => {\r\n                app.game.remove(this.getEntity());\r\n            },\r\n        });\r\n    }\r\n}\r\n","import { Body, Box, Circle, Vec2 } from \"planck-js\";\r\nimport { app } from \"../..\";\r\nimport { allCollideExcept, meter2Pixels, PhysicsGroup, pixels2Meter } from \"../systems/physics-system\";\r\nimport { delay } from \"../utils/delay\";\r\nimport { ViewComponent } from \"./view-component\";\r\nimport { gsap } from \"gsap\";\r\nimport { PhysicsComponent } from \"./physics-component\";\r\n\r\nexport class MagicComponent extends PhysicsComponent {\r\n    constructor(pos: Vec2, vector: Vec2) {\r\n        super(new ViewComponent(), PhysicsGroup.MAGIC, {\r\n            type: Body.DYNAMIC,\r\n            position: pos,\r\n            gravityScale: 0.5,\r\n            linearDamping: 1,\r\n            bullet: true,\r\n            linearVelocity: vector,\r\n            angularVelocity: Math.random(),\r\n        });\r\n        this.body.setMassData({ mass: 0, center: Vec2.zero(), I: 1 });\r\n        this.createShape();\r\n\r\n        const a = PIXI.Sprite.from(PIXI.utils.TextureCache[\"star\"]);\r\n        a.anchor.set(0.5);\r\n        a.alpha = 0.8;\r\n        a.scale.set(0.4, 0.4);\r\n        this.view.addChild(a);\r\n        /*const gfx = new PIXI.Graphics();\r\n        gfx.beginFill(0xffff00, 0.5);\r\n        gfx.drawRect(-5, -5, 10, 10);\r\n        gfx.endFill();\r\n        this.view.addChild(gfx);*/\r\n    }\r\n    protected createShape() {\r\n        this.body.createFixture(new Box(pixels2Meter(5), pixels2Meter(5)), {\r\n            density: 30,\r\n            friction: 0,\r\n            restitution: 0.99,\r\n            filterCategoryBits: this.physicsGroup,\r\n            filterMaskBits: allCollideExcept(\r\n                this.physicsGroup,\r\n                PhysicsGroup.GHOST,\r\n                PhysicsGroup.HEROES,\r\n                PhysicsGroup.WATER,\r\n            ),\r\n        });\r\n    }\r\n    protected onBeginContacted(body: Body) {\r\n        this.getEntity().removeComponent(this.view);\r\n        this.getEntity().removeComponent(this);\r\n    }\r\n}\r\n","import { ViewComponent } from \"../components/view-component\";\r\n\r\nexport class TubePlatformView extends ViewComponent {\r\n    constructor() {\r\n        super();\r\n        const gfx = PIXI.Sprite.from(PIXI.utils.TextureCache[\"tube1\"]);\r\n        gfx.anchor.set(0.5, 0.33);\r\n        this.addChild(gfx);\r\n    }\r\n}\r\n","import { ViewComponent } from \"../components/view-component\";\r\n\r\nexport class SmallPlatform1View extends ViewComponent {\r\n    constructor() {\r\n        super();\r\n        const texture = PIXI.utils.TextureCache[\"small_platform\"];\r\n        const gfx = PIXI.Sprite.from(texture);\r\n        gfx.anchor.set(1, 0.5);\r\n        this.addChild(gfx);\r\n        const gfx1 = PIXI.Sprite.from(texture);\r\n        gfx1.anchor.set(0, 0.5);\r\n        gfx1.position.x = gfx.position.x;\r\n        this.addChild(gfx1);\r\n    }\r\n}\r\n","import { ViewComponent } from \"../components/view-component\";\r\n\r\nexport class SmallPlatform2View extends ViewComponent {\r\n    constructor() {\r\n        super();\r\n        const texture = PIXI.utils.TextureCache[\"small_platform\"];\r\n        const gfx = PIXI.Sprite.from(texture);\r\n        gfx.anchor.set(0.5, 0.5);\r\n        gfx.scale.x = 1.3;\r\n        this.addChild(gfx);\r\n    }\r\n}\r\n","import { app } from \"../../..\";\r\nimport { EnemyView } from \"../../views/enemy-view\";\r\nimport { RespawnComponent } from \"../respawn-component\";\r\nimport { gsap } from \"gsap\";\r\n\r\nexport class RespawnEnemy extends RespawnComponent {\r\n    private view: EnemyView;\r\n    private viewMask: PIXI.Graphics;\r\n    constructor(x: number, y: number, delay: number) {\r\n        super(x, y, delay);\r\n        this.view = new EnemyView();\r\n        this.view.position.set(x, y);\r\n        app.gameLayer.addChild(this.view);\r\n\r\n        this.viewMask = new PIXI.Graphics();\r\n        this.viewMask.beginFill(0, 1);\r\n        this.viewMask.drawRect(0, -90, 80, 90);\r\n        this.viewMask.endFill();\r\n        app.gameLayer.addChild(this.viewMask);\r\n        this.viewMask.position.set(x - 37, y + 32);\r\n        this.viewMask.scale.y = 0;\r\n        this.view.mask = this.viewMask;\r\n    }\r\n    public disable() {\r\n        gsap.to(this.viewMask.scale, {\r\n            duration: this.delay / 1000,\r\n            y: 1,\r\n            ease: \"linear\",\r\n            onComplete: () => {\r\n                this.viewMask.scale.y = 0;\r\n            },\r\n        });\r\n    }\r\n}\r\n","import { Vec2 } from \"planck-js\";\r\nimport { app } from \"../..\";\r\nimport { createEntity } from \"../../entity\";\r\nimport { CoinComponent } from \"../components/coin-component\";\r\nimport { ControlledComponent } from \"../components/controlled-component\";\r\nimport { DamageComponent } from \"../components/damage-component\";\r\nimport { FinishLevelComponent } from \"../components/finish-level-component\";\r\nimport { HostedComponent } from \"../components/hosted-component\";\r\nimport { Enemy } from \"../components/level1/enemy\";\r\nimport { NinjaComponent } from \"../components/ninja-component\";\r\nimport { NPC } from \"../components/npc-component\";\r\nimport { RespawnComponent } from \"../components/respawn-component\";\r\nimport { StaticPlatformComponent } from \"../components/static-platform-component\";\r\nimport { TipComponent } from \"../components/tip-component\";\r\nimport { ViewComponent } from \"../components/view-component\";\r\nimport { WeaponComponent } from \"../components/weapon-component\";\r\nimport { LevelsExecuter } from \"../systems/game-system\";\r\nimport { PhysicsGroup } from \"../systems/physics-system\";\r\nimport { delay } from \"../utils/delay\";\r\nimport { AdditionalGroundView } from \"../views/additional-ground-view\";\r\nimport { PlatformView } from \"../views/platform-view\";\r\nimport { BaseLevel } from \"./base-level\";\r\n\r\nexport class Level1 extends BaseLevel {\r\n    private back: PIXI.Container;\r\n    public execute(action: LevelsExecuter) {\r\n        throw new Error(\"Method not implemented.\");\r\n    }\r\n    public destroy() {\r\n        app.gameLayer.removeChild(this.back);\r\n        this.back = undefined;\r\n    }\r\n    protected createAll() {\r\n        const ninja = createEntity();\r\n        const ninComponent = new NinjaComponent(65, 610);\r\n        ninja.addComponent(ninComponent);\r\n        ninja.addComponent(new DamageComponent(ninComponent, [PhysicsGroup.ENEMIES, PhysicsGroup.DANGER]));\r\n        ninja.addComponent(new ControlledComponent(0, ninComponent));\r\n        ninja.addComponent(new WeaponComponent(ninComponent));\r\n        ninja.addComponent(new HostedComponent(ninComponent));\r\n        ninja.addComponent(new RespawnComponent(30, 100, 0));\r\n        ninja.addComponent(new TipComponent(50, -70, 150, \"Can jump high.\\nCan fight.\"));\r\n        app.game.add(ninja);\r\n\r\n        let bounds = createEntity();\r\n        let platform = new StaticPlatformComponent(\r\n            -10,\r\n            720 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            20,\r\n            720,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        bounds.addComponent(platform);\r\n        app.game.add(bounds);\r\n        platform = new StaticPlatformComponent(\r\n            1280 / 2,\r\n            -10,\r\n            PhysicsGroup.DEFAULT,\r\n            1280,\r\n            20,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        bounds.addComponent(platform);\r\n        platform = new StaticPlatformComponent(\r\n            1330,\r\n            605,\r\n            PhysicsGroup.DEFAULT,\r\n            20,\r\n            130,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        bounds.addComponent(platform);\r\n        platform = new StaticPlatformComponent(1300, 550, PhysicsGroup.DEFAULT, 40, 20, undefined, new ViewComponent());\r\n        bounds.addComponent(platform);\r\n        platform = new StaticPlatformComponent(\r\n            1290,\r\n            720 / 2 - 80,\r\n            PhysicsGroup.DEFAULT,\r\n            20,\r\n            560,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        bounds.addComponent(platform);\r\n\r\n        let ground = createEntity();\r\n        platform = new StaticPlatformComponent(\r\n            1280 / 2,\r\n            720 - 70 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            1280,\r\n            70,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        ground.addComponent(platform);\r\n        app.game.add(ground);\r\n\r\n        platform = new StaticPlatformComponent(\r\n            1275,\r\n            720 - 70 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            130,\r\n            70,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        ground.addComponent(platform);\r\n\r\n        let ent = createEntity();\r\n        platform = new StaticPlatformComponent(270, 420, PhysicsGroup.DEFAULT, 70, 34, undefined, new PlatformView());\r\n        ent.addComponent(platform);\r\n        app.game.add(ent);\r\n\r\n        ent = createEntity();\r\n        const finish = new FinishLevelComponent(1275, 600, 50, 110);\r\n        ent.addComponent(finish);\r\n        app.game.add(ent);\r\n\r\n        ent = createEntity();\r\n        let star = new CoinComponent(new Vec2(250, 160));\r\n        ent.addComponent(star);\r\n        ent.addComponent(new TipComponent(50, 50, 220, \"Jump high and\\ncollect\"));\r\n        app.game.add(ent);\r\n\r\n        ground = createEntity();\r\n        const additionalGround = new StaticPlatformComponent(\r\n            360,\r\n            720 - 70 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            240,\r\n            70,\r\n            undefined,\r\n            new AdditionalGroundView(),\r\n        );\r\n        ground.addComponent(additionalGround);\r\n        app.game.add(ground);\r\n\r\n        ent = createEntity();\r\n        const enemy = new Enemy(760, 500);\r\n        ent.addComponent(enemy);\r\n        ent.addComponent(new DamageComponent(enemy, [PhysicsGroup.DANGER]));\r\n        ent.addComponent(new HostedComponent(enemy));\r\n        ent.addComponent(new NPC());\r\n        app.game.add(ent);\r\n\r\n        delay(1).then(() => {\r\n            app.gui.showCharactersButtons([0]);\r\n        });\r\n    }\r\n    protected createBackground() {\r\n        this.back = new PIXI.Container();\r\n        app.gameLayer.addChild(this.back);\r\n        this.back.addChild(PIXI.Sprite.from(PIXI.utils.TextureCache[\"background\"]));\r\n        const controls = PIXI.Sprite.from(PIXI.utils.TextureCache[\"controls\"]);\r\n        controls.alpha = 0.5;\r\n        controls.position.set(1000, 100);\r\n        this.back.addChild(controls);\r\n\r\n        const arrow = PIXI.Sprite.from(PIXI.utils.TextureCache[\"arrow\"]);\r\n        arrow.position.set(1150, 530);\r\n        this.back.addChild(arrow);\r\n\r\n        let txt = new PIXI.Text(\r\n            \"EXIT\",\r\n            new PIXI.TextStyle({ fontFamily: \"Geometria\", fill: \"#ffff00\", fontWeight: \"bold\" }),\r\n        );\r\n        txt.position.set(1080, 536);\r\n        this.back.addChild(txt);\r\n\r\n        txt = new PIXI.Text(\"(move all your\\ncharacters there)\", {\r\n            fontFamily: \"Geometria\",\r\n            fill: \"#ffff00\",\r\n            align: \"center\",\r\n            fontSize: 14,\r\n        });\r\n        txt.anchor.set(0.5);\r\n        txt.position.set(1150, 585);\r\n        this.back.addChild(txt);\r\n    }\r\n}\r\nfunction INPC(INPC: any) {\r\n    throw new Error(\"Function not implemented.\");\r\n}\r\n","import { Vec2 } from \"planck-js\";\r\nimport { app } from \"../..\";\r\nimport { createEntity } from \"../../entity\";\r\nimport { CoinComponent } from \"../components/coin-component\";\r\nimport { ControlledComponent } from \"../components/controlled-component\";\r\nimport { DamageComponent } from \"../components/damage-component\";\r\nimport { FinishLevelComponent } from \"../components/finish-level-component\";\r\nimport { HostedComponent } from \"../components/hosted-component\";\r\nimport { WoodenBox } from \"../components/level1/WoodenBox\";\r\nimport { NinjaComponent } from \"../components/ninja-component\";\r\nimport { StaticPlatformComponent } from \"../components/static-platform-component\";\r\nimport { TipComponent } from \"../components/tip-component\";\r\nimport { ViewComponent } from \"../components/view-component\";\r\nimport { WeaponComponent } from \"../components/weapon-component\";\r\nimport { WitcherComponent } from \"../components/witcher-component\";\r\nimport { LevelsExecuter } from \"../systems/game-system\";\r\nimport { PhysicsGroup } from \"../systems/physics-system\";\r\nimport { delay } from \"../utils/delay\";\r\nimport { AdditionalGroundView } from \"../views/additional-ground-view\";\r\nimport { BaseLevel } from \"./base-level\";\r\n\r\nexport class Level2 extends BaseLevel {\r\n    private back: PIXI.Container;\r\n    public execute(action: LevelsExecuter) {\r\n        throw new Error(\"Method not implemented.\");\r\n    }\r\n    public destroy() {\r\n        app.gameLayer.removeChild(this.back);\r\n        this.back = undefined;\r\n    }\r\n    protected createAll() {\r\n        const ninja = createEntity();\r\n        const ninComponent = new NinjaComponent(65, 610);\r\n        ninja.addComponent(ninComponent);\r\n        ninja.addComponent(new DamageComponent(ninComponent, [PhysicsGroup.ENEMIES, PhysicsGroup.DANGER]));\r\n        ninja.addComponent(new ControlledComponent(0, ninComponent));\r\n        ninja.addComponent(new WeaponComponent(ninComponent));\r\n        ninja.addComponent(new HostedComponent(ninComponent));\r\n        app.game.add(ninja);\r\n\r\n        const witcher = createEntity();\r\n        const witcherComponent = new WitcherComponent(165, 610);\r\n        witcher.addComponent(witcherComponent);\r\n        witcher.addComponent(new DamageComponent(witcherComponent, [PhysicsGroup.ENEMIES, PhysicsGroup.DANGER]));\r\n        witcher.addComponent(new ControlledComponent(1, witcherComponent));\r\n        witcher.addComponent(new HostedComponent(witcherComponent));\r\n        witcher.addComponent(new TipComponent(50, -70, 150, \"Can jump.\\nCan do magic.\"));\r\n        app.game.add(witcher);\r\n\r\n        let bounds = createEntity();\r\n        let platform = new StaticPlatformComponent(\r\n            -10,\r\n            720 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            20,\r\n            720,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        bounds.addComponent(platform);\r\n        app.game.add(bounds);\r\n        platform = new StaticPlatformComponent(\r\n            1280 / 2,\r\n            -10,\r\n            PhysicsGroup.DEFAULT,\r\n            1280,\r\n            20,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        bounds.addComponent(platform);\r\n        platform = new StaticPlatformComponent(\r\n            1330,\r\n            605,\r\n            PhysicsGroup.DEFAULT,\r\n            20,\r\n            130,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        bounds.addComponent(platform);\r\n        platform = new StaticPlatformComponent(1300, 550, PhysicsGroup.DEFAULT, 40, 20, undefined, new ViewComponent());\r\n        bounds.addComponent(platform);\r\n        platform = new StaticPlatformComponent(\r\n            1290,\r\n            720 / 2 - 80,\r\n            PhysicsGroup.DEFAULT,\r\n            20,\r\n            560,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        bounds.addComponent(platform);\r\n\r\n        let ground = createEntity();\r\n        platform = new StaticPlatformComponent(\r\n            1280 / 2,\r\n            720 - 70 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            1280,\r\n            70,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        ground.addComponent(platform);\r\n        app.game.add(ground);\r\n\r\n        platform = new StaticPlatformComponent(\r\n            1275,\r\n            720 - 70 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            130,\r\n            70,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        ground.addComponent(platform);\r\n\r\n        let ent = createEntity();\r\n        const finish = new FinishLevelComponent(1275, 600, 50, 110);\r\n        ent.addComponent(finish);\r\n        app.game.add(ent);\r\n\r\n        ent = createEntity();\r\n        const star = new CoinComponent(new Vec2(600, 630));\r\n        ent.addComponent(star);\r\n        app.game.add(ent);\r\n\r\n        ground = createEntity();\r\n        const additionalGround = new StaticPlatformComponent(\r\n            360,\r\n            720 - 70 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            240,\r\n            70,\r\n            undefined,\r\n            new AdditionalGroundView(),\r\n        );\r\n        ground.addComponent(additionalGround);\r\n        app.game.add(ground);\r\n\r\n        ent = createEntity();\r\n        const box = new WoodenBox();\r\n        ent.addComponent(box);\r\n        ent.addComponent(new TipComponent(50, -40, 150, \"You can move it\\nby magic!\"));\r\n        app.game.add(ent);\r\n\r\n        delay(1).then(() => {\r\n            app.gui.showCharactersButtons([0, 1]);\r\n        });\r\n    }\r\n    protected createBackground() {\r\n        this.back = new PIXI.Container();\r\n        app.gameLayer.addChild(this.back);\r\n        this.back.addChild(PIXI.Sprite.from(PIXI.utils.TextureCache[\"background\"]));\r\n        const controls = PIXI.Sprite.from(PIXI.utils.TextureCache[\"controls\"]);\r\n        controls.alpha = 0.5;\r\n        controls.position.set(1000, 100);\r\n        this.back.addChild(controls);\r\n\r\n        const arrow = PIXI.Sprite.from(PIXI.utils.TextureCache[\"arrow\"]);\r\n        arrow.position.set(1150, 530);\r\n        this.back.addChild(arrow);\r\n\r\n        let txt = new PIXI.Text(\r\n            \"EXIT\",\r\n            new PIXI.TextStyle({ fontFamily: \"Geometria\", fill: \"#ffff00\", fontWeight: \"bold\" }),\r\n        );\r\n        txt.position.set(1080, 536);\r\n        this.back.addChild(txt);\r\n\r\n        txt = new PIXI.Text(\"(move all your\\ncharacters there)\", {\r\n            fontFamily: \"Geometria\",\r\n            fill: \"#ffff00\",\r\n            align: \"center\",\r\n            fontSize: 14,\r\n        });\r\n        txt.anchor.set(0.5);\r\n        txt.position.set(1150, 585);\r\n        this.back.addChild(txt);\r\n    }\r\n}\r\n","import { Vec2 } from \"planck-js\";\r\nimport { app } from \"../..\";\r\nimport { createEntity } from \"../../entity\";\r\nimport { CoinComponent } from \"../components/coin-component\";\r\nimport { ControlledComponent } from \"../components/controlled-component\";\r\nimport { DamageComponent } from \"../components/damage-component\";\r\nimport { FinishLevelComponent } from \"../components/finish-level-component\";\r\nimport { GhostComponent } from \"../components/ghost-component\";\r\nimport { HostedComponent } from \"../components/hosted-component\";\r\nimport { WoodenBox } from \"../components/level1/WoodenBox\";\r\nimport { NinjaComponent } from \"../components/ninja-component\";\r\nimport { StaticPlatformComponent } from \"../components/static-platform-component\";\r\nimport { TipComponent } from \"../components/tip-component\";\r\nimport { ViewComponent } from \"../components/view-component\";\r\nimport { WeaponComponent } from \"../components/weapon-component\";\r\nimport { WitcherComponent } from \"../components/witcher-component\";\r\nimport { LevelsExecuter } from \"../systems/game-system\";\r\nimport { PhysicsGroup } from \"../systems/physics-system\";\r\nimport { delay } from \"../utils/delay\";\r\nimport { AdditionalGroundView } from \"../views/additional-ground-view\";\r\nimport { PlatformView } from \"../views/platform-view\";\r\nimport { BaseLevel } from \"./base-level\";\r\n\r\nexport class Level3 extends BaseLevel {\r\n    private back: PIXI.Container;\r\n    public execute(action: LevelsExecuter) {\r\n        throw new Error(\"Method not implemented.\");\r\n    }\r\n    public destroy() {\r\n        app.gameLayer.removeChild(this.back);\r\n        this.back = undefined;\r\n    }\r\n    protected createAll() {\r\n        const ninja = createEntity();\r\n        const ninComponent = new NinjaComponent(65, 610);\r\n        ninja.addComponent(ninComponent);\r\n        ninja.addComponent(new DamageComponent(ninComponent, [PhysicsGroup.ENEMIES, PhysicsGroup.DANGER]));\r\n        ninja.addComponent(new ControlledComponent(0, ninComponent));\r\n        ninja.addComponent(new WeaponComponent(ninComponent));\r\n        ninja.addComponent(new HostedComponent(ninComponent));\r\n        app.game.add(ninja);\r\n\r\n        const witcher = createEntity();\r\n        const witcherComponent = new WitcherComponent(165, 610);\r\n        witcher.addComponent(witcherComponent);\r\n        witcher.addComponent(new DamageComponent(witcherComponent, [PhysicsGroup.ENEMIES, PhysicsGroup.DANGER]));\r\n        witcher.addComponent(new ControlledComponent(1, witcherComponent));\r\n        witcher.addComponent(new HostedComponent(witcherComponent));\r\n        app.game.add(witcher);\r\n\r\n        const ghost = createEntity();\r\n        const ghostComponent = new GhostComponent(285, 620);\r\n        ghost.addComponent(ghostComponent);\r\n        ghost.addComponent(new ControlledComponent(2, ghostComponent));\r\n        ghost.addComponent(new TipComponent(70, -60, 150, \"Can become\\nimplanted and\\ncontrol others.\"));\r\n        ghost.addComponent(new TipComponent(75, -10, 180, \"Cannot collect\\nstars\"));\r\n        app.game.add(ghost);\r\n\r\n        let bounds = createEntity();\r\n        let platform = new StaticPlatformComponent(\r\n            -10,\r\n            720 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            20,\r\n            720,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        bounds.addComponent(platform);\r\n        app.game.add(bounds);\r\n        platform = new StaticPlatformComponent(\r\n            1280 / 2,\r\n            -10,\r\n            PhysicsGroup.DEFAULT,\r\n            1280,\r\n            20,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        bounds.addComponent(platform);\r\n        platform = new StaticPlatformComponent(\r\n            1330,\r\n            605,\r\n            PhysicsGroup.DEFAULT,\r\n            20,\r\n            130,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        bounds.addComponent(platform);\r\n        platform = new StaticPlatformComponent(1300, 550, PhysicsGroup.DEFAULT, 40, 20, undefined, new ViewComponent());\r\n        bounds.addComponent(platform);\r\n        platform = new StaticPlatformComponent(\r\n            1290,\r\n            720 / 2 - 80,\r\n            PhysicsGroup.DEFAULT,\r\n            20,\r\n            560,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        bounds.addComponent(platform);\r\n\r\n        let ground = createEntity();\r\n        platform = new StaticPlatformComponent(\r\n            1280 / 2,\r\n            720 - 70 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            1280,\r\n            70,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        ground.addComponent(platform);\r\n        app.game.add(ground);\r\n\r\n        platform = new StaticPlatformComponent(\r\n            1275,\r\n            720 - 70 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            130,\r\n            70,\r\n            undefined,\r\n            new ViewComponent(),\r\n        );\r\n        ground.addComponent(platform);\r\n\r\n        let ent = createEntity();\r\n        platform = new StaticPlatformComponent(270, 420, PhysicsGroup.DEFAULT, 70, 34, undefined, new PlatformView());\r\n        ent.addComponent(platform);\r\n        app.game.add(ent);\r\n\r\n        ent = createEntity();\r\n        const finish = new FinishLevelComponent(1275, 600, 50, 110);\r\n        ent.addComponent(finish);\r\n        app.game.add(ent);\r\n\r\n        ent = createEntity();\r\n        let star = new CoinComponent(new Vec2(250, 160));\r\n        ent.addComponent(star);\r\n        app.game.add(ent);\r\n\r\n        ent = createEntity();\r\n        star = new CoinComponent(new Vec2(600, 630));\r\n        ent.addComponent(star);\r\n        app.game.add(ent);\r\n\r\n        ent = createEntity();\r\n        star = new CoinComponent(new Vec2(940, 260));\r\n        ent.addComponent(star);\r\n        ent.addComponent(new TipComponent(45, 50, 220, \"Think how to\\ncollect it!\"));\r\n        app.game.add(ent);\r\n\r\n        ground = createEntity();\r\n        const additionalGround = new StaticPlatformComponent(\r\n            360,\r\n            720 - 70 / 2,\r\n            PhysicsGroup.DEFAULT,\r\n            240,\r\n            70,\r\n            undefined,\r\n            new AdditionalGroundView(),\r\n        );\r\n        ground.addComponent(additionalGround);\r\n        app.game.add(ground);\r\n\r\n        ent = createEntity();\r\n        const box = new WoodenBox();\r\n        ent.addComponent(box);\r\n        app.game.add(ent);\r\n\r\n        delay(1).then(() => {\r\n            app.gui.showCharactersButtons([0, 1, 2]);\r\n        });\r\n    }\r\n    protected createBackground() {\r\n        this.back = new PIXI.Container();\r\n        app.gameLayer.addChild(this.back);\r\n        this.back.addChild(PIXI.Sprite.from(PIXI.utils.TextureCache[\"background\"]));\r\n\r\n        const controls = PIXI.Sprite.from(PIXI.utils.TextureCache[\"controls\"]);\r\n        controls.alpha = 0.5;\r\n        controls.position.set(1000, 100);\r\n        this.back.addChild(controls);\r\n\r\n        const arrow = PIXI.Sprite.from(PIXI.utils.TextureCache[\"arrow\"]);\r\n        arrow.position.set(1150, 530);\r\n        this.back.addChild(arrow);\r\n\r\n        let txt = new PIXI.Text(\r\n            \"EXIT\",\r\n            new PIXI.TextStyle({ fontFamily: \"Geometria\", fill: \"#ffff00\", fontWeight: \"bold\" }),\r\n        );\r\n        txt.position.set(1080, 536);\r\n        this.back.addChild(txt);\r\n\r\n        txt = new PIXI.Text(\"(move all your\\ncharacters there)\", {\r\n            fontFamily: \"Geometria\",\r\n            fill: \"#ffff00\",\r\n            align: \"center\",\r\n            fontSize: 14,\r\n        });\r\n        txt.anchor.set(0.5);\r\n        txt.position.set(1150, 585);\r\n        this.back.addChild(txt);\r\n    }\r\n}\r\n","import { app } from \"../..\";\r\nimport { HEIGHT, WIDTH } from \"../application\";\r\nimport { ControlEvent } from \"../utils/contol-event\";\r\nimport { GhostView } from \"../views/ghost-view\";\r\nimport { NinjaView } from \"../views/ninja-view\";\r\nimport { CharacterButton } from \"../views/ui/character-button\";\r\nimport { CoinsGUIView } from \"../views/ui/coins-gui-view\";\r\nimport { ControlButton } from \"../views/ui/control-button\";\r\nimport { FinishLevelView } from \"../views/ui/finish-level-view\";\r\nimport { GameOverView } from \"../views/ui/gameover-view\";\r\nimport { WitcherView } from \"../views/witcher-view\";\r\n\r\nexport class GUISystem {\r\n    private buttons: CharacterButton[];\r\n    private charButtonsLayer: PIXI.Container;\r\n    private controlsLayer: PIXI.Container;\r\n    private leftButton: ControlButton;\r\n    private rightButton: ControlButton;\r\n    private superActionButton: ControlButton;\r\n    private actionButton: ControlButton;\r\n    private coins: CoinsGUIView;\r\n    private gameOverView: PIXI.Container;\r\n    private onKeyDown: (e: any) => void;\r\n    private scaleProps: {\r\n        width: number;\r\n        height: number;\r\n        newWidth: number;\r\n        newHeight: number;\r\n        scale: number;\r\n        finalScale: number;\r\n    };\r\n    public start() {\r\n        this.charButtonsLayer = new PIXI.Container();\r\n        app.guiLayer.addChild(this.charButtonsLayer);\r\n        this.controlsLayer = new PIXI.Container();\r\n        app.guiLayer.addChild(this.controlsLayer);\r\n        const back = PIXI.Sprite.from(PIXI.utils.TextureCache[\"ui\"]);\r\n        this.charButtonsLayer.addChild(back);\r\n\r\n        this.coins = new CoinsGUIView();\r\n        this.coins.position.set(80, 50);\r\n        this.charButtonsLayer.addChild(this.coins);\r\n\r\n        this.createCharactersButtons();\r\n        if (PIXI.utils.isMobile.any) {\r\n            this.createControlsButtons();\r\n        } else {\r\n            this.onKeyDown = (e) => {\r\n                this.onKeyPressed(e.code);\r\n            };\r\n            document.addEventListener(\"keydown\", this.onKeyDown);\r\n        }\r\n    }\r\n    public showCharactersButtons(ids: number[]) {\r\n        this.buttons.forEach((button) => {\r\n            button.visible = ids.includes(button.id);\r\n        });\r\n    }\r\n    public gameOver() {\r\n        this.disableAll();\r\n        this.gameOverView = new GameOverView();\r\n        app.guiLayer.addChild(this.gameOverView);\r\n        this.positionGameOver(this.scaleProps.scale);\r\n    }\r\n    public finishLevel(coins: number) {\r\n        this.disableAll();\r\n        this.gameOverView = new FinishLevelView(coins);\r\n        app.guiLayer.addChild(this.gameOverView);\r\n        this.positionGameOver(this.scaleProps.scale);\r\n    }\r\n    public restart() {\r\n        app.guiLayer.removeChild(this.gameOverView);\r\n        this.gameOverView = null;\r\n        this.enableAll();\r\n        this.unhostAll();\r\n        this.notOnExitAll();\r\n        this.updateCoins(0);\r\n        app.runners.characterSwitched.emit(0);\r\n    }\r\n\r\n    public resize(width: number, height: number) {\r\n        if (!this.charButtonsLayer) return;\r\n        this.scaleProps = { width, height, newWidth: 0, newHeight: 0, scale: 1, finalScale: 1 };\r\n        if (height / width < HEIGHT / WIDTH) {\r\n            this.scaleProps.newHeight = height;\r\n            this.scaleProps.newWidth = (this.scaleProps.newHeight * WIDTH) / HEIGHT;\r\n            this.scaleProps.scale = this.scaleProps.newHeight / HEIGHT;\r\n        } else {\r\n            this.scaleProps.newWidth = width;\r\n            this.scaleProps.newHeight = (this.scaleProps.newWidth * HEIGHT) / WIDTH;\r\n            this.scaleProps.scale = this.scaleProps.newWidth / WIDTH;\r\n        }\r\n        this.scaleProps.finalScale = this.scaleProps.scale;\r\n        this.positionGameOver(this.scaleProps.scale);\r\n        if (PIXI.utils.isMobile.any) {\r\n            this.scaleProps.finalScale *= width > height ? 2 : 3;\r\n            this.leftButton.scale = this.rightButton.scale = this.actionButton.scale = this.superActionButton.scale = new PIXI.Point(\r\n                this.scaleProps.finalScale,\r\n                this.scaleProps.finalScale,\r\n            );\r\n            const yPos = height - this.leftButton.height - 20 * this.scaleProps.finalScale;\r\n            this.leftButton.position.set(20 * this.scaleProps.finalScale, yPos);\r\n            this.rightButton.position.set(\r\n                this.leftButton.position.x + this.leftButton.width + 20 * this.scaleProps.finalScale,\r\n                yPos,\r\n            );\r\n            this.superActionButton.position.set(\r\n                width - this.superActionButton.width - 20 * this.scaleProps.finalScale,\r\n                yPos,\r\n            );\r\n            this.actionButton.position.set(\r\n                this.superActionButton.x - this.actionButton.width - 20 * this.scaleProps.finalScale,\r\n                yPos,\r\n            );\r\n        }\r\n        let py = 10;\r\n        if (PIXI.utils.isMobile.any && width > height) {\r\n            this.scaleProps.finalScale *= 0.7;\r\n            py = -10;\r\n        }\r\n        this.charButtonsLayer.scale.set(this.scaleProps.finalScale, this.scaleProps.finalScale);\r\n        this.charButtonsLayer.position.set(width - 400 * this.scaleProps.finalScale, py * this.scaleProps.finalScale);\r\n    }\r\n\r\n    public updateCoins(c: number) {\r\n        this.coins.updateCoinsText(c);\r\n    }\r\n    public gameStarted() {\r\n        this.resize(window.innerWidth, window.innerHeight);\r\n    }\r\n    public disableAll() {\r\n        this.buttons.forEach((button) => {\r\n            !button.hosted && (button.enable = false);\r\n        });\r\n    }\r\n    public enableAll() {\r\n        this.buttons.forEach((button) => {\r\n            !button.hosted && (button.enable = true);\r\n        });\r\n    }\r\n    public unhostAll() {\r\n        this.buttons.forEach((button) => {\r\n            button.hosted = false;\r\n        });\r\n    }\r\n    public notOnExitAll() {\r\n        this.buttons.forEach((button) => {\r\n            button.onExit = false;\r\n        });\r\n    }\r\n    public unhostButton(id: number) {\r\n        const button = this.buttons[id];\r\n        if (button && button.hosted) {\r\n            button.hosted = false;\r\n        }\r\n    }\r\n    public hostButton(id: number) {\r\n        const button = this.buttons[id];\r\n        if (button && !button.hosted) {\r\n            button.hosted = true;\r\n        }\r\n    }\r\n    public setOnExit(id: number, on: boolean) {\r\n        const button = this.buttons[id];\r\n        if (button) {\r\n            button.onExit = on;\r\n        }\r\n    }\r\n    private positionGameOver(scale: number) {\r\n        if (this.gameOverView) {\r\n            this.gameOverView.scale.set(scale, scale);\r\n            this.gameOverView.position.set(this.scaleProps.width / 2, this.scaleProps.height / 2);\r\n        }\r\n    }\r\n    private onKeyPressed(code: string) {\r\n        if (code === \"Digit1\") {\r\n            this.onCharacterButtonClicked(0);\r\n        } else if (code === \"Digit2\") {\r\n            this.onCharacterButtonClicked(1);\r\n        } else if (code === \"Digit3\") {\r\n            this.onCharacterButtonClicked(2);\r\n        }\r\n    }\r\n    private createControlsButtons() {\r\n        let icon = new PIXI.Text(\"<=\");\r\n        icon.position.set(35, 35);\r\n        icon.anchor.set(0.5, 0.5);\r\n\r\n        let button = new ControlButton();\r\n        button.alpha = 0.3;\r\n        button.icon = icon;\r\n        this.controlsLayer.addChild(button);\r\n        button.on(\"buttonPressed\", () => {\r\n            window.dispatchEvent(new ControlEvent(\"mobilekeydown\", \"ArrowLeft\"));\r\n        });\r\n        button.on(\"buttonReleased\", () => {\r\n            window.dispatchEvent(new ControlEvent(\"mobilekeyup\", \"ArrowLeft\"));\r\n        });\r\n        this.leftButton = button;\r\n\r\n        icon = new PIXI.Text(\"=>\");\r\n        icon.position.set(35, 35);\r\n        icon.anchor.set(0.5, 0.5);\r\n        button = new ControlButton();\r\n        button.alpha = 0.3;\r\n        button.icon = icon;\r\n        this.controlsLayer.addChild(button);\r\n        button.on(\"buttonPressed\", () => {\r\n            window.dispatchEvent(new ControlEvent(\"mobilekeydown\", \"ArrowRight\"));\r\n        });\r\n        button.on(\"buttonReleased\", () => {\r\n            window.dispatchEvent(new ControlEvent(\"mobilekeyup\", \"ArrowRight\"));\r\n        });\r\n        this.rightButton = button;\r\n\r\n        icon = new PIXI.Text(\"^\");\r\n        icon.position.set(35, 35);\r\n        icon.anchor.set(0.5, 0.5);\r\n        button = new ControlButton();\r\n        button.alpha = 0.3;\r\n        button.icon = icon;\r\n        this.controlsLayer.addChild(button);\r\n        button.on(\"buttonPressed\", () => {\r\n            window.dispatchEvent(new ControlEvent(\"mobilekeydown\", \"ArrowUp\"));\r\n        });\r\n        button.on(\"buttonReleased\", () => {\r\n            window.dispatchEvent(new ControlEvent(\"mobilekeyup\", \"ArrowUp\"));\r\n        });\r\n        this.actionButton = button;\r\n\r\n        icon = new PIXI.Text(\"X\");\r\n        icon.position.set(35, 35);\r\n        icon.anchor.set(0.5, 0.5);\r\n        button = new ControlButton();\r\n        button.alpha = 0.3;\r\n        button.icon = icon;\r\n        this.controlsLayer.addChild(button);\r\n        button.on(\"buttonPressed\", () => {\r\n            window.dispatchEvent(new ControlEvent(\"mobilekeydown\", \"Space\"));\r\n        });\r\n        button.on(\"buttonReleased\", () => {\r\n            window.dispatchEvent(new ControlEvent(\"mobilekeyup\", \"Space\"));\r\n        });\r\n        this.superActionButton = button;\r\n    }\r\n    private createCharactersButtons() {\r\n        const ninja = new NinjaView();\r\n        ninja.scale.set(0.7, 0.7);\r\n        ninja.position.set(35, 37);\r\n        ninja.stop();\r\n\r\n        const witcher = new WitcherView();\r\n        witcher.scale.set(0.7, 0.7);\r\n        witcher.position.set(35, 41);\r\n        witcher.stop();\r\n\r\n        const ghost = new GhostView();\r\n        ghost.stop();\r\n        ghost.scale.set(0.7, 0.7);\r\n        ghost.position.set(30, 44);\r\n\r\n        this.buttons = [];\r\n        for (let i = 0; i < 3; i++) {\r\n            const button = new CharacterButton();\r\n            button.id = i;\r\n            button.position.set(160 + i * 70, 15);\r\n            this.charButtonsLayer.addChild(button);\r\n\r\n            switch (i) {\r\n                case 0:\r\n                    button.icon = ninja;\r\n                    break;\r\n                case 1:\r\n                    button.icon = witcher;\r\n                    break;\r\n                case 2:\r\n                    button.icon = ghost;\r\n                    break;\r\n            }\r\n\r\n            button.on(\"buttonPressed\", (id: number) => {\r\n                this.onCharacterButtonClicked(id);\r\n            });\r\n            this.buttons.push(button);\r\n        }\r\n        this.enableAll();\r\n        this.buttons[0].enable = false;\r\n    }\r\n    public onCharacterButtonClicked(id: number) {\r\n        if (this.buttons[id].enable) {\r\n            this.enableAll();\r\n            app.runners.characterSwitched.emit(id);\r\n            this.buttons[id].enable = false;\r\n        }\r\n    }\r\n}\r\n","import { Button } from \"./button\";\r\nimport { gsap } from \"gsap\";\r\n\r\nexport class CharacterButton extends Button {\r\n    private _hosted: boolean;\r\n    private done: PIXI.Sprite;\r\n    private _icon: PIXI.DisplayObject;\r\n    constructor() {\r\n        super();\r\n        this.done = PIXI.Sprite.from(PIXI.utils.TextureCache[\"done\"]);\r\n        this.done.position.set(-6, -22);\r\n        this.onExit = false;\r\n    }\r\n    public set icon(i: PIXI.DisplayObject) {\r\n        this._icon = i;\r\n        this.addChild(i);\r\n        this.addChild(this.done);\r\n    }\r\n    public set hosted(e: boolean) {\r\n        this._hosted = e;\r\n        this.enable = !e;\r\n    }\r\n    public get hosted(): boolean {\r\n        return this._hosted;\r\n    }\r\n    public set onExit(e: boolean) {\r\n        if (e) {\r\n            this.done.alpha = 0;\r\n            gsap.to(this.done, {\r\n                duration: 0.2,\r\n                alpha: 1,\r\n                ease: \"linear\",\r\n            });\r\n        }\r\n        this.done.visible = e;\r\n    }\r\n    protected setEnable(e: boolean) {\r\n        this.back.visible = !e;\r\n        //this.back.tint = e ? 0xffffff : 0xff0000;\r\n        this.interactive = e;\r\n        this._icon && (this._icon.alpha = this.hosted ? 0.4 : 1);\r\n        if (this.hosted) {\r\n            this.back.visible = false;\r\n        }\r\n    }\r\n    protected createBack() {\r\n        this.back = PIXI.Sprite.from(PIXI.utils.TextureCache[\"ui_active\"]);\r\n        this.back.position.set(-20, -20);\r\n        this.addChild(this.back);\r\n        this.back.visible = false;\r\n    }\r\n}\r\n","import { CoinView } from \"../coin-view\";\r\n\r\nexport class CoinsGUIView extends PIXI.Container {\r\n    private txt: PIXI.Text;\r\n    constructor() {\r\n        super();\r\n        this.txt = new PIXI.Text(\r\n            \"\",\r\n            new PIXI.TextStyle({ fontFamily: \"Geometria-Bold\", fontWeight: \"bold\", fontSize: 30 }),\r\n        );\r\n        this.txt.anchor.set(0, 0.5);\r\n        this.addChild(this.txt);\r\n        this.updateCoinsText(0);\r\n    }\r\n    public updateCoinsText(c: number) {\r\n        this.txt.text = `x ${c}`;\r\n    }\r\n}\r\n","import { app } from \"../../..\";\r\nimport { TextedButton } from \"./texted-button\";\r\n\r\nexport class FinishLevelView extends PIXI.Container {\r\n    private okBtn: TextedButton;\r\n    constructor(coins: number) {\r\n        super();\r\n        const back = PIXI.Sprite.from(PIXI.utils.TextureCache[\"popup\"]);\r\n        back.anchor.set(0.5);\r\n        this.addChild(back);\r\n\r\n        const title = PIXI.Sprite.from(PIXI.utils.TextureCache[\"popup_title\"]);\r\n        title.y = -back.height / 2;\r\n        title.anchor.set(0.5, 0);\r\n        this.addChild(title);\r\n\r\n        const txtTitle = new PIXI.Text(`Level Completed!`, {\r\n            fontFamily: \"Geometria-Bold\",\r\n            align: \"center\",\r\n            fontSize: 25,\r\n            wordWrap: true,\r\n            wordWrapWidth: 400,\r\n        });\r\n        txtTitle.y = title.y + 30;\r\n        txtTitle.anchor.set(0.5, 0);\r\n        this.addChild(txtTitle);\r\n\r\n        const txt = new PIXI.Text(`Coins earned: ${coins}\\nLet's play next!`, {\r\n            fontFamily: \"Geometria\",\r\n            align: \"center\",\r\n            fontSize: 20,\r\n            wordWrap: true,\r\n            wordWrapWidth: 400,\r\n        });\r\n        txt.anchor.set(0.5, 1);\r\n        this.addChild(txt);\r\n\r\n        this.okBtn = new TextedButton(\"NEXT\");\r\n        this.okBtn.on(\"buttonPressed\", () => {\r\n            app.game.restart();\r\n        });\r\n        this.okBtn.position.set(txt.position.x, txt.position.y + 100);\r\n        this.addChild(this.okBtn);\r\n    }\r\n    public destroy(options?: { children?: boolean; texture?: boolean; baseTexture?: boolean }) {\r\n        this.okBtn.off(\"buttonPressed\");\r\n        this.removeChild(this.okBtn);\r\n        this.okBtn = undefined;\r\n        super.destroy(options);\r\n    }\r\n}\r\n","import { app } from \"../../..\";\r\nimport { TextedButton } from \"./texted-button\";\r\n\r\nexport class GameOverView extends PIXI.Container {\r\n    private okBtn: TextedButton;\r\n    constructor() {\r\n        super();\r\n        const back = new PIXI.Graphics();\r\n        back.beginFill(0x666666, 1);\r\n        back.drawRect(-250, -150, 500, 300);\r\n        back.endFill();\r\n        this.addChild(back);\r\n\r\n        const txt = new PIXI.Text(\"GAME OVER!\\nYou have to start current level from the beginning..\", {\r\n            align: \"center\",\r\n            fontSize: 20,\r\n            wordWrap: true,\r\n            wordWrapWidth: 400,\r\n        });\r\n        txt.anchor.set(0.5, 1);\r\n        this.addChild(txt);\r\n\r\n        this.okBtn = new TextedButton(\"OK\");\r\n        this.okBtn.on(\"buttonPressed\", () => {\r\n            app.game.restart();\r\n        });\r\n        this.okBtn.position.set(txt.position.x, txt.position.y + 100);\r\n        this.addChild(this.okBtn);\r\n    }\r\n    public destroy(options?: { children?: boolean; texture?: boolean; baseTexture?: boolean }) {\r\n        this.okBtn.off(\"buttonPressed\");\r\n        this.removeChild(this.okBtn);\r\n        this.okBtn = undefined;\r\n        super.destroy(options);\r\n    }\r\n}\r\n","import { Body } from \"planck-js\";\r\nimport { Entity } from \"../../entity\";\r\nimport { CharacterComponent } from \"../components/character-component\";\r\nimport { HostedComponent } from \"../components/hosted-component\";\r\nimport { PhysicsComponent } from \"../components/physics-component\";\r\n\r\nexport class HostsSystem {\r\n    private hosted: HostedComponent[];\r\n    private _host: CharacterComponent;\r\n    constructor() {\r\n        this.hosted = [];\r\n    }\r\n    public set host(h: CharacterComponent) {\r\n        this._host = h;\r\n    }\r\n    public get host(): CharacterComponent {\r\n        return this._host;\r\n    }\r\n    public getHostedByOverlap(body: Body): HostedComponent {\r\n        for (let ce = body.getContactList(); ce != null; ce = ce.next) {\r\n            if (ce.contact.isTouching()) {\r\n                const otherBody = PhysicsComponent.getAnotherBody(ce.contact, body);\r\n                const host = (otherBody.getUserData() as PhysicsComponent).getEntity().getComponent(HostedComponent);\r\n                if (host) {\r\n                    return host;\r\n                }\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    public entityAdded(entity: Entity) {\r\n        const comp = entity.getComponent(HostedComponent);\r\n        if (comp) {\r\n            this.hosted.push(comp);\r\n        }\r\n    }\r\n    public entityRemoved(entity: Entity) {\r\n        const comp = entity.getComponent(HostedComponent);\r\n        if (comp) {\r\n            if (comp.hasHost()) {\r\n                this.host.action();\r\n                comp.releaseHost();\r\n            }\r\n            const ind = this.hosted.indexOf(comp);\r\n            if (ind >= 0) {\r\n                this.hosted.splice(ind, 1);\r\n            }\r\n        }\r\n    }\r\n}\r\n","import { app } from \"../..\";\r\nimport { HEIGHT, WIDTH } from \"../application\";\r\nimport { TextedButton } from \"../views/ui/texted-button\";\r\n\r\nexport class SplashSystem extends PIXI.Container {\r\n    constructor() {\r\n        super();\r\n    }\r\n    public load() {\r\n        this.addChild(PIXI.Sprite.from(PIXI.utils.TextureCache[\"background\"]));\r\n        const back = PIXI.Sprite.from(PIXI.Texture.WHITE);\r\n        back.tint = 0x04022f;\r\n        back.alpha = 0.8;\r\n        back.width = 1280;\r\n        back.height = 720;\r\n        this.addChild(back);\r\n        const splash = PIXI.Sprite.from(PIXI.utils.TextureCache[\"splash\"]);\r\n        splash.anchor.set(0.5, 0);\r\n        splash.position.set(1280 / 2, 50);\r\n        this.addChild(splash);\r\n        app.gameLayer.addChild(this);\r\n\r\n        const startButton = new TextedButton(\"START\");\r\n        startButton.position.set(1280 / 2, 550);\r\n        this.addChild(startButton);\r\n\r\n        const tutButton = new TextedButton(\"TUTORIAL\");\r\n        tutButton.position.set(1280 / 2, 620);\r\n        this.addChild(tutButton);\r\n\r\n        startButton.on(\"buttonPressed\", () => {\r\n            app.runners.start.emit(1);\r\n            this.destroy();\r\n        });\r\n        tutButton.on(\"buttonPressed\", () => {\r\n            app.runners.start.emit(0);\r\n            this.destroy();\r\n        });\r\n    }\r\n    public resize(width: number, height: number) {\r\n        let newWidth = 0;\r\n        let newHeight = 0;\r\n        let scale = 1;\r\n        if (height / width < HEIGHT / WIDTH) {\r\n            newHeight = height;\r\n            newWidth = (newHeight * WIDTH) / HEIGHT;\r\n            scale = newHeight / HEIGHT;\r\n        } else {\r\n            newWidth = width;\r\n            newHeight = (newWidth * HEIGHT) / WIDTH;\r\n            scale = newWidth / WIDTH;\r\n        }\r\n\r\n        app.gameLayer.scale.set(scale, scale);\r\n        app.gameLayer.position.set(width / 2 - newWidth / 2, height / 2 - newHeight / 2);\r\n    }\r\n    public destroy() {\r\n        this.removeChildren();\r\n        app.gameLayer.removeChild(this);\r\n        super.destroy();\r\n    }\r\n}\r\n"],"sourceRoot":""}